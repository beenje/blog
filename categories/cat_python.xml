<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Tchut-Tchut Blog (Posts about python)</title><link>http://beenje.github.io/blog/</link><description></description><atom:link href="http://beenje.github.io/blog/categories/cat_python.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><copyright>Contents © 2020 &lt;a href="mailto:beenje@gmail.com"&gt;Benjamin Bertrand&lt;/a&gt; 
&lt;a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"&gt;
&lt;img alt="Creative Commons License BY-NC-SA"
style="border-width:0; margin-bottom:12px;"
src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"&gt;&lt;/a&gt;</copyright><lastBuildDate>Wed, 11 Mar 2020 20:38:37 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Searching by date in Elasticsearch</title><link>http://beenje.github.io/blog/posts/searching-by-date-in-elasticsearch/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;I recently indexed some documents in Elasticsearch at work and had issues retrieving what I wanted by date. Googling didn't get me very useful results, except the official &lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/date.html"&gt;documentation&lt;/a&gt;. I thought it was worth sharing what wasn't obvious to me by reading the documentation.&lt;/p&gt;
&lt;p&gt;Let's start a single-node Elasticsearch cluster for test:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;docker run -d -p &lt;span class="m"&gt;9200&lt;/span&gt;:9200 -p &lt;span class="m"&gt;9300&lt;/span&gt;:9300 -e &lt;span class="s2"&gt;"discovery.type=single-node"&lt;/span&gt; docker.elastic.co/elasticsearch/elasticsearch:7.6.0
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;b7c18b6079414f728d2dbacd8c913fbb212026bc513808e03e75e7a81eda0753
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Indexing-documents-in-Elasticsearch"&gt;Indexing documents in Elasticsearch&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/searching-by-date-in-elasticsearch/#Indexing-documents-in-Elasticsearch"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Like in a previous &lt;a href="http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/"&gt;blog post&lt;/a&gt;, I'll use the &lt;a href="https://elasticsearch-py.readthedocs.io/en/master/"&gt;Python Elasticsearch client&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;elasticsearch&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Elasticsearch&lt;/span&gt;
&lt;span class="n"&gt;es&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Elasticsearch&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's first check the cluster is alive:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;health&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[3]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;'1583959014 20:36:54 docker-cluster green 1 1 0 0 0 0 0 17 1.2s 100.0%\n'&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Here is the list of messages we want to index:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;messages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Fri, 11 Oct 2019 10:30:00 +0200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Beautiful is better than ugly"&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Wed, 09 Oct 2019 11:36:05 +0200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Explicit is better than implicit"&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Thu, 10 Oct 2019 19:16:25 +0200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Simple is better than complex"&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Fri, 01 Nov 2019 18:12:00 +0200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Complex is better than complicated"&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Wed, 09 Oct 2019 21:30:10 +0200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Flat is better than nested"&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Wed, 01 Jan 2020 09:23:00 +0200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Sparse is better than dense"&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Wed, 15 Jan 2020 14:06:07 +0200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Readability counts"&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Sat, 01 Feb 2020 12:00:00 +0200"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Now is better than never"&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's index those messages. Note that we delete the index first to make sure it doesn't exist when running this notebook several times.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;indices&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ignore_unavailable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;id_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;messages&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;id_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;refresh&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;indices&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_mapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'test-index': {'mappings': {'properties': {'date': {'type': 'text',
     'fields': {'keyword': {'type': 'keyword', 'ignore_above': 256}}},
    'subject': {'type': 'text',
     'fields': {'keyword': {'type': 'keyword', 'ignore_above': 256}}}}}}}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Looking at the mapping, we see that the &lt;code&gt;date&lt;/code&gt; field was indexed as &lt;code&gt;text&lt;/code&gt; and not &lt;code&gt;date&lt;/code&gt; datatype. Formatting the field to the isoformat should help.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;messages&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strptime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s2"&gt;"&lt;/span&gt;&lt;span class="si"&gt;%a&lt;/span&gt;&lt;span class="s2"&gt;, &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt; %b %Y %H:%M:%S %z"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;isoformat&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;messages&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[7]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'date': '2019-10-11T10:30:00+02:00',
  'subject': 'Beautiful is better than ugly'},
 {'date': '2019-10-09T11:36:05+02:00',
  'subject': 'Explicit is better than implicit'},
 {'date': '2019-10-10T19:16:25+02:00',
  'subject': 'Simple is better than complex'},
 {'date': '2019-11-01T18:12:00+02:00',
  'subject': 'Complex is better than complicated'},
 {'date': '2019-10-09T21:30:10+02:00',
  'subject': 'Flat is better than nested'},
 {'date': '2020-01-01T09:23:00+02:00',
  'subject': 'Sparse is better than dense'},
 {'date': '2020-01-15T14:06:07+02:00', 'subject': 'Readability counts'},
 {'date': '2020-02-01T12:00:00+02:00', 'subject': 'Now is better than never'}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;indices&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ignore_unavailable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;id_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;messages&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;id_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;refresh&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;indices&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_mapping&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[8]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'test-index': {'mappings': {'properties': {'date': {'type': 'date'},
    'subject': {'type': 'text',
     'fields': {'keyword': {'type': 'keyword', 'ignore_above': 256}}}}}}}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This looks better. The date field was properly recognized thanks to the &lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/dynamic-field-mapping.html#date-detection"&gt;date detection&lt;/a&gt; that is enabled by default.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Searching"&gt;Searching&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/searching-by-date-in-elasticsearch/#Searching"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can first check that simple queries work as expected. Note that I'll use the &lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.6/query-dsl-query-string-query.html#query-string-syntax"&gt;query string syntax&lt;/a&gt;. I find it more natural and easier to integrate in a web application search box.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"complex"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'took': 140,
 'timed_out': False,
 '_shards': {'total': 1, 'successful': 1, 'skipped': 0, 'failed': 0},
 'hits': {'total': {'value': 2, 'relation': 'eq'},
  'max_score': 1.2398099,
  'hits': [{'_index': 'test-index',
    '_type': '_doc',
    '_id': '2',
    '_score': 1.2398099,
    '_source': {'date': '2019-10-10T19:16:25+02:00',
     'subject': 'Simple is better than complex'}},
   {'_index': 'test-index',
    '_type': '_doc',
    '_id': '3',
    '_score': 1.2398099,
    '_source': {'date': '2019-11-01T18:12:00+02:00',
     'subject': 'Complex is better than complicated'}}]}}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's define a function that just returns the list of hits.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="s2"&gt;"hits"&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s2"&gt;"hits"&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"complex"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '2',
  '_score': 1.2398099,
  '_source': {'date': '2019-10-10T19:16:25+02:00',
   'subject': 'Simple is better than complex'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '3',
  '_score': 1.2398099,
  '_source': {'date': '2019-11-01T18:12:00+02:00',
   'subject': 'Complex is better than complicated'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's now try to search by date to retrieve the messages from the 9th of October 2019.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"20191009"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[12]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Nothing... The date format is probably not recognized.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"2019-10-09"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[13]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '1',
  '_score': 1.0,
  '_source': {'date': '2019-10-09T11:36:05+02:00',
   'subject': 'Explicit is better than implicit'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '4',
  '_score': 1.0,
  '_source': {'date': '2019-10-09T21:30:10+02:00',
   'subject': 'Flat is better than nested'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So we have to use &lt;code&gt;-&lt;/code&gt;. OK, let's try to retrieve all messages from January 2020.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"2020-01"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[14]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '5',
  '_score': 1.0,
  '_source': {'date': '2020-01-01T09:23:00+02:00',
   'subject': 'Sparse is better than dense'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;That's not really what we expected. There is a message the 15th of January. This shows that &lt;code&gt;2020-01&lt;/code&gt; is in fact equivalent to &lt;code&gt;2020-01-01&lt;/code&gt;. This would be the same with &lt;code&gt;2020&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"date:2020"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[15]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '5',
  '_score': 1.0,
  '_source': {'date': '2020-01-01T09:23:00+02:00',
   'subject': 'Sparse is better than dense'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;To get the full month, we have to use a range query.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"[2020-01-01 TO 2020-01-31]"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[16]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '5',
  '_score': 1.0,
  '_source': {'date': '2020-01-01T09:23:00+02:00',
   'subject': 'Sparse is better than dense'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '6',
  '_score': 1.0,
  '_source': {'date': '2020-01-15T14:06:07+02:00',
   'subject': 'Readability counts'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Which is equivalent to:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"[2020-01 TO 2020-02}"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[17]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '5',
  '_score': 1.0,
  '_source': {'date': '2020-01-01T09:23:00+02:00',
   'subject': 'Sparse is better than dense'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '6',
  '_score': 1.0,
  '_source': {'date': '2020-01-15T14:06:07+02:00',
   'subject': 'Readability counts'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Note that &lt;code&gt;}&lt;/code&gt;, in the range query, excludes the 1st of February. Using &lt;code&gt;]&lt;/code&gt; would give us an additional message:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [18]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"[2020-01 TO 2020-02]"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[18]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '5',
  '_score': 1.0,
  '_source': {'date': '2020-01-01T09:23:00+02:00',
   'subject': 'Sparse is better than dense'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '6',
  '_score': 1.0,
  '_source': {'date': '2020-01-15T14:06:07+02:00',
   'subject': 'Readability counts'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '7',
  '_score': 1.0,
  '_source': {'date': '2020-02-01T12:00:00+02:00',
   'subject': 'Now is better than never'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Another way to retrieve messages from a specific period is to use &lt;a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/common-options.html#date-math"&gt;date math&lt;/a&gt;:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"2020-01\|\|\/M"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[19]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '5',
  '_score': 1.0,
  '_source': {'date': '2020-01-01T09:23:00+02:00',
   'subject': 'Sparse is better than dense'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '6',
  '_score': 1.0,
  '_source': {'date': '2020-01-15T14:06:07+02:00',
   'subject': 'Readability counts'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"date:2020\|\|\/y"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[20]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '5',
  '_score': 1.0,
  '_source': {'date': '2020-01-01T09:23:00+02:00',
   'subject': 'Sparse is better than dense'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '6',
  '_score': 1.0,
  '_source': {'date': '2020-01-15T14:06:07+02:00',
   'subject': 'Readability counts'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '7',
  '_score': 1.0,
  '_source': {'date': '2020-02-01T12:00:00+02:00',
   'subject': 'Now is better than never'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This is a nice solution but it's not super easy to make occasional users remember the syntax, especially the quoting of the &lt;code&gt;|&lt;/code&gt; and &lt;code&gt;/&lt;/code&gt; characters. Range queries are probably more natural.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;One thing that could be nice is if both &lt;code&gt;2019-10-09&lt;/code&gt; and &lt;code&gt;20191009&lt;/code&gt; were recognized. This is possible by adding the format we want to accept in the mapping.&lt;/p&gt;
&lt;p&gt;Let's recreate the index with the new mapping.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [21]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;mapping&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;"type"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"date"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;"format"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"strict_date_optional_time||yyyyMMdd||yyyyMM"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s2"&gt;"subject"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"type"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"text"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"fields"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"keyword"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"type"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"keyword"&lt;/span&gt;&lt;span class="p"&gt;}}},&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;indices&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ignore_unavailable&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;indices&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"mappings"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;"dynamic"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"strict"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"properties"&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;mapping&lt;/span&gt;&lt;span class="p"&gt;}})&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;id_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;messages&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"test-index"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;id_&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;refresh&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [22]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"20191009"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[22]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '1',
  '_score': 1.0,
  '_source': {'date': '2019-10-09T11:36:05+02:00',
   'subject': 'Explicit is better than implicit'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '4',
  '_score': 1.0,
  '_source': {'date': '2019-10-09T21:30:10+02:00',
   'subject': 'Flat is better than nested'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [23]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"2019-10-09"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[23]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '1',
  '_score': 1.0,
  '_source': {'date': '2019-10-09T11:36:05+02:00',
   'subject': 'Explicit is better than implicit'}},
 {'_index': 'test-index',
  '_type': '_doc',
  '_id': '4',
  '_score': 1.0,
  '_source': {'date': '2019-10-09T21:30:10+02:00',
   'subject': 'Flat is better than nested'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [24]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"date:[202002 TO now]"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[24]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '7',
  '_score': 1.0,
  '_source': {'date': '2020-02-01T12:00:00+02:00',
   'subject': 'Now is better than never'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [25]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"date:[2020-02 TO now]"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[25]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[{'_index': 'test-index',
  '_type': '_doc',
  '_id': '7',
  '_score': 1.0,
  '_source': {'date': '2020-02-01T12:00:00+02:00',
   'subject': 'Now is better than never'}}]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As seen above, both formats work now.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Conclusion"&gt;Conclusion&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/searching-by-date-in-elasticsearch/#Conclusion"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;ul&gt;
&lt;li&gt;The mapping is used when indexing new documents. It's also used by the search. Define in the mapping all the date formats you want the search to support (not only the ones required to ingest documents).&lt;/li&gt;
&lt;li&gt;A year &lt;code&gt;2020&lt;/code&gt; or month &lt;code&gt;2020-01&lt;/code&gt; is converted to the first day of the year/month: &lt;code&gt;2020-01-01&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;To search by period, use either date math &lt;code&gt;2020-01\|\|\/M&lt;/code&gt; or a range query &lt;code&gt;[2020-01-01 TO 2020-01-31]&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;&lt;/div&gt;</description><category>elasticsearch</category><category>python</category><guid>http://beenje.github.io/blog/posts/searching-by-date-in-elasticsearch/</guid><pubDate>Wed, 11 Mar 2020 18:08:16 GMT</pubDate></item><item><title>Building a GitLab bot using gidgetlab and aiohttp</title><link>http://beenje.github.io/blog/posts/building-a-gitlab-bot-using-gidgetlab-and-aiohttp/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;p&gt;At PyCon 2018, &lt;a class="reference external" href="https://github.com/Mariatta"&gt;Mariatta&lt;/a&gt; held a &lt;a class="reference external" href="https://us.pycon.org/2018/schedule/presentation/41/"&gt;Build-a-GitHub-Bot Workshop&lt;/a&gt;. The full
documentation can be found on &lt;a class="reference external" href="https://github.com/Mariatta/github-bot-tutorial"&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I went through the tutorial and really enjoyed it.
This is how I discovered &lt;a class="reference external" href="https://gidgethub.readthedocs.io/en/latest/"&gt;gidgethub&lt;/a&gt; from &lt;a class="reference external" href="https://github.com/brettcannon"&gt;Brett Cannon&lt;/a&gt;, an async GitHub
API library for Python.&lt;/p&gt;
&lt;p&gt;I use GitLab at work and really wanted to do the same thing. So I created
&lt;a class="reference external" href="https://gidgetlab.readthedocs.io/en/latest/"&gt;gidgetlab&lt;/a&gt;, a clone of &lt;a class="reference external" href="https://gidgethub.readthedocs.io/en/latest/"&gt;gidgethub&lt;/a&gt; for GitLab.&lt;/p&gt;
&lt;p&gt;In this post I want to demonstrate how to build a GitLab bot in the exact
same way. My goal is not to repeat the full &lt;a class="reference external" href="https://github-bot-tutorial.readthedocs.io/en/latest/"&gt;github-bot-tutorial&lt;/a&gt;
but to show the differences for GitLab. So I strongly suggest that you check the
&lt;a class="reference external" href="https://github-bot-tutorial.readthedocs.io/en/latest/"&gt;github-bot-tutorial&lt;/a&gt; first. I won't go in as much details.&lt;/p&gt;
&lt;p&gt;Note that this post will describe how to interact with gitlab.com but
gidgetlab can of course be used with a private GitLab instance!&lt;/p&gt;
&lt;div class="section" id="using-gidgetlab-on-the-command-line"&gt;
&lt;h2&gt;Using gidgetlab on the command line&lt;/h2&gt;
&lt;p&gt;This is the equivalent of &lt;a class="reference external" href="https://github-bot-tutorial.readthedocs.io/en/latest/gidgethub-cmd-line.html"&gt;using gidgethub on the command line&lt;/a&gt;.
So let's create an issue on GitLab using the API via the command line, instead of the GitLab website.&lt;/p&gt;
&lt;div class="section" id="install-gidgetlab-and-aiohttp"&gt;
&lt;h3&gt;Install gidgetlab and aiohttp&lt;/h3&gt;
&lt;p&gt;Install &lt;code class="docutils literal"&gt;gidgetlab&lt;/code&gt; and &lt;code class="docutils literal"&gt;aiohttp&lt;/code&gt; if you have not already. Using a virtual environment
is recommended.&lt;/p&gt;
&lt;pre class="literal-block"&gt;python3.6 -m pip install gidgetlab[aiohttp]&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="create-a-gitlab-personal-access-token"&gt;
&lt;h3&gt;Create a GitLab Personal Access Token&lt;/h3&gt;
&lt;p&gt;In order to use GitLab's API, you'll need to create a personal access token
that will be used to authenticate yourself to GitLab.&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;Go to &lt;a class="reference external" href="https://gitlab.com/profile/personal_access_tokens"&gt;https://gitlab.com/profile/personal_access_tokens&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Or, from GitLab, go to your &lt;a class="reference external" href="https://gitlab.com/profile"&gt;Settings&lt;/a&gt; &amp;gt; &lt;a class="reference external" href="https://gitlab.com/profile/personal_access_tokens"&gt;Access Tokens&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Under &lt;code class="docutils literal"&gt;Name&lt;/code&gt;, enter a short description, to identify the purpose
of this token. I recommend something like: &lt;code class="docutils literal"&gt;bot tutorial&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;ol class="arabic" start="4"&gt;
&lt;li&gt;&lt;p&gt;Under Scopes, check the &lt;code class="docutils literal"&gt;api&lt;/code&gt; scope.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Click &lt;code class="docutils literal"&gt;Create personal access token&lt;/code&gt;. You will see your new personal access token
(a 21 characters string). Click on the copy to clipboard icon and and paste it locally
in a text file for now. If you have a password manager like 1password, use that.&lt;/p&gt;
&lt;p&gt;This is the only time you'll see this token in GitLab. If you lose it, you'll
need to revoke it and create another one.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="store-the-personal-access-token-as-an-environment-variable"&gt;
&lt;h3&gt;Store the Personal Access Token as an environment variable&lt;/h3&gt;
&lt;p&gt;In Unix / Mac OS:&lt;/p&gt;
&lt;pre class="literal-block"&gt;export GL_ACCESS_TOKEN=your token&lt;/pre&gt;
&lt;p&gt;In Windows:&lt;/p&gt;
&lt;pre class="literal-block"&gt;set GL_ACCESS_TOKEN=your token&lt;/pre&gt;
&lt;p&gt;Note that these will only set the token for the current process. If you want
this value stored permanently, you have to edit the bashrc file.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="create-an-issue"&gt;
&lt;h3&gt;Create an issue&lt;/h3&gt;
&lt;p&gt;Open a new file, for example &lt;code class="docutils literal"&gt;create_issue.py&lt;/code&gt; in your favorite editor.&lt;/p&gt;
&lt;p&gt;Copy the following into &lt;code class="docutils literal"&gt;create_issue.py&lt;/code&gt;.
Instead of "beenje" however, use your own GitLab username:&lt;/p&gt;
&lt;pre class="literal-block"&gt;import asyncio
import os
import aiohttp
from gidgetlab.aiohttp import GitLabAPI

async def main():
    async with aiohttp.ClientSession() as session:
        gl = GitLabAPI(session, "beenje", access_token=os.getenv("GL_ACCESS_TOKEN"))

loop = asyncio.get_event_loop()
loop.run_until_complete(main())&lt;/pre&gt;
&lt;p&gt;We only instantiate a GitLabAPI class from gidgetlab by passing who we are ("beenje" in this example)
and our GitLab personal access token stored in the &lt;code class="docutils literal"&gt;GL_ACCESS_TOKEN&lt;/code&gt; environment variable.
Note that to interact with a private GitLab instance, you just have to pass the url to GitLabAPI:&lt;/p&gt;
&lt;pre class="literal-block"&gt;gl = GitLabAPI(session, "beenje", access_token=os.getenv("GL_ACCESS_TOKEN"),
               url="https://mygitlab.example.com")&lt;/pre&gt;
&lt;p&gt;By default, the url is set to &lt;cite&gt;https://gitlab.com&lt;/cite&gt;.&lt;/p&gt;
&lt;p&gt;So let's create an issue in one of my personal repo.
Take a look at GitLab's documentation for &lt;a class="reference external" href="https://docs.gitlab.com/ee/api/issues.html#new-issue"&gt;creating a new issue&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To create an issue, you should make a &lt;code class="docutils literal"&gt;POST&lt;/code&gt; request to the url
&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;/projects/:id/issues&lt;/span&gt;&lt;/code&gt; and supply the parameters &lt;code class="docutils literal"&gt;title&lt;/code&gt; (required)
and &lt;code class="docutils literal"&gt;description&lt;/code&gt;.
The &lt;code class="docutils literal"&gt;id&lt;/code&gt; can be the project ID or &lt;a class="reference external" href="https://docs.gitlab.com/ee/api/README.html#namespaced-path-encoding"&gt;URL-encoded path of the project&lt;/a&gt; owned by the authenticated user.&lt;/p&gt;
&lt;p&gt;With gidgetlab, this looks like the following:&lt;/p&gt;
&lt;pre class="literal-block"&gt;await gl.post(
    "/projects/beenje%2Fstrange-relationship/issues",
    data={
        "title": "We got a problem",
        "description": "Use more emoji!",
    })&lt;/pre&gt;
&lt;p&gt;&lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;beenje%2Fstrange-relationship&lt;/span&gt;&lt;/code&gt; is the &lt;a class="reference external" href="https://docs.gitlab.com/ee/api/README.html#namespaced-path-encoding"&gt;URL-encoded path of the project&lt;/a&gt;. We could have used the id &lt;code class="docutils literal"&gt;7898119&lt;/code&gt; instead.
The project ID can be found on the project main page.&lt;/p&gt;
&lt;p&gt;Add the above code right after you instantiate GitLabAPI.
Your file should now look like the following:&lt;/p&gt;
&lt;pre class="literal-block"&gt;import asyncio
import os
import aiohttp
from gidgetlab.aiohttp import GitLabAPI


async def main():
    async with aiohttp.ClientSession() as session:
        gl = GitLabAPI(session, "beenje", access_token=os.getenv("GL_ACCESS_TOKEN"))
        await gl.post(
            "/projects/beenje%2Fstrange-relationship/issues",
            data={
                "title": "We got a problem",
                "description": "Use more emoji!",
            })


loop = asyncio.get_event_loop()
loop.run_until_complete(main())&lt;/pre&gt;
&lt;p&gt;Feel free to change the title and the body of the message.
Save and run it in the command line:&lt;/p&gt;
&lt;pre class="literal-block"&gt;python3.6 -m create_issue&lt;/pre&gt;
&lt;p&gt;There should be a new issue created in the strange-relationship project. Check it out:
&lt;a class="reference external" href="https://gitlab.com/beenje/strange-relationship/issues"&gt;https://gitlab.com/beenje/strange-relationship/issues&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="comment-on-issue"&gt;
&lt;h3&gt;Comment on issue&lt;/h3&gt;
&lt;p&gt;Let's try a different exercise, to get ourselves more familiar with GitLab's API.
Take a look at GitLab's &lt;a class="reference external" href="https://docs.gitlab.com/ee/api/issues.html#comments-on-issues"&gt;create a comment&lt;/a&gt; documentation: &lt;code class="docutils literal"&gt;POST &lt;span class="pre"&gt;/projects/:id/issues/:issue_iid/notes&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Leave a comment in the issue you just created:&lt;/p&gt;
&lt;pre class="literal-block"&gt;await gl.post(
    "/projects/beenje%2Fstrange-relationship/issues/1/notes",
    data={"body": "This is a comment"},
)&lt;/pre&gt;
&lt;p&gt;Replace &lt;code class="docutils literal"&gt;1&lt;/code&gt; with the issue number you created.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="close-the-issue"&gt;
&lt;h3&gt;Close the issue&lt;/h3&gt;
&lt;p&gt;Let's now close the issue that you've just created.&lt;/p&gt;
&lt;p&gt;Take a look at the documentation to &lt;a class="reference external" href="https://docs.gitlab.com/ee/api/issues.html#edit-issue"&gt;edit an issue&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The method for editing an issue is &lt;code class="docutils literal"&gt;PUT&lt;/code&gt; instead of &lt;code class="docutils literal"&gt;POST&lt;/code&gt;, which we've
seen in the previous two examples. In addition, to close an issue, you're basically
editing an issue, and setting the &lt;code class="docutils literal"&gt;state_event&lt;/code&gt; to &lt;code class="docutils literal"&gt;close&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Use gidgetlab to close the issue:&lt;/p&gt;
&lt;pre class="literal-block"&gt;await gl.put(
    "/projects/beenje%2Fstrange-relationship/issues/1",
    data={"state_event": "close"},
)&lt;/pre&gt;
&lt;p&gt;Replace &lt;code class="docutils literal"&gt;1&lt;/code&gt; with the issue number you created.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="using-gidgetlab-to-respond-to-webhooks"&gt;
&lt;h2&gt;Using gidgetlab to respond to webhooks&lt;/h2&gt;
&lt;p&gt;In the previous example, we've been interacting with GitLab by doing actions:
making requests to GitLab. And we've been doing that locally on our own machine.&lt;/p&gt;
&lt;p&gt;In this section we'll use what we know so far and start building an actual bot:
a webserver that responds to GitLab webhook events.&lt;/p&gt;
&lt;div class="section" id="gitlabbot"&gt;
&lt;h3&gt;GitLabBot&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://gidgetlab.readthedocs.io/en/latest/"&gt;gidgetlab&lt;/a&gt; actually provides a &lt;a class="reference external" href="https://gidgetlab.readthedocs.io/en/latest/aiohttp.html"&gt;GitLabBot class&lt;/a&gt; to easily create an aiohttp
web server that reponds to GitLab webhooks.&lt;/p&gt;
&lt;p&gt;Save the following in a file named &lt;code class="docutils literal"&gt;bot.py&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;from gidgetlab.aiohttp import GitLabBot

bot = GitLabBot("beenje")


if __name__ == "__main__":
    bot.run()&lt;/pre&gt;
&lt;p&gt;And run:&lt;/p&gt;
&lt;pre class="literal-block"&gt;python3 bot.py
======== Running on http://0.0.0.0:8080 ========
(Press CTRL+C to quit)&lt;/pre&gt;
&lt;p&gt;That's it. You have an aiohttp web server running on port 8080.
Of course, it won't do that much. You'll have to register some events if
you want the bot to perform some actions. We'll see that later.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="webhook-events"&gt;
&lt;h3&gt;Webhook events&lt;/h3&gt;
&lt;p&gt;When an event is triggered in GitLab, GitLab can notify you about the event by
sending a POST request along with the payload.&lt;/p&gt;
&lt;p&gt;Some example &lt;code class="docutils literal"&gt;events&lt;/code&gt; are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;Issues events: any time an issue is created or an existing issue was updated/closed/reopened&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Push events: when you push to the repository except when pushing tags&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Tag events: when you create (or delete) tags to the repository&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Build events: triggered on status change of a Build&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The complete list of events is listed &lt;a class="reference external" href="https://docs.gitlab.com/ee/user/project/integrations/webhooks.html#events"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Since GitLab needs to send you POST requests for the webhook, you should have a service running somewhere that GitLab can reach.
That's usually not on your laptop.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="http://github-bot-tutorial.readthedocs.io/en/latest/index.html"&gt;GitHub bot tutorial&lt;/a&gt; describes how to &lt;a class="reference external" href="http://github-bot-tutorial.readthedocs.io/en/latest/gidgethub-for-webhooks.html#deploy-to-heroku"&gt;deploy your webservice to Heroku&lt;/a&gt;.
Heroku is a platform as a service and makes it easy to deploy and run your app in the cloud.
There are alternatives and you can of course use on your own servers if you want.&lt;/p&gt;
&lt;p&gt;For testing purpose, you can actually use your own laptop thanks to &lt;a class="reference external" href="https://ngrok.com"&gt;ngrok&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ngrok"&gt;
&lt;h3&gt;Ngrok&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="https://ngrok.com"&gt;Ngrok&lt;/a&gt; exposes local servers behind NATs and firewalls to the public internet over secure tunnels.
It's an easy way to test locally a webservice.&lt;/p&gt;
&lt;p&gt;Check the installation instructions from the &lt;a class="reference external" href="https://ngrok.com/download"&gt;website&lt;/a&gt;.
Note that for simple tests, you don't have to register an account.&lt;/p&gt;
&lt;p&gt;If you have a webserver running locally on port 8080, you can expose it by running:&lt;/p&gt;
&lt;pre class="literal-block"&gt;ngrok http 8080&lt;/pre&gt;
&lt;p&gt;Something similar will appear:&lt;/p&gt;
&lt;pre class="literal-block"&gt;ngrok by @inconshreveable                                       (Ctrl+C to quit)

Session Status                online
Session Expires               7 hours, 59 minutes
Version                       2.2.8
Region                        United States (us)
Web Interface                 http://127.0.0.1:4040
Forwarding                    http://fb7fec7c.ngrok.io -&amp;gt; localhost:8080
Forwarding                    https://fb7fec7c.ngrok.io -&amp;gt; localhost:8080&lt;/pre&gt;
&lt;p&gt;You can access your local webservice using HTTP and even HTTPS!&lt;/p&gt;
&lt;pre class="literal-block"&gt;curl -X GET https://fb7fec7c.ngrok.io&lt;/pre&gt;
&lt;p&gt;This address can be accessed from anywhere!. You could give it to a friend or use it as a GitLab webhook.&lt;/p&gt;
&lt;p&gt;Ngrok even gives you a web interface on the port 4040 that allows you to inspect all the requests made to the service.
Just open &lt;a class="reference external" href="http://127.0.0.1:4040"&gt;http://127.0.0.1:4040&lt;/a&gt; in your browser.&lt;/p&gt;
&lt;img alt="/images/gitlab-bot/ngrok-web-ui.png" src="http://beenje.github.io/blog/images/gitlab-bot/ngrok-web-ui.png"&gt;
&lt;p&gt;If your bot is still running and you tried to send a GET, you should get a
405 as reply. Only POST methods are handled by the bot.&lt;/p&gt;
&lt;p&gt;If you don't have any service listening on port 8080 and try to access the
URL given by ngrok, you'll get a 502.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="add-the-gitlab-webhook"&gt;
&lt;h3&gt;Add the GitLab Webhook&lt;/h3&gt;
&lt;p&gt;Now that we have a local webservice that can receive requests thanks to ngrok,
let's create a webhook on GitLab. If you haven't done so yet, create your
own project on GitLab.&lt;/p&gt;
&lt;p&gt;Go to your project settings and select Integrations to create a webhook:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;In the &lt;strong&gt;URL&lt;/strong&gt; field, enter the ngrok URL you got earlier.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;For security reasons, type in some random characters under &lt;strong&gt;Secret Token&lt;/strong&gt; (you can use Python &lt;cite&gt;secrets.token_hex(16)&lt;/cite&gt; function)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Under &lt;strong&gt;Trigger&lt;/strong&gt;, select Issues events, Comments and Merge request events&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Leave &lt;strong&gt;Enable SSL verification&lt;/strong&gt; enabled&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Click &lt;strong&gt;Add webhook&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="update-the-config-variables-in-your-environment"&gt;
&lt;h3&gt;Update the Config Variables in your environment&lt;/h3&gt;
&lt;p&gt;First, export the secret webhook token you just created:&lt;/p&gt;
&lt;pre class="literal-block"&gt;export GL_SECRET=&amp;lt;secret token&amp;gt;&lt;/pre&gt;
&lt;p&gt;Then, if not already done, export your GitLab personal access token:&lt;/p&gt;
&lt;pre class="literal-block"&gt;export GL_ACCESS_TOKEN=&amp;lt;acess token&amp;gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="your-first-gitlab-bot"&gt;
&lt;h3&gt;Your first GitLab bot!&lt;/h3&gt;
&lt;p&gt;Let's start with a bot that responds to every newly created issue in your project.
For example, whenever someone creates an issue, the bot will automatically say something like:
"Thanks for the report, @user. I will look into this ASAP!"&lt;/p&gt;
&lt;p&gt;To respond to webhooks events, we have to register a coroutine using the
&lt;code class="docutils literal"&gt;@bot.router.register&lt;/code&gt; decorator:&lt;/p&gt;
&lt;pre class="literal-block"&gt;@bot.router.register("Issue Hook", action="open")
async def issue_opened_event(event, gl, *args, **kwargs):
    pass&lt;/pre&gt;
&lt;p&gt;In this example we subscribe to the GitLab &lt;code class="docutils literal"&gt;Issue Hook&lt;/code&gt; events, and
more specifically to the "open" issues event.&lt;/p&gt;
&lt;p&gt;The two important parameters here are: &lt;code class="docutils literal"&gt;event&lt;/code&gt; and &lt;code class="docutils literal"&gt;gl&lt;/code&gt;.&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;event&lt;/code&gt; here is the representation of GitLab's webhook event. We can access the
event payload by doing &lt;code class="docutils literal"&gt;event.data&lt;/code&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code class="docutils literal"&gt;gl&lt;/code&gt; is the gidgetlab GitLabAPI instance, which we can use to make API calls to GitLab, as in the first section.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We already saw that to &lt;a class="reference external" href="https://docs.gitlab.com/ee/api/issues.html#comments-on-issues"&gt;create a comment&lt;/a&gt; on an issue, we need to send: &lt;code class="docutils literal"&gt;POST &lt;span class="pre"&gt;/projects/:id/issues/:issue_iid/notes&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Let's look at the &lt;a class="reference external" href="https://docs.gitlab.com/ee/user/project/integrations/webhooks.html#issues-events"&gt;Issues events&lt;/a&gt;
payload to see how we can retrieve the required information:&lt;/p&gt;
&lt;pre class="literal-block"&gt;{
  "object_kind": "issue",
  "user": {
    "name": "Administrator",
    "username": "root",
    "avatar_url": "http://www.gravatar.com/avatar/e64c7d89f26bd1972efa854d13d7dd61?s=40\u0026d=identicon"
  },
  "project": {
    "id": 1,
    "name":"Gitlab Test",
    "description":"Aut reprehenderit ut est.",
    "web_url":"http://example.com/gitlabhq/gitlab-test",
    "avatar_url":null,
    "git_ssh_url":"git@example.com:gitlabhq/gitlab-test.git",
    "git_http_url":"http://example.com/gitlabhq/gitlab-test.git",
    "namespace":"GitlabHQ",
    ...
  },
  "repository": {
    "name": "Gitlab Test",
    "url": "http://example.com/gitlabhq/gitlab-test.git",
    "description": "Aut reprehenderit ut est.",
    "homepage": "http://example.com/gitlabhq/gitlab-test"
  },
  "object_attributes": {
    "id": 301,
    "title": "New API: create/update/delete file",
    ...
    "state": "opened",
    "iid": 23,
    "url": "http://example.com/diaspora/issues/23",
    "action": "open"
  },
  ...
}&lt;/pre&gt;
&lt;p&gt;The project id can be retrieved as &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;event.data["project"]["id"]&lt;/span&gt;&lt;/code&gt;.
As this is quite common, &lt;a class="reference external" href="https://gidgetlab.readthedocs.io/en/latest/"&gt;gidgetlab&lt;/a&gt; procures a &lt;em&gt;project_id&lt;/em&gt; property to access it directly: &lt;code class="docutils literal"&gt;event.project_id&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To get the issue id, we can use &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;event.data["object_attributes"]["iid"]&lt;/span&gt;&lt;/code&gt;. Again as accessing &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;event.data["object_attributes"]&lt;/span&gt;&lt;/code&gt; is quite common,
we can use the &lt;em&gt;object_attributes&lt;/em&gt; property: &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;event.object_attributes["iid"]&lt;/span&gt;&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;The url to use is thus:&lt;/p&gt;
&lt;pre class="literal-block"&gt;url = f"/projects/{event.project_id}/issues/{event.object_attributes['iid']}/notes"&lt;/pre&gt;
&lt;p&gt;To greet the author, we have to retrieve the username from the event: &lt;code class="docutils literal"&gt;&lt;span class="pre"&gt;event.data["user"]["username"]&lt;/span&gt;&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Open your &lt;code class="docutils literal"&gt;bot.py&lt;/code&gt; file and add the following coroutine to be called when
a new issue is opened:&lt;/p&gt;
&lt;pre class="literal-block"&gt;@bot.router.register("Issue Hook", action="open")
async def issue_opened_event(event, gl, *args, **kwargs):
    """Whenever an issue is opened, greet the author and say thanks."""
    url = f"/projects/{event.project_id}/issues/{event.object_attributes['iid']}/notes"
    message = f"Thanks for the report @{event.data['user']['username']}! I will look into it ASAP! (I'm a bot)."
    await gl.post(url, data={"body": message})&lt;/pre&gt;
&lt;p&gt;The full file should look like:&lt;/p&gt;
&lt;pre class="literal-block"&gt;from gidgetlab.aiohttp import GitLabBot

bot = GitLabBot("beenje")


@bot.router.register("Issue Hook", action="open")
async def issue_opened_event(event, gl, *args, **kwargs):
    """Whenever an issue is opened, greet the author and say thanks."""
    url = f"/projects/{event.project_id}/issues/{event.object_attributes['iid']}/notes"
    message = f"Thanks for the report @{event.data['user']['username']}! I will look into it ASAP! (I'm a bot)."
    await gl.post(url, data={"body": message})


if __name__ == "__main__":
    bot.run()&lt;/pre&gt;
&lt;p&gt;Run:&lt;/p&gt;
&lt;pre class="literal-block"&gt;python3 bot.py&lt;/pre&gt;
&lt;p&gt;Go to your project and open an issue. Wait a few seconds and refresh the
page. You should see a new comment added to the issue!&lt;/p&gt;
&lt;img alt="/images/gitlab-bot/gitlab-bot-say-thanks.png" src="http://beenje.github.io/blog/images/gitlab-bot/gitlab-bot-say-thanks.png"&gt;
&lt;p&gt;Congrats! You wrote your first GitLab bot!&lt;/p&gt;
&lt;p&gt;Of course, using ngrok on your laptop was for testing only.
To use it in production, you should deploy it to a server or the cloud.
You can check the GitHub bot tutorial to see how to &lt;a class="reference external" href="http://github-bot-tutorial.readthedocs.io/en/latest/gidgethub-for-webhooks.html#deploy-to-heroku"&gt;deploy your webservice to Heroku&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Hopefully this gave you an idea of what can be done with &lt;a class="reference external" href="https://gidgetlab.readthedocs.io/en/latest/"&gt;gidgetlab&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;If you are interested, try to perform the other exercices described in the
&lt;a class="reference external" href="https://github-bot-tutorial.readthedocs.io/en/latest/"&gt;github-bot-tutorial&lt;/a&gt; but using GitLab. Don't hesitate to let me know if you use &lt;a class="reference external" href="https://gidgetlab.readthedocs.io/en/latest/"&gt;gidgetlab&lt;/a&gt;
to build something cool :-)&lt;/p&gt;
&lt;p&gt;Again, a big thanks to &lt;a class="reference external" href="https://github.com/Mariatta"&gt;Mariatta&lt;/a&gt; for her tutorial and to &lt;a class="reference external" href="https://github.com/brettcannon"&gt;Brett Cannon&lt;/a&gt; for
&lt;a class="reference external" href="https://gidgethub.readthedocs.io/en/latest/"&gt;gidgethub&lt;/a&gt;! This project wouldn't exist otherwise.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>aiohttp</category><category>bot</category><category>gidgetlab</category><category>gitlab</category><category>python</category><guid>http://beenje.github.io/blog/posts/building-a-gitlab-bot-using-gidgetlab-and-aiohttp/</guid><pubDate>Mon, 17 Sep 2018 20:40:15 GMT</pubDate></item><item><title>Parsing JavaScript rendered pages in Python with pyppeteer</title><link>http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Parsing-JavaScript-rendered-pages-in-Python-with-pyppeteer"&gt;Parsing JavaScript rendered pages in Python with pyppeteer&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#Parsing-JavaScript-rendered-pages-in-Python-with-pyppeteer"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Where-is-my-table?"&gt;Where is my table?&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#Where-is-my-table?"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;I already wrote a blog post about &lt;a href="https://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/"&gt;Parsing HTML Tables in Python with pandas&lt;/a&gt;. Using &lt;a href="http://docs.python-requests.org/en/master/"&gt;requests&lt;/a&gt; or even directly &lt;a href="https://pandas.pydata.org"&gt;pandas&lt;/a&gt; was working nicely.&lt;/p&gt;
&lt;p&gt;I wanted to play with some data from a race I recently run: &lt;a href="http://www.lundaloppet.se/info/resultat/"&gt;Lundaloppet&lt;/a&gt;.
The results are available here: &lt;a href="http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=0&amp;amp;pageSize=25"&gt;http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=0&amp;amp;pageSize=25&lt;/a&gt;
&lt;img src="http://beenje.github.io/blog/images/pyppeteer/results_lundaloppet_2018.png" alt="Results Lundaloppet 2018"&gt;&lt;/p&gt;
&lt;p&gt;Let's try to get that table!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=0&amp;amp;pageSize=25'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_text output_error"&gt;
&lt;pre&gt;
&lt;span class="ansi-red-fg"&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class="ansi-red-fg"&gt;ValueError&lt;/span&gt;                                Traceback (most recent call last)
&lt;span class="ansi-green-fg"&gt;&amp;lt;ipython-input-2-881110a1fe3d&amp;gt;&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;()&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;----&amp;gt; 1&lt;/span&gt;&lt;span class="ansi-red-fg"&gt; &lt;/span&gt;dfs &lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt; pd&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;read_html&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;'http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=0&amp;amp;pageSize=25'&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;

&lt;span class="ansi-green-fg"&gt;~/miniconda3/envs/notebook/lib/python3.6/site-packages/pandas/io/html.py&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;read_html&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;(io, match, flavor, header, index_col, skiprows, attrs, parse_dates, tupleize_cols, thousands, encoding, decimal, converters, na_values, keep_default_na, displayed_only)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    985&lt;/span&gt;                   decimal&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;decimal&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; converters&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;converters&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; na_values&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;na_values&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    986&lt;/span&gt;                   keep_default_na&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;keep_default_na&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;--&amp;gt; 987&lt;/span&gt;&lt;span class="ansi-red-fg"&gt;                   displayed_only=displayed_only)
&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;~/miniconda3/envs/notebook/lib/python3.6/site-packages/pandas/io/html.py&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;_parse&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;(flavor, io, match, attrs, encoding, displayed_only, **kwargs)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    813&lt;/span&gt;             &lt;span class="ansi-green-fg"&gt;break&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    814&lt;/span&gt;     &lt;span class="ansi-green-fg"&gt;else&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;:&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;--&amp;gt; 815&lt;/span&gt;&lt;span class="ansi-red-fg"&gt;         &lt;/span&gt;raise_with_traceback&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;retained&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    816&lt;/span&gt; 
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    817&lt;/span&gt;     ret &lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt; &lt;span class="ansi-blue-fg"&gt;[&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;]&lt;/span&gt;

&lt;span class="ansi-green-fg"&gt;~/miniconda3/envs/notebook/lib/python3.6/site-packages/pandas/compat/__init__.py&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;raise_with_traceback&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;(exc, traceback)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    401&lt;/span&gt;         &lt;span class="ansi-green-fg"&gt;if&lt;/span&gt; traceback &lt;span class="ansi-blue-fg"&gt;==&lt;/span&gt; Ellipsis&lt;span class="ansi-blue-fg"&gt;:&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    402&lt;/span&gt;             _&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; _&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; traceback &lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt; sys&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;exc_info&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;--&amp;gt; 403&lt;/span&gt;&lt;span class="ansi-red-fg"&gt;         &lt;/span&gt;&lt;span class="ansi-green-fg"&gt;raise&lt;/span&gt; exc&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;with_traceback&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;traceback&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    404&lt;/span&gt; &lt;span class="ansi-green-fg"&gt;else&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;:&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    405&lt;/span&gt;     &lt;span class="ansi-red-fg"&gt;# this version of raise is a syntax error in Python 3&lt;/span&gt;

&lt;span class="ansi-red-fg"&gt;ValueError&lt;/span&gt;: No tables found&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;No tables found... So what is going on? Let's look at what is returned by requests.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;IPython.display&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;display_html&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=0&amp;amp;pageSize=25'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[4]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;'ï»¿&amp;lt;!DOCTYPE html&amp;gt;\r\n&amp;lt;html xmlns="http://www.w3.org/1999/xhtml" ng-app="app"&amp;gt;\r\n&amp;lt;head&amp;gt;\r\n    &amp;lt;title ng-bind="event.name || \'Neptron Timing\'"&amp;gt;Neptron Timing&amp;lt;/title&amp;gt;\r\n\r\n    &amp;lt;meta charset="utf-8"&amp;gt;\r\n    &amp;lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&amp;gt;\r\n    &amp;lt;meta name="viewport" content="width=device-width, initial-scale=1"&amp;gt;\r\n    &amp;lt;meta name="description" content="Neptron Timing event results"&amp;gt;\r\n\r\n    &amp;lt;link rel="shortcut icon" href="favicon.ico"&amp;gt;\r\n    &amp;lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css"&amp;gt;\r\n    &amp;lt;link rel="stylesheet" href="content/app.min.css"&amp;gt;\r\n    &amp;lt;script src="scripts/iframeResizer.contentWindow.min.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.0/es6-shim.min.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular.min.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular-route.min.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.0.2/Chart.min.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7OPJoYN6W9qUHU1L_fEr_5ut8tQN8r2A"&amp;gt;&amp;lt;/script&amp;gt;\r\n&amp;lt;/head&amp;gt;\r\n&amp;lt;body&amp;gt;\r\n    &amp;lt;div class="navbar navbar-inverse navbar-static-top" role="navigation"&amp;gt;\r\n        &amp;lt;div class="container"&amp;gt;\r\n            &amp;lt;div class="navbar-header"&amp;gt;\r\n                &amp;lt;button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"&amp;gt;\r\n                    &amp;lt;span class="sr-only"&amp;gt;Toggle navigation&amp;lt;/span&amp;gt;\r\n                    &amp;lt;span class="icon-bar"&amp;gt;&amp;lt;/span&amp;gt;\r\n                    &amp;lt;span class="icon-bar"&amp;gt;&amp;lt;/span&amp;gt;\r\n                    &amp;lt;span class="icon-bar"&amp;gt;&amp;lt;/span&amp;gt;\r\n                &amp;lt;/button&amp;gt;\r\n                &amp;lt;a class="navbar-brand" href="#"&amp;gt;Neptron Timing&amp;lt;/a&amp;gt;\r\n            &amp;lt;/div&amp;gt;\r\n            &amp;lt;div class="collapse navbar-collapse"&amp;gt;\r\n                &amp;lt;ul class="nav navbar-nav"&amp;gt;\r\n                    &amp;lt;li&amp;gt;&amp;lt;a href="#/"&amp;gt;Events&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;\r\n                    &amp;lt;li ng-show="event.id"&amp;gt;&amp;lt;a href="#/{{event.id}}/event"&amp;gt;Info&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;\r\n                    &amp;lt;li ng-show="event.id"&amp;gt;&amp;lt;a href="#/{{event.id}}/results"&amp;gt;Results&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;\r\n                    &amp;lt;li ng-show="event.id"&amp;gt;&amp;lt;a href="#/{{event.id}}/leaderboard"&amp;gt;Leaderboard&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;\r\n                    &amp;lt;li ng-show="event.id &amp;amp;&amp;amp; event.tracking"&amp;gt;&amp;lt;a href="#/{{event.id}}/tracking"&amp;gt;Tracking&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;\r\n                    &amp;lt;li ng-show="event.id"&amp;gt;&amp;lt;a href="#/{{event.id}}/favorites"&amp;gt;Favorites&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;\r\n                    &amp;lt;li ng-show="event.id &amp;amp;&amp;amp; event.sprints.length &amp;gt; 0"&amp;gt;&amp;lt;a href="#/{{event.id}}/sprint"&amp;gt;Sprint&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;\r\n                    &amp;lt;li ng-show="event.id &amp;amp;&amp;amp; event.teamCompetitions.length &amp;gt; 0"&amp;gt;&amp;lt;a href="#/{{event.id}}/teams"&amp;gt;Teams&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;\r\n                &amp;lt;/ul&amp;gt;\r\n            &amp;lt;/div&amp;gt;&amp;lt;!--/.nav-collapse --&amp;gt;\r\n        &amp;lt;/div&amp;gt;\r\n    &amp;lt;/div&amp;gt;\r\n  &amp;lt;script type="text/javascript"&amp;gt;\r\n\r\nvar fixLidingloppetMessage = function() {\r\n\tvar str = window.location.href || \'\';\r\n\tvar cssStyle = (str.match(\'lidingolor2017\') ? \'\' : \'none\');\r\n\t//console.log(\'changed: \'+str, cssStyle);\r\n\t$(\'#nytamin-fix\').css(\'display\', cssStyle);\r\n}\r\n$(window).bind(\'hashchange\', function() {\r\n\tfixLidingloppetMessage();\r\n});\r\nwindow.setInterval(fixLidingloppetMessage, 1000);\r\n\r\n&amp;lt;/script&amp;gt;\r\n\r\n&amp;lt;div class="container-fluid"&amp;gt;\r\n\t&amp;lt;div id="nytamin-fix" class="panel panel-primary" style="display: none; margin: 2em;"&amp;gt;\r\n\t  &amp;lt;div class="panel-heading"&amp;gt;Liding&amp;amp;ouml;loppet.se&amp;lt;/div&amp;gt;\r\n\t  &amp;lt;div class="panel-body"&amp;gt;\r\n\t\t\r\n\t\t&amp;lt;strong&amp;gt;&amp;lt;a href="http://213.39.39.152"&amp;gt;Click here to get back to Liding&amp;amp;ouml;loppet\'s homepage!&amp;lt;/a&amp;gt;&amp;lt;/strong&amp;gt;\r\n\r\n\t  &amp;lt;/div&amp;gt;\r\n\t&amp;lt;/div&amp;gt;\r\n&amp;lt;/div&amp;gt;\r\n    &amp;lt;div class="container-fluid" ng-view&amp;gt;&amp;lt;/div&amp;gt;\r\n  &amp;lt;div class="nt-app-links" style="margin:10px 20px"&amp;gt;\r\n    &amp;lt;a href="https://www.raceone.com/redirect" id="download-icon-footer-ios" target="_blank"&amp;gt;\r\n      &amp;lt;img class="download-icon" src="https://www.raceone.com/wp-content/uploads/2016/09/app-store-e1475238488598.png" alt=""&amp;gt;\r\n    &amp;lt;/a&amp;gt;\r\n    &amp;lt;a href="https://www.raceone.com/redirect" id="download-icon-footer-android" target="_blank"&amp;gt;\r\n      &amp;lt;img class="download-icon" src="https://www.raceone.com/wp-content/uploads/2016/09/google-play-e1475238513871.png" alt=""&amp;gt;\r\n    &amp;lt;/a&amp;gt;\r\n  &amp;lt;/div&amp;gt;\r\n\r\n    &amp;lt;script type="text/javascript" src="scripts/app.js"&amp;gt;&amp;lt;/script&amp;gt;\r\n\r\n    &amp;lt;!-- AddThis Button BEGIN --&amp;gt;\r\n    &amp;lt;div class="addthis_toolbox addthis_default_style addthis_32x32_style"&amp;gt;\r\n        &amp;lt;a class="addthis_button_facebook"&amp;gt;&amp;lt;/a&amp;gt;\r\n        &amp;lt;a class="addthis_button_twitter"&amp;gt;&amp;lt;/a&amp;gt;\r\n        &amp;lt;a class="addthis_button_linkedin"&amp;gt;&amp;lt;/a&amp;gt;\r\n        &amp;lt;a class="addthis_button_email"&amp;gt;&amp;lt;/a&amp;gt;\r\n        &amp;lt;a class="addthis_button_print"&amp;gt;&amp;lt;/a&amp;gt;\r\n        &amp;lt;a class="addthis_button_textme"&amp;gt;&amp;lt;/a&amp;gt;\r\n        &amp;lt;a class="addthis_button_compact"&amp;gt;&amp;lt;/a&amp;gt;\r\n    &amp;lt;/div&amp;gt;\r\n    &amp;lt;script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5364e093794f9d2f"&amp;gt;&amp;lt;/script&amp;gt;\r\n    &amp;lt;!-- AddThis Button END --&amp;gt;\r\n\r\n    &amp;lt;!--&amp;lt;div class="applinks"&amp;gt;\r\n        &amp;lt;a href="https://itunes.apple.com/se/app/neptron-timing/id709776903" target="_blank"&amp;gt;&amp;lt;img class="appstore" alt="Get it on iTunes" src="content/appstore.svg" /&amp;gt;&amp;lt;/a&amp;gt;\r\n        &amp;lt;a href="https://play.google.com/store/apps/details?id=se.neptron.timing" target="_blank"&amp;gt;&amp;lt;img class="playstore" alt="Get it on Google Play" src="content/playstore.png" /&amp;gt;&amp;lt;/a&amp;gt;\r\n    &amp;lt;/div&amp;gt;--&amp;gt;\r\n\r\n&amp;lt;/body&amp;gt;\r\n&amp;lt;/html&amp;gt;\r\n'&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;display_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;raw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea "&gt;
ï»¿


    &lt;title ng-bind="event.name || 'Neptron Timing'"&gt;Neptron Timing&lt;/title&gt;

    &lt;meta charset="utf-8"&gt;
    &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
    &lt;meta name="description" content="Neptron Timing event results"&gt;

    &lt;link rel="shortcut icon" href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/favicon.ico"&gt;
    &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css"&gt;
    &lt;link rel="stylesheet" href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/content/app.min.css"&gt;
    &lt;script src="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/scripts/iframeResizer.contentWindow.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/es6-shim/0.35.0/es6-shim.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.8/angular-route.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.13.0/moment.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.0.2/Chart.min.js"&gt;&lt;/script&gt;
    &lt;script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7OPJoYN6W9qUHU1L_fEr_5ut8tQN8r2A"&gt;&lt;/script&gt;


    &lt;div class="navbar navbar-inverse navbar-static-top" role="navigation"&gt;
        &lt;div class="container"&gt;
            &lt;div class="navbar-header"&gt;
                &lt;button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"&gt;
                    &lt;span class="sr-only"&gt;Toggle navigation&lt;/span&gt;
                    &lt;span class="icon-bar"&gt;&lt;/span&gt;
                    &lt;span class="icon-bar"&gt;&lt;/span&gt;
                    &lt;span class="icon-bar"&gt;&lt;/span&gt;
                &lt;/button&gt;
                &lt;a class="navbar-brand" href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/"&gt;Neptron Timing&lt;/a&gt;
            &lt;/div&gt;
            &lt;div class="collapse navbar-collapse"&gt;
                &lt;ul class="nav navbar-nav"&gt;
                    &lt;li&gt;&lt;a href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#/"&gt;Events&lt;/a&gt;&lt;/li&gt;
                    &lt;li ng-show="event.id"&gt;&lt;a href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#/%7B%7Bevent.id%7D%7D/event"&gt;Info&lt;/a&gt;&lt;/li&gt;
                    &lt;li ng-show="event.id"&gt;&lt;a href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#/%7B%7Bevent.id%7D%7D/results"&gt;Results&lt;/a&gt;&lt;/li&gt;
                    &lt;li ng-show="event.id"&gt;&lt;a href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#/%7B%7Bevent.id%7D%7D/leaderboard"&gt;Leaderboard&lt;/a&gt;&lt;/li&gt;
                    &lt;li ng-show="event.id &amp;amp;&amp;amp; event.tracking"&gt;&lt;a href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#/%7B%7Bevent.id%7D%7D/tracking"&gt;Tracking&lt;/a&gt;&lt;/li&gt;
                    &lt;li ng-show="event.id"&gt;&lt;a href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#/%7B%7Bevent.id%7D%7D/favorites"&gt;Favorites&lt;/a&gt;&lt;/li&gt;
                    &lt;li ng-show="event.id &amp;amp;&amp;amp; event.sprints.length &amp;gt; 0"&gt;&lt;a href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#/%7B%7Bevent.id%7D%7D/sprint"&gt;Sprint&lt;/a&gt;&lt;/li&gt;
                    &lt;li ng-show="event.id &amp;amp;&amp;amp; event.teamCompetitions.length &amp;gt; 0"&gt;&lt;a href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#/%7B%7Bevent.id%7D%7D/teams"&gt;Teams&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;&lt;!--/.nav-collapse --&gt;
        &lt;/div&gt;
    &lt;/div&gt;
  &lt;script type="text/javascript"&gt;

var fixLidingloppetMessage = function() {
	var str = window.location.href || '';
	var cssStyle = (str.match('lidingolor2017') ? '' : 'none');
	//console.log('changed: '+str, cssStyle);
	$('#nytamin-fix').css('display', cssStyle);
}
$(window).bind('hashchange', function() {
	fixLidingloppetMessage();
});
window.setInterval(fixLidingloppetMessage, 1000);

&lt;/script&gt;

&lt;div class="container-fluid"&gt;
	&lt;div id="nytamin-fix" class="panel panel-primary" style="display: none; margin: 2em;"&gt;
	  &lt;div class="panel-heading"&gt;Lidingöloppet.se&lt;/div&gt;
	  &lt;div class="panel-body"&gt;
		
		&lt;strong&gt;&lt;a href="http://213.39.39.152"&gt;Click here to get back to Lidingöloppet's homepage!&lt;/a&gt;&lt;/strong&gt;

	  &lt;/div&gt;
	&lt;/div&gt;
&lt;/div&gt;
    &lt;div class="container-fluid" ng-view&gt;&lt;/div&gt;
  &lt;div class="nt-app-links" style="margin:10px 20px"&gt;
    &lt;a href="https://www.raceone.com/redirect" id="download-icon-footer-ios" target="_blank"&gt;
      &lt;img class="download-icon" src="https://www.raceone.com/wp-content/uploads/2016/09/app-store-e1475238488598.png" alt=""&gt;
    &lt;/a&gt;
    &lt;a href="https://www.raceone.com/redirect" id="download-icon-footer-android" target="_blank"&gt;
      &lt;img class="download-icon" src="https://www.raceone.com/wp-content/uploads/2016/09/google-play-e1475238513871.png" alt=""&gt;
    &lt;/a&gt;
  &lt;/div&gt;

    &lt;script type="text/javascript" src="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/scripts/app.js"&gt;&lt;/script&gt;

    &lt;!-- AddThis Button BEGIN --&gt;
    &lt;div class="addthis_toolbox addthis_default_style addthis_32x32_style"&gt;
        &lt;a class="addthis_button_facebook"&gt;&lt;/a&gt;
        &lt;a class="addthis_button_twitter"&gt;&lt;/a&gt;
        &lt;a class="addthis_button_linkedin"&gt;&lt;/a&gt;
        &lt;a class="addthis_button_email"&gt;&lt;/a&gt;
        &lt;a class="addthis_button_print"&gt;&lt;/a&gt;
        &lt;a class="addthis_button_textme"&gt;&lt;/a&gt;
        &lt;a class="addthis_button_compact"&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5364e093794f9d2f"&gt;&lt;/script&gt;
    &lt;!-- AddThis Button END --&gt;

    &lt;!--&lt;div class="applinks"&gt;
        &lt;a href="https://itunes.apple.com/se/app/neptron-timing/id709776903" target="_blank"&gt;&lt;img class="appstore" alt="Get it on iTunes" src="content/appstore.svg" /&gt;&lt;/a&gt;
        &lt;a href="https://play.google.com/store/apps/details?id=se.neptron.timing" target="_blank"&gt;&lt;img class="playstore" alt="Get it on Google Play" src="content/playstore.png" /&gt;&lt;/a&gt;
    &lt;/div&gt;--&gt;




&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;There is no table in the HTML sent by the server.
The table is rendered on the client side by AngularJS. We can check that by looking at the page source in Chrome:
&lt;img src="http://beenje.github.io/blog/images/pyppeteer/results_lundaloppet_2018_source.png" alt="Results Lundaloppet 2018 source"&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;How do you parse JavaScript rendered page in Python? Don't we need a browser to run the JavaScript code?
By googling, I found &lt;a href="https://github.com/kennethreitz/requests-html"&gt;Requests-HTML&lt;/a&gt; that has JavaScript support!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Requests-HTML"&gt;Requests-HTML&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#Requests-HTML"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;requests_html&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HTMLSession&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;session&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HTMLSession&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=0&amp;amp;pageSize=25'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'table'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;display_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;raw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea "&gt;
&lt;table&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th class="res-favorite"&gt; &lt;/th&gt;
                        &lt;!-- ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-placeByRace " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Place&lt;br&gt;(race)&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-placeByCategory " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Place&lt;br&gt;(cat)&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-startNo " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Bib no&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-category " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Category&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-name " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Name&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-flag " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-association " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Association&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-lastSplitPoint " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Progress&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-time " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Time&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;&lt;th class="res-status " ng-repeat="item in vm.resultsHeader"&gt;&lt;span ng-bind-html="item.value" class="ng-binding"&gt;Status&lt;/span&gt;&lt;/th&gt;&lt;!-- end ngRepeat: item in vm.resultsHeader --&gt;
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    &lt;!-- ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="1" class="ng-binding"&gt;1&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="1" class="ng-binding"&gt;1&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="6922" class="ng-binding"&gt;6922&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Hans Larsson" class="ng-binding"&gt;Hans Larsson&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="MAI" class="ng-binding"&gt;MAI&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="33:22" class="ng-binding"&gt;33:22&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="2" class="ng-binding"&gt;2&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="2" class="ng-binding"&gt;2&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="6514" class="ng-binding"&gt;6514&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Filip Helmroth" class="ng-binding"&gt;Filip Helmroth&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="IK Lerum Friidrott" class="ng-binding"&gt;IK Lerum Friidrott&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="33:37" class="ng-binding"&gt;33:37&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3" class="ng-binding"&gt;3&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3" class="ng-binding"&gt;3&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3920" class="ng-binding"&gt;3920&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="David Hartman" class="ng-binding"&gt;David Hartman&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Björnstorps IF" class="ng-binding"&gt;Björnstorps IF&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="33:39" class="ng-binding"&gt;33:39&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="4" class="ng-binding"&gt;4&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="4" class="ng-binding"&gt;4&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3926" class="ng-binding"&gt;3926&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Henrik Orre" class="ng-binding"&gt;Henrik Orre&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Björnstorps IF" class="ng-binding"&gt;Björnstorps IF&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="34:24" class="ng-binding"&gt;34:24&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="5" class="ng-binding"&gt;5&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="5" class="ng-binding"&gt;5&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="2666" class="ng-binding"&gt;2666&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Jesper Bokefors" class="ng-binding"&gt;Jesper Bokefors&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Malmö AI" class="ng-binding"&gt;Malmö AI&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="34:51" class="ng-binding"&gt;34:51&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="6" class="ng-binding"&gt;6&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="6" class="ng-binding"&gt;6&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="5729" class="ng-binding"&gt;5729&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Juan Negreira" class="ng-binding"&gt;Juan Negreira&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Lunds universitet" class="ng-binding"&gt;Lunds universitet&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="35:19" class="ng-binding"&gt;35:19&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="7" class="ng-binding"&gt;7&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="7" class="ng-binding"&gt;7&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3649" class="ng-binding"&gt;3649&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Jim Webb" class="ng-binding"&gt;Jim Webb&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="   " class="ng-binding"&gt;   &lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="35:23" class="ng-binding"&gt;35:23&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="8" class="ng-binding"&gt;8&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="8" class="ng-binding"&gt;8&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3675" class="ng-binding"&gt;3675&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Nils Wetterberg" class="ng-binding"&gt;Nils Wetterberg&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Ekmans Löpare i Lund" class="ng-binding"&gt;Ekmans Löpare i Lund&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="35:39" class="ng-binding"&gt;35:39&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="9" class="ng-binding"&gt;9&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="9" class="ng-binding"&gt;9&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="4880" class="ng-binding"&gt;4880&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Hannes Hjalmarsson" class="ng-binding"&gt;Hannes Hjalmarsson&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Lunds kommun" class="ng-binding"&gt;Lunds kommun&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="35:41" class="ng-binding"&gt;35:41&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="10" class="ng-binding"&gt;10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="10" class="ng-binding"&gt;10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="6929" class="ng-binding"&gt;6929&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Freyi Karlsson" class="ng-binding"&gt;Freyi Karlsson&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Ekmans löpare i lund" class="ng-binding"&gt;Ekmans löpare i lund&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="35:42" class="ng-binding"&gt;35:42&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="11" class="ng-binding"&gt;11&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="11" class="ng-binding"&gt;11&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="5995" class="ng-binding"&gt;5995&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Shijie Xu" class="ng-binding"&gt;Shijie Xu&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Lunds universitet" class="ng-binding"&gt;Lunds universitet&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="35:43" class="ng-binding"&gt;35:43&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="12" class="ng-binding"&gt;12&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="12" class="ng-binding"&gt;12&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="5276" class="ng-binding"&gt;5276&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Stuart Ansell" class="ng-binding"&gt;Stuart Ansell&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Lunds universitet" class="ng-binding"&gt;Lunds universitet&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:02" class="ng-binding"&gt;36:02&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="13" class="ng-binding"&gt;13&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="13" class="ng-binding"&gt;13&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3917" class="ng-binding"&gt;3917&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Christer Friberg" class="ng-binding"&gt;Christer Friberg&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Björnstorps IF" class="ng-binding"&gt;Björnstorps IF&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:15" class="ng-binding"&gt;36:15&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="14" class="ng-binding"&gt;14&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="14" class="ng-binding"&gt;14&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="5647" class="ng-binding"&gt;5647&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Roger Lindskog" class="ng-binding"&gt;Roger Lindskog&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Lunds universitet" class="ng-binding"&gt;Lunds universitet&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:15" class="ng-binding"&gt;36:15&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="15" class="ng-binding"&gt;15&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="15" class="ng-binding"&gt;15&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3616" class="ng-binding"&gt;3616&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Andreas Thell" class="ng-binding"&gt;Andreas Thell&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Ystads IF Friidrott" class="ng-binding"&gt;Ystads IF Friidrott&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:20" class="ng-binding"&gt;36:20&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="16" class="ng-binding"&gt;16&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="16" class="ng-binding"&gt;16&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="6382" class="ng-binding"&gt;6382&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Tommy Olofsson" class="ng-binding"&gt;Tommy Olofsson&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Tetra Pak IF" class="ng-binding"&gt;Tetra Pak IF&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:20" class="ng-binding"&gt;36:20&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="17" class="ng-binding"&gt;17&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="17" class="ng-binding"&gt;17&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3183" class="ng-binding"&gt;3183&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Kristoffer  Loo" class="ng-binding"&gt;Kristoffer  Loo&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="   " class="ng-binding"&gt;   &lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:36" class="ng-binding"&gt;36:36&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="18" class="ng-binding"&gt;18&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="18" class="ng-binding"&gt;18&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="2664" class="ng-binding"&gt;2664&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Alfred Bodenäs" class="ng-binding"&gt;Alfred Bodenäs&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Triathlon Syd" class="ng-binding"&gt;Triathlon Syd&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:44" class="ng-binding"&gt;36:44&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="19" class="ng-binding"&gt;19&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="19" class="ng-binding"&gt;19&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="6979" class="ng-binding"&gt;6979&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Daniel Jonsson" class="ng-binding"&gt;Daniel Jonsson&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="   " class="ng-binding"&gt;   &lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:54" class="ng-binding"&gt;36:54&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="20" class="ng-binding"&gt;20&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="20" class="ng-binding"&gt;20&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="4977" class="ng-binding"&gt;4977&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Johan Lindgren" class="ng-binding"&gt;Johan Lindgren&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Lunds kommun" class="ng-binding"&gt;Lunds kommun&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="36:58" class="ng-binding"&gt;36:58&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="21" class="ng-binding"&gt;21&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="21" class="ng-binding"&gt;21&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3495" class="ng-binding"&gt;3495&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Erik Schultz-Eklund" class="ng-binding"&gt;Erik Schultz-Eklund&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Agape Lund" class="ng-binding"&gt;Agape Lund&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="37:20" class="ng-binding"&gt;37:20&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="22" class="ng-binding"&gt;22&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="22" class="ng-binding"&gt;22&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3571" class="ng-binding"&gt;3571&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Daniel Strandberg" class="ng-binding"&gt;Daniel Strandberg&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Malmö AI" class="ng-binding"&gt;Malmö AI&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="37:28" class="ng-binding"&gt;37:28&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="23" class="ng-binding"&gt;23&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="23" class="ng-binding"&gt;23&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="3121" class="ng-binding"&gt;3121&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Martin Larsson" class="ng-binding"&gt;Martin Larsson&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="inQore-part of Qgroup" class="ng-binding"&gt;inQore-part of Qgroup&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="37:32" class="ng-binding"&gt;37:32&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope even"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="24" class="ng-binding"&gt;24&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="24" class="ng-binding"&gt;24&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="5955" class="ng-binding"&gt;5955&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Johan Vallon-Christersson" class="ng-binding"&gt;Johan Vallon-Christersson&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Lunds universitet" class="ng-binding"&gt;Lunds universitet&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="37:33" class="ng-binding"&gt;37:33&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;&lt;tr ng-class-odd="'odd'" ng-class-even="'even'" ng-repeat="row in vm.resultsRows" class="ng-scope odd"&gt;
                        &lt;td class="res-favorite"&gt;&lt;div title="Add to favorites" ng-click="vm.toggleFav(row.result)"&gt;&lt;span class="glyphicon glyphicon-star-empty"&gt;&lt;/span&gt;&lt;/div&gt;&lt;/td&gt;
                        &lt;!-- ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByRace " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="25" class="ng-binding"&gt;25&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-placeByCategory " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="25" class="ng-binding"&gt;25&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-startNo " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="6675" class="ng-binding"&gt;6675&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-category " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="P10" class="ng-binding"&gt;P10&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-name " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Kristian  Haggärde" class="ng-binding"&gt;Kristian  Haggärde&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-flag " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="" class="ng-binding"&gt;&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-association " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Björnstorps IF" class="ng-binding"&gt;Björnstorps IF&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-lastSplitPoint " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finish" class="ng-binding"&gt;Finish&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-time " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="37:34" class="ng-binding"&gt;37:34&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;&lt;td class="res-status " ng-click="vm.openResult(row.result)" ng-repeat="cell in row.cells"&gt;&lt;div data-value="Finished" class="ng-binding"&gt;Finished&lt;/div&gt;&lt;/td&gt;&lt;!-- end ngRepeat: cell in row.cells --&gt;
                    &lt;/tr&gt;&lt;!-- end ngRepeat: row in vm.resultsRows --&gt;
                &lt;/tbody&gt;
            &lt;/table&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Wow! Isn't that magic? We'll explore a bit later how this works.&lt;/p&gt;
&lt;p&gt;What I want to get is all the results, not just the first 25. I tried increasing the &lt;em&gt;pageSize&lt;/em&gt; passed in the URL, but that didn't help. Even passing a lower value always returns 25 rows. Not sure how the API is implemented...&lt;/p&gt;
&lt;p&gt;An issue I had with requests-html is that sometimes &lt;code&gt;r.html.find('table', first=True)&lt;/code&gt; returned &lt;code&gt;None&lt;/code&gt; or an empty table...&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=63&amp;amp;pageSize=25'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;render&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'table'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_text output_error"&gt;
&lt;pre&gt;
&lt;span class="ansi-red-fg"&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class="ansi-red-fg"&gt;IndexError&lt;/span&gt;                                Traceback (most recent call last)
&lt;span class="ansi-green-fg"&gt;&amp;lt;ipython-input-9-e9d6c036862c&amp;gt;&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;()&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      2&lt;/span&gt; r&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;html&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;render&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;      3&lt;/span&gt; table &lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt; r&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;html&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;find&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;'table'&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; first&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;&lt;span class="ansi-green-fg"&gt;True&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;----&amp;gt; 4&lt;/span&gt;&lt;span class="ansi-red-fg"&gt; &lt;/span&gt;pd&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;read_html&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;table&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;html&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;[&lt;/span&gt;&lt;span class="ansi-cyan-fg"&gt;0&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;]&lt;/span&gt;

&lt;span class="ansi-red-fg"&gt;IndexError&lt;/span&gt;: list index out of range&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;That's probably a timing issue (the rendering might take longer sometimes). I tried playing with the &lt;code&gt;wait&lt;/code&gt; and &lt;code&gt;sleep&lt;/code&gt; arguments of &lt;code&gt;r.html.render(wait=1, sleep=1)&lt;/code&gt; but couldn't make the problem completetly go away. This is an issue because I don't need just one page but 135.&lt;/p&gt;
&lt;p&gt;I started to look at &lt;a href="https://github.com/kennethreitz/requests-html/blob/master/requests_html.py"&gt;requests-html&lt;/a&gt; code to see how this was implemented. That's how I discovered &lt;a href="https://github.com/miyakogi/pyppeteer"&gt;pyppeteer&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Pyppeteer"&gt;Pyppeteer&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#Pyppeteer"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;&lt;a href="https://miyakogi.github.io/pyppeteer/"&gt;Pyppeteer&lt;/a&gt; is an unofficial Python port of &lt;a href="https://github.com/GoogleChrome/puppeteer"&gt;puppeteer&lt;/a&gt; JavaScript (headless) chrome/chromium browser automation library.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Puppeteer is a Node library which provides a high-level API to control headless Chrome or Chromium over the DevTools Protocol.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Pyppeteer allows you to do the same from Python.
So there is no &lt;em&gt;magic&lt;/em&gt;. You just let Chromium load and render the page with the latest JavaScript and browser features. This is super powerful.&lt;/p&gt;
&lt;p&gt;The first time you run pyppeteer, it even downloads a recent version of Chromium. So no initial setup is required.&lt;/p&gt;
&lt;p&gt;Pyppeteer is based on &lt;a href="https://docs.python.org/3/library/asyncio.html"&gt;asyncio&lt;/a&gt;. This is hidden by requests-html that gives you a simple interface but of course less flexibility.&lt;/p&gt;
&lt;p&gt;So let's explore pyppeteer. The first example from the documentation is how to take a screenshot of a page.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyppeteer&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;

&lt;span class="k"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newPage&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;goto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://example.com'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;screenshot&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'path'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'example.png'&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's try that with our page. Note that I pass the &lt;code&gt;fullPage&lt;/code&gt; option otherwise the page is cut.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyppeteer&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;


&lt;span class="k"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newPage&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;goto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=0&amp;amp;pageSize=25'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;screenshot&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'path'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'pyppeteer_screenshot.png'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'fullPage'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Here is the screenshot taken:
&lt;img src="http://beenje.github.io/blog/images/pyppeteer/pyppeteer_screenshot.png" alt="Pyppeteer screenshot"&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Nice, no?
This example showed us how to load a page:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;create a browser&lt;/li&gt;
&lt;li&gt;create a new page&lt;/li&gt;
&lt;li&gt;goto a page&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;There are several functions that can be used to retrieve elements from the page, like &lt;a href="https://miyakogi.github.io/pyppeteer/reference.html#pyppeteer.page.Page.querySelector"&gt;querySelector&lt;/a&gt; or &lt;a href="https://miyakogi.github.io/pyppeteer/reference.html#pyppeteer.page.Page.querySelectorEval"&gt;querySelectorEval&lt;/a&gt;. This is the function we gonna use to retrieve the table. We use the &lt;code&gt;table&lt;/code&gt; selector and apply the &lt;code&gt;outerHTML&lt;/code&gt; function to get the HTML representation of the table:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;querySelectorEval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'table'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'(element) =&amp;gt; element.outerHTML'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can then pass that to pandas.&lt;/p&gt;
&lt;p&gt;One thing we wanted is to wait for the table to be rendered before trying to retrieve it. We can use the &lt;a href="https://miyakogi.github.io/pyppeteer/reference.html#pyppeteer.page.Page.waitForSelector"&gt;waitForSelector&lt;/a&gt; function for that.
I initially tried to use the &lt;code&gt;table&lt;/code&gt; selector but that sometimes returned an empty table. So I chose a class of one row element &lt;code&gt;td.res-startNo&lt;/code&gt; to be sure that the table was rendered.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyppeteer&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;


&lt;span class="k"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newPage&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;goto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://results.neptron.se/#/lundaloppet2018/?sortOrder=Place&amp;amp;raceId=99&amp;amp;page=0&amp;amp;pageSize=25'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;waitForSelector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'td.res-startNo'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;querySelectorEval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'table'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'(element) =&amp;gt; element.outerHTML'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Unnamed: 0&lt;/th&gt;
      &lt;th&gt;Place(race)&lt;/th&gt;
      &lt;th&gt;Place(cat)&lt;/th&gt;
      &lt;th&gt;Bib no&lt;/th&gt;
      &lt;th&gt;Category&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Unnamed: 6&lt;/th&gt;
      &lt;th&gt;Association&lt;/th&gt;
      &lt;th&gt;Progress&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
      &lt;th&gt;Status&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;6922&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Hans Larsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;MAI&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;33:22&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;6514&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Filip Helmroth&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;IK Lerum Friidrott&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;33:37&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;3920&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;David Hartman&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Björnstorps IF&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;33:39&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;3926&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Henrik Orre&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Björnstorps IF&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;34:24&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;2666&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Jesper Bokefors&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Malmö AI&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;34:51&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;5729&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Juan Negreira&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds universitet&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;35:19&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;3649&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Jim Webb&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;35:23&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;8&lt;/td&gt;
      &lt;td&gt;3675&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Nils Wetterberg&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Ekmans Löpare i Lund&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;35:39&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;4880&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Hannes Hjalmarsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds kommun&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;35:41&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;10&lt;/td&gt;
      &lt;td&gt;6929&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Freyi Karlsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Ekmans löpare i lund&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;35:42&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;11&lt;/td&gt;
      &lt;td&gt;5995&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Shijie Xu&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds universitet&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;35:43&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;12&lt;/td&gt;
      &lt;td&gt;12&lt;/td&gt;
      &lt;td&gt;5276&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Stuart Ansell&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds universitet&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:02&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
      &lt;td&gt;13&lt;/td&gt;
      &lt;td&gt;3917&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Christer Friberg&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Björnstorps IF&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:15&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;5647&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Roger Lindskog&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds universitet&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:15&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
      &lt;td&gt;15&lt;/td&gt;
      &lt;td&gt;3616&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Andreas Thell&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Ystads IF Friidrott&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:20&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;16&lt;/td&gt;
      &lt;td&gt;16&lt;/td&gt;
      &lt;td&gt;6382&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Tommy Olofsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Tetra Pak IF&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:20&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;17&lt;/td&gt;
      &lt;td&gt;17&lt;/td&gt;
      &lt;td&gt;3183&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Kristoffer Loo&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:36&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;18&lt;/td&gt;
      &lt;td&gt;18&lt;/td&gt;
      &lt;td&gt;2664&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Alfred Bodenäs&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Triathlon Syd&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:44&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;19&lt;/td&gt;
      &lt;td&gt;19&lt;/td&gt;
      &lt;td&gt;6979&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Daniel Jonsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:54&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;20&lt;/td&gt;
      &lt;td&gt;4977&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Johan Lindgren&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds kommun&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;36:58&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;21&lt;/td&gt;
      &lt;td&gt;3495&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Erik Schultz-Eklund&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Agape Lund&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;37:20&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;22&lt;/td&gt;
      &lt;td&gt;3571&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Daniel Strandberg&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Malmö AI&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;37:28&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;23&lt;/td&gt;
      &lt;td&gt;23&lt;/td&gt;
      &lt;td&gt;3121&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Martin Larsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;inQore-part of Qgroup&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;37:32&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;23&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;24&lt;/td&gt;
      &lt;td&gt;24&lt;/td&gt;
      &lt;td&gt;5955&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Johan Vallon-Christersson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds universitet&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;37:33&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;24&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;25&lt;/td&gt;
      &lt;td&gt;25&lt;/td&gt;
      &lt;td&gt;6675&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Kristian Haggärde&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Björnstorps IF&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;37:34&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;That's a bit more code than with requests-HTML but we have finer control.
Let's refactor that code to retrieve all the results of the race.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyppeteer&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;

&lt;span class="n"&gt;URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'http://results.neptron.se/#/lundaloppet2018/results?sortOrder=Place&amp;amp;raceId=99&amp;amp;pageSize=25&amp;amp;page=&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;


&lt;span class="k"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_page&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Return a page after waiting for the given selector"""&lt;/span&gt;
    &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;newPage&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;goto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;waitForSelector&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;selector&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;


&lt;span class="k"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_num_pages&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Return the total number of pages available"""&lt;/span&gt;
    &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;get_page&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;URL&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;'div.ng-isolate-scope'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;num_pages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;querySelectorEval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="s1"&gt;'div.ng-isolate-scope'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s1"&gt;'(element) =&amp;gt; element.getAttribute("data-num-pages")'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;num_pages&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;page_nb&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Return the table from the given page number as a pandas dataframe"""&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;'Get table from page &lt;/span&gt;&lt;span class="si"&gt;{page_nb}&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;get_page&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;URL&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;page_nb&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;'td.res-startNo'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;table&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;querySelectorEval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'table'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'(element) =&amp;gt; element.outerHTML'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;table&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;


&lt;span class="k"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_results&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="sd"&gt;"""Return all the results as a pandas dataframe"""&lt;/span&gt;
    &lt;span class="n"&gt;browser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;launch&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;num_pages&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;get_num_pages&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;'Number of pages: &lt;/span&gt;&lt;span class="si"&gt;{num_pages}&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# Python 3.6 asynchronous comprehensions! Nice!&lt;/span&gt;
    &lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;get_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;page_nb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;page_nb&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_pages&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
    &lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ignore_index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This code could be made a bit more generic but that's good enough for what I want.
I think it's quite straightforward. We first get the total number of pages and then load each page to retrieve the table.
Once done, we just have to concatenate all those tables in one.&lt;/p&gt;
&lt;p&gt;One thing to note is the use of Python &lt;a href="https://www.python.org/dev/peps/pep-0530/"&gt;asynchronous comprehensions&lt;/a&gt;. This is a Python 3.6 feature and makes it really Pythonic. It just works as it would with synchronous functions:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt; &lt;span class="n"&gt;get_table&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;browser&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;page_nb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;page_nb&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;num_pages&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Let's run that code!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_results&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Number of pages: 115
Get table from page 0
Get table from page 1
Get table from page 2
Get table from page 3
Get table from page 4
Get table from page 5
Get table from page 6
Get table from page 7
Get table from page 8
Get table from page 9
Get table from page 10
Get table from page 11
Get table from page 12
Get table from page 13
Get table from page 14
Get table from page 15
Get table from page 16
Get table from page 17
Get table from page 18
Get table from page 19
Get table from page 20
Get table from page 21
Get table from page 22
Get table from page 23
Get table from page 24
Get table from page 25
Get table from page 26
Get table from page 27
Get table from page 28
Get table from page 29
Get table from page 30
Get table from page 31
Get table from page 32
Get table from page 33
Get table from page 34
Get table from page 35
Get table from page 36
Get table from page 37
Get table from page 38
Get table from page 39
Get table from page 40
Get table from page 41
Get table from page 42
Get table from page 43
Get table from page 44
Get table from page 45
Get table from page 46
Get table from page 47
Get table from page 48
Get table from page 49
Get table from page 50
Get table from page 51
Get table from page 52
Get table from page 53
Get table from page 54
Get table from page 55
Get table from page 56
Get table from page 57
Get table from page 58
Get table from page 59
Get table from page 60
Get table from page 61
Get table from page 62
Get table from page 63
Get table from page 64
Get table from page 65
Get table from page 66
Get table from page 67
Get table from page 68
Get table from page 69
Get table from page 70
Get table from page 71
Get table from page 72
Get table from page 73
Get table from page 74
Get table from page 75
Get table from page 76
Get table from page 77
Get table from page 78
Get table from page 79
Get table from page 80
Get table from page 81
Get table from page 82
Get table from page 83
Get table from page 84
Get table from page 85
Get table from page 86
Get table from page 87
Get table from page 88
Get table from page 89
Get table from page 90
Get table from page 91
Get table from page 92
Get table from page 93
Get table from page 94
Get table from page 95
Get table from page 96
Get table from page 97
Get table from page 98
Get table from page 99
Get table from page 100
Get table from page 101
Get table from page 102
Get table from page 103
Get table from page 104
Get table from page 105
Get table from page 106
Get table from page 107
Get table from page 108
Get table from page 109
Get table from page 110
Get table from page 111
Get table from page 112
Get table from page 113
Get table from page 114
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;That's it! We got all the results from the Lundaloppet 2018 in a nice pandas DataFrame.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[14]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;2872&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[15]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Unnamed: 0&lt;/th&gt;
      &lt;th&gt;Place(race)&lt;/th&gt;
      &lt;th&gt;Place(cat)&lt;/th&gt;
      &lt;th&gt;Bib no&lt;/th&gt;
      &lt;th&gt;Category&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Unnamed: 6&lt;/th&gt;
      &lt;th&gt;Association&lt;/th&gt;
      &lt;th&gt;Progress&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
      &lt;th&gt;Status&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;6922&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Hans Larsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;MAI&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;33:22&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;6514&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Filip Helmroth&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;IK Lerum Friidrott&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;33:37&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;3920&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;David Hartman&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Björnstorps IF&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;33:39&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;3926&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Henrik Orre&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Björnstorps IF&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;34:24&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
      &lt;td&gt;2666&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Jesper Bokefors&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Malmö AI&lt;/td&gt;
      &lt;td&gt;Finish&lt;/td&gt;
      &lt;td&gt;34:51&lt;/td&gt;
      &lt;td&gt;Finished&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[16]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Unnamed: 0&lt;/th&gt;
      &lt;th&gt;Place(race)&lt;/th&gt;
      &lt;th&gt;Place(cat)&lt;/th&gt;
      &lt;th&gt;Bib no&lt;/th&gt;
      &lt;th&gt;Category&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Unnamed: 6&lt;/th&gt;
      &lt;th&gt;Association&lt;/th&gt;
      &lt;th&gt;Progress&lt;/th&gt;
      &lt;th&gt;Time&lt;/th&gt;
      &lt;th&gt;Status&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2867&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;6855&lt;/td&gt;
      &lt;td&gt;T10&lt;/td&gt;
      &lt;td&gt;porntepin sooksaengprasit&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds universitet&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Not started&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2868&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;6857&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Gabriel Teku&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Lunds universitet&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Not started&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2869&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;6888&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Viktor Karlsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Genarps if&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Not started&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2870&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;6892&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Emil Larsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Not started&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2871&lt;/th&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;6893&lt;/td&gt;
      &lt;td&gt;P10&lt;/td&gt;
      &lt;td&gt;Göran Larsson&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;Not started&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's save the result to a csv file&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_csv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'lundaloppet2018.csv'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Summary"&gt;Summary&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/#Summary"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;With frameworks like &lt;a href="https://angularjs.org"&gt;AngularJS&lt;/a&gt;, &lt;a href="https://reactjs.org"&gt;React&lt;/a&gt;, &lt;a href="https://vuejs.org"&gt;Vue.js&lt;/a&gt;... more and more websites use client-side rendering. To parse those websites, you can't just request HTML from the server. Parsing requires to run some JavaScript.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://miyakogi.github.io/pyppeteer/"&gt;Pyppeteer&lt;/a&gt; makes that possible. Thanks to &lt;a href="https://chromium.googlesource.com/chromium/src/+/lkgr/headless/README.md"&gt;Headless Chomium&lt;/a&gt;, it gives you access to the full power of a browser from Python. I find that really impressive!&lt;/p&gt;
&lt;p&gt;I tried to use &lt;a href="https://www.seleniumhq.org"&gt;Selenium&lt;/a&gt; in the past but didn't find it very easy to start with. That wasn't the case with Pyppeteer. To be fair, it was a while ago and both projects are quite different. It's not just about browser automation. Selenium allows you to perform cross browser testing. Pyppeteer is limited to Chrome/Chromium.
Anyway, I'll probably look more at Pyppeteer for web application testing.&lt;/p&gt;
&lt;p&gt;For simple tasks, &lt;a href="https://github.com/kennethreitz/requests-html"&gt;Requests-HTML&lt;/a&gt; is a nice wrapper and gives you a simple API. If you want more control, use directly Pyppeteer.&lt;/p&gt;
&lt;p&gt;One last note. To run this code in a Jupyter notebook, you should use tornado 4. asyncio code doesn't play well with ipython and tornado 5. See this Github issue: &lt;a href="https://github.com/ipython/ipython/issues/11030"&gt;asyncio will be running by default with tornado 5&lt;/a&gt;. There is some &lt;a href="https://github.com/ipython/ipython/pull/11155"&gt;work in progress&lt;/a&gt; for a nice integration.&lt;/p&gt;
&lt;p&gt;What about the Lundaloppet results you might ask? I'll explore them in another post!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>javascript</category><category>pandas</category><category>pyppeteer</category><category>python</category><category>request-html</category><category>requests</category><guid>http://beenje.github.io/blog/posts/parsing-javascript-rendered-pages-in-python-with-pyppeteer/</guid><pubDate>Sat, 02 Jun 2018 20:54:45 GMT</pubDate></item><item><title>Parsing HTML Tables in Python with pandas</title><link>http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Not long ago, I needed to parse some HTML tables from our confluence website at work. I first thought: I'm gonna need &lt;a href="http://docs.python-requests.org/en/master/"&gt;requests&lt;/a&gt; and &lt;a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/"&gt;BeautifulSoup&lt;/a&gt;. As HTML tables are well defined, I did some quick googling to see if there was some recipe or lib to parse them and I found a link to &lt;a href="https://pandas.pydata.org"&gt;pandas&lt;/a&gt;. What? Can pandas do that too?&lt;/p&gt;
&lt;p&gt;I have been using pandas for quite some time and have used read_csv, read_excel, even read_sql, but I had missed read_html!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Reading-excel-file-with-pandas"&gt;Reading excel file with pandas&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/#Reading-excel-file-with-pandas"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Before to look at HTML tables, I want to show a quick example on how to read an excel file with pandas. The API is really nice. If I have to look at some excel data, I go directly to pandas.&lt;/p&gt;
&lt;p&gt;So let's download a sample file file:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;io&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;zipfile&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ZipFile&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://www.contextures.com/SampleData.zip'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;ZipFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BytesIO&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extractall&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This created the &lt;em&gt;SampleData.xlsx&lt;/em&gt; file that includes four sheets: Instructions, SalesOrders, SampleNumbers and MyLinks. Only the &lt;em&gt;SalesOrders&lt;/em&gt; sheet includes tabular data:
&lt;img src="http://beenje.github.io/blog/images/read_html/sample_data_xlsx.png" alt="SampleData"&gt;
So let's read it.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_excel&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'SampleData.xlsx'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sheet_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'SalesOrders'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[4]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;OrderDate&lt;/th&gt;
      &lt;th&gt;Region&lt;/th&gt;
      &lt;th&gt;Rep&lt;/th&gt;
      &lt;th&gt;Item&lt;/th&gt;
      &lt;th&gt;Units&lt;/th&gt;
      &lt;th&gt;Unit Cost&lt;/th&gt;
      &lt;th&gt;Total&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2016-01-06&lt;/td&gt;
      &lt;td&gt;East&lt;/td&gt;
      &lt;td&gt;Jones&lt;/td&gt;
      &lt;td&gt;Pencil&lt;/td&gt;
      &lt;td&gt;95&lt;/td&gt;
      &lt;td&gt;1.99&lt;/td&gt;
      &lt;td&gt;189.05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2016-01-23&lt;/td&gt;
      &lt;td&gt;Central&lt;/td&gt;
      &lt;td&gt;Kivell&lt;/td&gt;
      &lt;td&gt;Binder&lt;/td&gt;
      &lt;td&gt;50&lt;/td&gt;
      &lt;td&gt;19.99&lt;/td&gt;
      &lt;td&gt;999.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2016-02-09&lt;/td&gt;
      &lt;td&gt;Central&lt;/td&gt;
      &lt;td&gt;Jardine&lt;/td&gt;
      &lt;td&gt;Pencil&lt;/td&gt;
      &lt;td&gt;36&lt;/td&gt;
      &lt;td&gt;4.99&lt;/td&gt;
      &lt;td&gt;179.64&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2016-02-26&lt;/td&gt;
      &lt;td&gt;Central&lt;/td&gt;
      &lt;td&gt;Gill&lt;/td&gt;
      &lt;td&gt;Pen&lt;/td&gt;
      &lt;td&gt;27&lt;/td&gt;
      &lt;td&gt;19.99&lt;/td&gt;
      &lt;td&gt;539.73&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2016-03-15&lt;/td&gt;
      &lt;td&gt;West&lt;/td&gt;
      &lt;td&gt;Sorvino&lt;/td&gt;
      &lt;td&gt;Pencil&lt;/td&gt;
      &lt;td&gt;56&lt;/td&gt;
      &lt;td&gt;2.99&lt;/td&gt;
      &lt;td&gt;167.44&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;That's it. One line and you have your data in a DataFrame that you can easily manipulate, filter, convert and display in a jupyter notebook. Can it be easier than that?&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Parsing-HTML-Tables"&gt;Parsing HTML Tables&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/#Parsing-HTML-Tables"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;So let's go back to HTML tables and look at &lt;a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_html.html"&gt;pandas.read_html&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The function accepts:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;A URL, a file-like object, or a raw string containing HTML.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let's start with a basic HTML table in a raw string.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Parsing-raw-string"&gt;Parsing raw string&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/#Parsing-raw-string"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;html_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"""&lt;/span&gt;
&lt;span class="s2"&gt;&amp;lt;table&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;thead&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;th&amp;gt;Programming Language&amp;lt;/th&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;th&amp;gt;Creator&amp;lt;/th&amp;gt; &lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;th&amp;gt;Year&amp;lt;/th&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;/thead&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;tbody&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;C&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;Dennis Ritchie&amp;lt;/td&amp;gt; &lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;1972&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;Python&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;Guido Van Rossum&amp;lt;/td&amp;gt; &lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;1989&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;Ruby&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;Yukihiro Matsumoto&amp;lt;/td&amp;gt; &lt;/span&gt;
&lt;span class="s2"&gt;      &amp;lt;td&amp;gt;1995&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;/tbody&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;&amp;lt;/table&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;"""&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can render the table using IPython &lt;a href="http://ipython.readthedocs.io/en/stable/api/generated/IPython.display.html#IPython.display.display_html"&gt;display_html&lt;/a&gt; function:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;IPython.display&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;display_html&lt;/span&gt;
&lt;span class="n"&gt;display_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html_string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;raw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea "&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Programming Language&lt;/th&gt;
      &lt;th&gt;Creator&lt;/th&gt; 
      &lt;th&gt;Year&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;Dennis Ritchie&lt;/td&gt; 
      &lt;td&gt;1972&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Python&lt;/td&gt;
      &lt;td&gt;Guido Van Rossum&lt;/td&gt; 
      &lt;td&gt;1989&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Ruby&lt;/td&gt;
      &lt;td&gt;Yukihiro Matsumoto&lt;/td&gt; 
      &lt;td&gt;1995&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's import this HTML table in a DataFrame. Note that the function &lt;code&gt;read_html&lt;/code&gt; always returns a list of DataFrame objects:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html_string&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;dfs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[7]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[  Programming Language             Creator  Year
 0                    C      Dennis Ritchie  1972
 1               Python    Guido Van Rossum  1989
 2                 Ruby  Yukihiro Matsumoto  1995]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[8]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Programming Language&lt;/th&gt;
      &lt;th&gt;Creator&lt;/th&gt;
      &lt;th&gt;Year&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;Dennis Ritchie&lt;/td&gt;
      &lt;td&gt;1972&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Python&lt;/td&gt;
      &lt;td&gt;Guido Van Rossum&lt;/td&gt;
      &lt;td&gt;1989&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Ruby&lt;/td&gt;
      &lt;td&gt;Yukihiro Matsumoto&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This looks quite similar to the raw string we rendered above, but we are printing a pandas DataFrame object here! We can apply any operation we want.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Year&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;1975&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Programming Language&lt;/th&gt;
      &lt;th&gt;Creator&lt;/th&gt;
      &lt;th&gt;Year&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Python&lt;/td&gt;
      &lt;td&gt;Guido Van Rossum&lt;/td&gt;
      &lt;td&gt;1989&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Ruby&lt;/td&gt;
      &lt;td&gt;Yukihiro Matsumoto&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Pandas automatically found the header to use thanks to the &lt;code&gt;&amp;lt;thead&amp;gt;&lt;/code&gt; tag. It is not mandatory to define a table and is actually often missing on the web. So what happens if it's not present?&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;html_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;"""&lt;/span&gt;
&lt;span class="s2"&gt;&amp;lt;table&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;th&amp;gt;Programming Language&amp;lt;/th&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;th&amp;gt;Creator&amp;lt;/th&amp;gt; &lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;th&amp;gt;Year&amp;lt;/th&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;C&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;Dennis Ritchie&amp;lt;/td&amp;gt; &lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;1972&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;Python&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;Guido Van Rossum&amp;lt;/td&amp;gt; &lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;1989&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;Ruby&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;Yukihiro Matsumoto&amp;lt;/td&amp;gt; &lt;/span&gt;
&lt;span class="s2"&gt;    &amp;lt;td&amp;gt;1995&amp;lt;/td&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;  &amp;lt;/tr&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;&amp;lt;/table&amp;gt;&lt;/span&gt;
&lt;span class="s2"&gt;"""&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html_string&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[11]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;th&gt;2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Programming Language&lt;/td&gt;
      &lt;td&gt;Creator&lt;/td&gt;
      &lt;td&gt;Year&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;Dennis Ritchie&lt;/td&gt;
      &lt;td&gt;1972&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Python&lt;/td&gt;
      &lt;td&gt;Guido Van Rossum&lt;/td&gt;
      &lt;td&gt;1989&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Ruby&lt;/td&gt;
      &lt;td&gt;Yukihiro Matsumoto&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In this case, we need to pass the row number to use as header.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;html_string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[12]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Programming Language&lt;/th&gt;
      &lt;th&gt;Creator&lt;/th&gt;
      &lt;th&gt;Year&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;Dennis Ritchie&lt;/td&gt;
      &lt;td&gt;1972&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;Python&lt;/td&gt;
      &lt;td&gt;Guido Van Rossum&lt;/td&gt;
      &lt;td&gt;1989&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;Ruby&lt;/td&gt;
      &lt;td&gt;Yukihiro Matsumoto&lt;/td&gt;
      &lt;td&gt;1995&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Parsing-a-http-URL"&gt;Parsing a http URL&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/#Parsing-a-http-URL"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The same data we read in our excel file is available in a table at the following address: &lt;a href="http://www.contextures.com/xlSampleData01.html"&gt;http://www.contextures.com/xlSampleData01.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Let's pass this url to &lt;code&gt;read_html&lt;/code&gt;:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://www.contextures.com/xlSampleData01.html'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[14]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;[             0        1         2        3      4         5        6
 0    OrderDate   Region       Rep     Item  Units  UnitCost    Total
 1     1/6/2016     East     Jones   Pencil     95      1.99   189.05
 2    1/23/2016  Central    Kivell   Binder     50     19.99   999.50
 3     2/9/2016  Central   Jardine   Pencil     36      4.99   179.64
 4    2/26/2016  Central      Gill      Pen     27     19.99   539.73
 5    3/15/2016     West   Sorvino   Pencil     56      2.99   167.44
 6     4/1/2016     East     Jones   Binder     60      4.99   299.40
 7    4/18/2016  Central   Andrews   Pencil     75      1.99   149.25
 8     5/5/2016  Central   Jardine   Pencil     90      4.99   449.10
 9    5/22/2016     West  Thompson   Pencil     32      1.99    63.68
 10    6/8/2016     East     Jones   Binder     60      8.99   539.40
 11   6/25/2016  Central    Morgan   Pencil     90      4.99   449.10
 12   7/12/2016     East    Howard   Binder     29      1.99    57.71
 13   7/29/2016     East    Parent   Binder     81     19.99  1619.19
 14   8/15/2016     East     Jones   Pencil     35      4.99   174.65
 15    9/1/2016  Central     Smith     Desk      2    125.00   250.00
 16   9/18/2016     East     Jones  Pen Set     16     15.99   255.84
 17   10/5/2016  Central    Morgan   Binder     28      8.99   251.72
 18  10/22/2016     East     Jones      Pen     64      8.99   575.36
 19   11/8/2016     East    Parent      Pen     15     19.99   299.85
 20  11/25/2016  Central    Kivell  Pen Set     96      4.99   479.04
 21  12/12/2016  Central     Smith   Pencil     67      1.29    86.43
 22  12/29/2016     East    Parent  Pen Set     74     15.99  1183.26
 23   1/15/2017  Central      Gill   Binder     46      8.99   413.54
 24    2/1/2017  Central     Smith   Binder     87     15.00  1305.00
 25   2/18/2017     East     Jones   Binder      4      4.99    19.96
 26    3/7/2017     West   Sorvino   Binder      7     19.99   139.93
 27   3/24/2017  Central   Jardine  Pen Set     50      4.99   249.50
 28   4/10/2017  Central   Andrews   Pencil     66      1.99   131.34
 29   4/27/2017     East    Howard      Pen     96      4.99   479.04
 30   5/14/2017  Central      Gill   Pencil     53      1.29    68.37
 31   5/31/2017  Central      Gill   Binder     80      8.99   719.20
 32   6/17/2017  Central    Kivell     Desk      5    125.00   625.00
 33    7/4/2017     East     Jones  Pen Set     62      4.99   309.38
 34   7/21/2017  Central    Morgan  Pen Set     55     12.49   686.95
 35    8/7/2017  Central    Kivell  Pen Set     42     23.95  1005.90
 36   8/24/2017     West   Sorvino     Desk      3    275.00   825.00
 37   9/10/2017  Central      Gill   Pencil      7      1.29     9.03
 38   9/27/2017     West   Sorvino      Pen     76      1.99   151.24
 39  10/14/2017     West  Thompson   Binder     57     19.99  1139.43
 40  10/31/2017  Central   Andrews   Pencil     14      1.29    18.06
 41  11/17/2017  Central   Jardine   Binder     11      4.99    54.89
 42   12/4/2017  Central   Jardine   Binder     94     19.99  1879.06
 43  12/21/2017  Central   Andrews   Binder     28      4.99   139.72]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We have one table and can see that we need to pass the row number to use as header (because &lt;code&gt;&amp;lt;thead&amp;gt;&lt;/code&gt; is not present).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://www.contextures.com/xlSampleData01.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;head&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[15]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;OrderDate&lt;/th&gt;
      &lt;th&gt;Region&lt;/th&gt;
      &lt;th&gt;Rep&lt;/th&gt;
      &lt;th&gt;Item&lt;/th&gt;
      &lt;th&gt;Units&lt;/th&gt;
      &lt;th&gt;UnitCost&lt;/th&gt;
      &lt;th&gt;Total&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1/6/2016&lt;/td&gt;
      &lt;td&gt;East&lt;/td&gt;
      &lt;td&gt;Jones&lt;/td&gt;
      &lt;td&gt;Pencil&lt;/td&gt;
      &lt;td&gt;95&lt;/td&gt;
      &lt;td&gt;1.99&lt;/td&gt;
      &lt;td&gt;189.05&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1/23/2016&lt;/td&gt;
      &lt;td&gt;Central&lt;/td&gt;
      &lt;td&gt;Kivell&lt;/td&gt;
      &lt;td&gt;Binder&lt;/td&gt;
      &lt;td&gt;50&lt;/td&gt;
      &lt;td&gt;19.99&lt;/td&gt;
      &lt;td&gt;999.50&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2/9/2016&lt;/td&gt;
      &lt;td&gt;Central&lt;/td&gt;
      &lt;td&gt;Jardine&lt;/td&gt;
      &lt;td&gt;Pencil&lt;/td&gt;
      &lt;td&gt;36&lt;/td&gt;
      &lt;td&gt;4.99&lt;/td&gt;
      &lt;td&gt;179.64&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2/26/2016&lt;/td&gt;
      &lt;td&gt;Central&lt;/td&gt;
      &lt;td&gt;Gill&lt;/td&gt;
      &lt;td&gt;Pen&lt;/td&gt;
      &lt;td&gt;27&lt;/td&gt;
      &lt;td&gt;19.99&lt;/td&gt;
      &lt;td&gt;539.73&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;3/15/2016&lt;/td&gt;
      &lt;td&gt;West&lt;/td&gt;
      &lt;td&gt;Sorvino&lt;/td&gt;
      &lt;td&gt;Pencil&lt;/td&gt;
      &lt;td&gt;56&lt;/td&gt;
      &lt;td&gt;2.99&lt;/td&gt;
      &lt;td&gt;167.44&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Nice!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Parsing-a-https-URL"&gt;Parsing a https URL&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/#Parsing-a-https-URL"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The documentation states that:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Note that lxml only accepts the http, ftp and file url protocols. If you have a URL that starts with 'https' you might try removing the 's'.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is true, but &lt;em&gt;bs4 + html5lib&lt;/em&gt; are used as a fallback when &lt;em&gt;lxml&lt;/em&gt; fails. I guess this is why passing a &lt;code&gt;https&lt;/code&gt; url does work. We can confirm that with a wikipedia page.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'https://en.wikipedia.org/wiki/Python_(programming_language)'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[16]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Type&lt;/th&gt;
      &lt;th&gt;mutable&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
      &lt;th&gt;Syntax example&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;bool&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Boolean value&lt;/td&gt;
      &lt;td&gt;True False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;bytearray&lt;/td&gt;
      &lt;td&gt;mutable&lt;/td&gt;
      &lt;td&gt;Sequence of bytes&lt;/td&gt;
      &lt;td&gt;bytearray(b'Some ASCII') bytearray(b"Some ASCI...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;bytes&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Sequence of bytes&lt;/td&gt;
      &lt;td&gt;b'Some ASCII' b"Some ASCII" bytes([119, 105, 1...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;complex&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Complex number with real and imaginary parts&lt;/td&gt;
      &lt;td&gt;3+2.7j&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;dict&lt;/td&gt;
      &lt;td&gt;mutable&lt;/td&gt;
      &lt;td&gt;Associative array (or dictionary) of key and v...&lt;/td&gt;
      &lt;td&gt;{'key1': 1.0, 3: False}&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;ellipsis&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;An ellipsis placeholder to be used as an index...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;float&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Floating point number, system-defined precision&lt;/td&gt;
      &lt;td&gt;3.1415927&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;frozenset&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Unordered set, contains no duplicates; can con...&lt;/td&gt;
      &lt;td&gt;frozenset([4.0, 'string', True])&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;int&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Integer of unlimited magnitude[76]&lt;/td&gt;
      &lt;td&gt;42&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;list&lt;/td&gt;
      &lt;td&gt;mutable&lt;/td&gt;
      &lt;td&gt;List, can contain mixed types&lt;/td&gt;
      &lt;td&gt;[4.0, 'string', True]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;set&lt;/td&gt;
      &lt;td&gt;mutable&lt;/td&gt;
      &lt;td&gt;Unordered set, contains no duplicates; can con...&lt;/td&gt;
      &lt;td&gt;{4.0, 'string', True}&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;str&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;A character string: sequence of Unicode codepo...&lt;/td&gt;
      &lt;td&gt;'Wikipedia' "Wikipedia" """Spanning multiple l...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;tuple&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Can contain mixed types&lt;/td&gt;
      &lt;td&gt;(4.0, 'string', True)But we can append element...&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;But what if the url requires authentiation?&lt;/p&gt;
&lt;p&gt;In that case we can use &lt;a href="http://docs.python-requests.org/en/master/"&gt;requests&lt;/a&gt; to get the HTML and pass the string to pandas!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;To demonstrate authentication, we can use &lt;a href="http://httpbin.org"&gt;http://httpbin.org&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We can first confirm that passing a url that requires authentication raises a 401&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'https://httpbin.org/basic-auth/myuser/mypasswd'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_text output_error"&gt;
&lt;pre&gt;
&lt;span class="ansi-red-fg"&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class="ansi-red-fg"&gt;HTTPError&lt;/span&gt;                                 Traceback (most recent call last)
&lt;span class="ansi-green-fg"&gt;&amp;lt;ipython-input-17-7e6b50c9f1f3&amp;gt;&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;()&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;----&amp;gt; 1&lt;/span&gt;&lt;span class="ansi-red-fg"&gt; &lt;/span&gt;pd&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;read_html&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;'https://httpbin.org/basic-auth/myuser/mypasswd'&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;

&lt;span class="ansi-green-fg"&gt;~/miniconda3/envs/jupyter/lib/python3.6/site-packages/pandas/io/html.py&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;read_html&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;(io, match, flavor, header, index_col, skiprows, attrs, parse_dates, tupleize_cols, thousands, encoding, decimal, converters, na_values, keep_default_na)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    913&lt;/span&gt;                   thousands&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;thousands&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; attrs&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;attrs&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; encoding&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;encoding&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    914&lt;/span&gt;                   decimal&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;decimal&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; converters&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;converters&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; na_values&lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt;na_values&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;--&amp;gt; 915&lt;/span&gt;&lt;span class="ansi-red-fg"&gt;                   keep_default_na=keep_default_na)
&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;~/miniconda3/envs/jupyter/lib/python3.6/site-packages/pandas/io/html.py&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;_parse&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;(flavor, io, match, attrs, encoding, **kwargs)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    747&lt;/span&gt;             &lt;span class="ansi-green-fg"&gt;break&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    748&lt;/span&gt;     &lt;span class="ansi-green-fg"&gt;else&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;:&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;--&amp;gt; 749&lt;/span&gt;&lt;span class="ansi-red-fg"&gt;         &lt;/span&gt;raise_with_traceback&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;retained&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    750&lt;/span&gt; 
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    751&lt;/span&gt;     ret &lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt; &lt;span class="ansi-blue-fg"&gt;[&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;]&lt;/span&gt;

&lt;span class="ansi-green-fg"&gt;~/miniconda3/envs/jupyter/lib/python3.6/site-packages/pandas/compat/__init__.py&lt;/span&gt; in &lt;span class="ansi-cyan-fg"&gt;raise_with_traceback&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;(exc, traceback)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    383&lt;/span&gt;         &lt;span class="ansi-green-fg"&gt;if&lt;/span&gt; traceback &lt;span class="ansi-blue-fg"&gt;==&lt;/span&gt; Ellipsis&lt;span class="ansi-blue-fg"&gt;:&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    384&lt;/span&gt;             _&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; _&lt;span class="ansi-blue-fg"&gt;,&lt;/span&gt; traceback &lt;span class="ansi-blue-fg"&gt;=&lt;/span&gt; sys&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;exc_info&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-fg"&gt;--&amp;gt; 385&lt;/span&gt;&lt;span class="ansi-red-fg"&gt;         &lt;/span&gt;&lt;span class="ansi-green-fg"&gt;raise&lt;/span&gt; exc&lt;span class="ansi-blue-fg"&gt;.&lt;/span&gt;with_traceback&lt;span class="ansi-blue-fg"&gt;(&lt;/span&gt;traceback&lt;span class="ansi-blue-fg"&gt;)&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    386&lt;/span&gt; &lt;span class="ansi-green-fg"&gt;else&lt;/span&gt;&lt;span class="ansi-blue-fg"&gt;:&lt;/span&gt;
&lt;span class="ansi-green-intense-fg ansi-bold"&gt;    387&lt;/span&gt;     &lt;span class="ansi-red-fg"&gt;# this version of raise is a syntax error in Python 3&lt;/span&gt;

&lt;span class="ansi-red-fg"&gt;HTTPError&lt;/span&gt;: HTTP Error 401: UNAUTHORIZED&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'https://httpbin.org/basic-auth/myuser/mypasswd'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status_code&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Yes, as expected. Let's pass the username and password with requests.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'https://httpbin.org/basic-auth/myuser/mypasswd'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;auth&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'myuser'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'mypasswd'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status_code&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We could now pass &lt;code&gt;r.text&lt;/code&gt; to pandas. &lt;a href="http://httpbin.org"&gt;http://httpbin.org&lt;/a&gt; was used to demonstrate authentication but it only returns JSON-encoded responses and no HTML. It's a testing service. So it doesn't make sense here.&lt;/p&gt;
&lt;p&gt;The following example shows how to combine requests and pandas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [18]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'https://en.wikipedia.org/wiki/Python_(programming_language)'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[18]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Type&lt;/th&gt;
      &lt;th&gt;mutable&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
      &lt;th&gt;Syntax example&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;bool&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Boolean value&lt;/td&gt;
      &lt;td&gt;True False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;bytearray&lt;/td&gt;
      &lt;td&gt;mutable&lt;/td&gt;
      &lt;td&gt;Sequence of bytes&lt;/td&gt;
      &lt;td&gt;bytearray(b'Some ASCII') bytearray(b"Some ASCI...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;bytes&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Sequence of bytes&lt;/td&gt;
      &lt;td&gt;b'Some ASCII' b"Some ASCII" bytes([119, 105, 1...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;complex&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Complex number with real and imaginary parts&lt;/td&gt;
      &lt;td&gt;3+2.7j&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;dict&lt;/td&gt;
      &lt;td&gt;mutable&lt;/td&gt;
      &lt;td&gt;Associative array (or dictionary) of key and v...&lt;/td&gt;
      &lt;td&gt;{'key1': 1.0, 3: False}&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;ellipsis&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;An ellipsis placeholder to be used as an index...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;float&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Floating point number, system-defined precision&lt;/td&gt;
      &lt;td&gt;3.1415927&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;frozenset&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Unordered set, contains no duplicates; can con...&lt;/td&gt;
      &lt;td&gt;frozenset([4.0, 'string', True])&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;int&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Integer of unlimited magnitude[76]&lt;/td&gt;
      &lt;td&gt;42&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;list&lt;/td&gt;
      &lt;td&gt;mutable&lt;/td&gt;
      &lt;td&gt;List, can contain mixed types&lt;/td&gt;
      &lt;td&gt;[4.0, 'string', True]&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;set&lt;/td&gt;
      &lt;td&gt;mutable&lt;/td&gt;
      &lt;td&gt;Unordered set, contains no duplicates; can con...&lt;/td&gt;
      &lt;td&gt;{4.0, 'string', True}&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;str&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;A character string: sequence of Unicode codepo...&lt;/td&gt;
      &lt;td&gt;'Wikipedia' "Wikipedia" """Spanning multiple l...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;tuple&lt;/td&gt;
      &lt;td&gt;immutable&lt;/td&gt;
      &lt;td&gt;Can contain mixed types&lt;/td&gt;
      &lt;td&gt;(4.0, 'string', True)But we can append element...&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="A-more-complex-example"&gt;A more complex example&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/#A-more-complex-example"&gt;¶&lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We looked at some quite simple examples so far. So let's try a page with several tables: &lt;a href="https://en.wikipedia.org/wiki/Timeline_of_programming_languages"&gt;https://en.wikipedia.org/wiki/Timeline_of_programming_languages&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'https://en.wikipedia.org/wiki/Timeline_of_programming_languages'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[20]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;13&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;If we look at the page we have 8 tables (one per decade). Looking at our &lt;code&gt;dfs&lt;/code&gt; list, we can see that the first interesting table is the fifth one and that we need to pass the row to use as header.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [21]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'https://en.wikipedia.org/wiki/Timeline_of_programming_languages'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[21]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Year&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Chief developer, company&lt;/th&gt;
      &lt;th&gt;Predecessor(s)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1943–45&lt;/td&gt;
      &lt;td&gt;Plankalkül (concept)&lt;/td&gt;
      &lt;td&gt;Konrad Zuse&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1943–46&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
      &lt;td&gt;John von Neumann, John Mauchly, J. Presper Eck...&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;1946&lt;/td&gt;
      &lt;td&gt;ENIAC Short Code&lt;/td&gt;
      &lt;td&gt;Richard Clippinger, John von Neumann after Ala...&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;1946&lt;/td&gt;
      &lt;td&gt;Von Neumann and Goldstine graphing system (Not...&lt;/td&gt;
      &lt;td&gt;John von Neumann and Herman Goldstine&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;1947&lt;/td&gt;
      &lt;td&gt;ARC Assembly&lt;/td&gt;
      &lt;td&gt;Kathleen Booth[1][2]&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;CPC Coding scheme&lt;/td&gt;
      &lt;td&gt;Howard H. Aiken&lt;/td&gt;
      &lt;td&gt;Analytical Engine order code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;Curry notation system&lt;/td&gt;
      &lt;td&gt;Haskell Curry&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;Plankalkül (concept published)&lt;/td&gt;
      &lt;td&gt;Konrad Zuse&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;1949&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
      &lt;td&gt;John Mauchly and William F. Schmitt&lt;/td&gt;
      &lt;td&gt;ENIAC Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;Year&lt;/td&gt;
      &lt;td&gt;Name&lt;/td&gt;
      &lt;td&gt;Chief developer, company&lt;/td&gt;
      &lt;td&gt;Predecessor(s)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Notice that the header was repeated in the last row (to make the table easier to read on the HTML page). We can filter that after concatenating together the 8 tables to get one DataFrame.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [22]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[22]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Year&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Chief developer, company&lt;/th&gt;
      &lt;th&gt;Predecessor(s)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1943–45&lt;/td&gt;
      &lt;td&gt;Plankalkül (concept)&lt;/td&gt;
      &lt;td&gt;Konrad Zuse&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1943–46&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
      &lt;td&gt;John von Neumann, John Mauchly, J. Presper Eck...&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;1946&lt;/td&gt;
      &lt;td&gt;ENIAC Short Code&lt;/td&gt;
      &lt;td&gt;Richard Clippinger, John von Neumann after Ala...&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;1946&lt;/td&gt;
      &lt;td&gt;Von Neumann and Goldstine graphing system (Not...&lt;/td&gt;
      &lt;td&gt;John von Neumann and Herman Goldstine&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;1947&lt;/td&gt;
      &lt;td&gt;ARC Assembly&lt;/td&gt;
      &lt;td&gt;Kathleen Booth[1][2]&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;CPC Coding scheme&lt;/td&gt;
      &lt;td&gt;Howard H. Aiken&lt;/td&gt;
      &lt;td&gt;Analytical Engine order code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;Curry notation system&lt;/td&gt;
      &lt;td&gt;Haskell Curry&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;Plankalkül (concept published)&lt;/td&gt;
      &lt;td&gt;Konrad Zuse&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;1949&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
      &lt;td&gt;John Mauchly and William F. Schmitt&lt;/td&gt;
      &lt;td&gt;ENIAC Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;Year&lt;/td&gt;
      &lt;td&gt;Name&lt;/td&gt;
      &lt;td&gt;Chief developer, company&lt;/td&gt;
      &lt;td&gt;Predecessor(s)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1950&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
      &lt;td&gt;William F Schmidt, Albert B. Tonik,[3] J.R. Logan&lt;/td&gt;
      &lt;td&gt;Brief Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1950&lt;/td&gt;
      &lt;td&gt;Birkbeck Assembler&lt;/td&gt;
      &lt;td&gt;Kathleen Booth&lt;/td&gt;
      &lt;td&gt;ARC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Superplan&lt;/td&gt;
      &lt;td&gt;Heinz Rutishauser&lt;/td&gt;
      &lt;td&gt;Plankalkül&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;ALGAE&lt;/td&gt;
      &lt;td&gt;Edward A Voorhees and Karl Balke&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Intermediate Programming Language&lt;/td&gt;
      &lt;td&gt;Arthur Burks&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Regional Assembly Language&lt;/td&gt;
      &lt;td&gt;Maurice Wilkes&lt;/td&gt;
      &lt;td&gt;EDSAC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Boehm unnamed coding system&lt;/td&gt;
      &lt;td&gt;Corrado Böhm&lt;/td&gt;
      &lt;td&gt;CPC Coding scheme&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Klammerausdrücke&lt;/td&gt;
      &lt;td&gt;Konrad Zuse&lt;/td&gt;
      &lt;td&gt;Plankalkül&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;OMNIBAC Symbolic Assembler&lt;/td&gt;
      &lt;td&gt;Charles Katz&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Stanislaus (Notation)&lt;/td&gt;
      &lt;td&gt;Fritz Bauer&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Whirlwind assembler&lt;/td&gt;
      &lt;td&gt;Charles Adams and Jack Gilmore at MIT Project ...&lt;/td&gt;
      &lt;td&gt;EDSAC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Rochester assembler&lt;/td&gt;
      &lt;td&gt;Nat Rochester&lt;/td&gt;
      &lt;td&gt;EDSAC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Sort Merge Generator&lt;/td&gt;
      &lt;td&gt;Betty Holberton&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;1952&lt;/td&gt;
      &lt;td&gt;A-0&lt;/td&gt;
      &lt;td&gt;Grace Hopper&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;1952&lt;/td&gt;
      &lt;td&gt;Glennie Autocode&lt;/td&gt;
      &lt;td&gt;Alick Glennie after Alan Turing&lt;/td&gt;
      &lt;td&gt;CPC Coding scheme&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;1952&lt;/td&gt;
      &lt;td&gt;Editing Generator&lt;/td&gt;
      &lt;td&gt;Milly Koss&lt;/td&gt;
      &lt;td&gt;SORT/MERGE&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;1952&lt;/td&gt;
      &lt;td&gt;COMPOOL&lt;/td&gt;
      &lt;td&gt;RAND/SDC&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;1953&lt;/td&gt;
      &lt;td&gt;Speedcoding&lt;/td&gt;
      &lt;td&gt;John W. Backus&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;1953&lt;/td&gt;
      &lt;td&gt;READ/PRINT&lt;/td&gt;
      &lt;td&gt;Don Harroff, James Fishman, George Ryckman&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;1954&lt;/td&gt;
      &lt;td&gt;Laning and Zierler system&lt;/td&gt;
      &lt;td&gt;Laning, Zierler, Adams at MIT Project Whirlwind&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;47&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Chapel&lt;/td&gt;
      &lt;td&gt;Brad Chamberlain, Cray Inc.&lt;/td&gt;
      &lt;td&gt;HPF, ZPL&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;48&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Go&lt;/td&gt;
      &lt;td&gt;Google&lt;/td&gt;
      &lt;td&gt;C, Oberon, Limbo, Smalltalk&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;49&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;CoffeeScript&lt;/td&gt;
      &lt;td&gt;Jeremy Ashkenas&lt;/td&gt;
      &lt;td&gt;JavaScript, Ruby, Python, Haskell&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Idris&lt;/td&gt;
      &lt;td&gt;Edwin Brady&lt;/td&gt;
      &lt;td&gt;Haskell, Agda, Coq&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;51&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Parasail&lt;/td&gt;
      &lt;td&gt;S. Tucker Taft, AdaCore&lt;/td&gt;
      &lt;td&gt;Modula, Ada, Pascal, ML&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;52&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Whiley&lt;/td&gt;
      &lt;td&gt;David J. Pearce&lt;/td&gt;
      &lt;td&gt;Java, C, Python&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;53&lt;/th&gt;
      &lt;td&gt;Year&lt;/td&gt;
      &lt;td&gt;Name&lt;/td&gt;
      &lt;td&gt;Chief developer, company&lt;/td&gt;
      &lt;td&gt;Predecessor(s)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2010&lt;/td&gt;
      &lt;td&gt;Rust&lt;/td&gt;
      &lt;td&gt;Graydon Hoare, Mozilla&lt;/td&gt;
      &lt;td&gt;Alef, C++, Camlp4, Erlang, Hermes, Limbo, Napi...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Ceylon&lt;/td&gt;
      &lt;td&gt;Gavin King, Red Hat&lt;/td&gt;
      &lt;td&gt;Java&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Dart&lt;/td&gt;
      &lt;td&gt;Google&lt;/td&gt;
      &lt;td&gt;Java, JavaScript, CoffeeScript, Go&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;C++11&lt;/td&gt;
      &lt;td&gt;C++ ISO/IEC 14882:2011&lt;/td&gt;
      &lt;td&gt;C++, Standard C, C&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Kotlin&lt;/td&gt;
      &lt;td&gt;JetBrains&lt;/td&gt;
      &lt;td&gt;Java, Scala, Groovy, C#, Gosu&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Red&lt;/td&gt;
      &lt;td&gt;Nenad Rakocevic&lt;/td&gt;
      &lt;td&gt;Rebol, Scala, Lua&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Opa&lt;/td&gt;
      &lt;td&gt;MLstate&lt;/td&gt;
      &lt;td&gt;OCaml, Erlang, JavaScript&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;Elixir&lt;/td&gt;
      &lt;td&gt;José Valim&lt;/td&gt;
      &lt;td&gt;Erlang, Ruby, Clojure&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;Elm&lt;/td&gt;
      &lt;td&gt;Evan Czaplicki&lt;/td&gt;
      &lt;td&gt;Haskell, Standard ML, OCaml, F#&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;TypeScript&lt;/td&gt;
      &lt;td&gt;Anders Hejlsberg, Microsoft&lt;/td&gt;
      &lt;td&gt;JavaScript, CoffeeScript&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;Julia&lt;/td&gt;
      &lt;td&gt;Jeff Bezanson, Stefan Karpinski, Viral Shah, A...&lt;/td&gt;
      &lt;td&gt;MATLAB, Lisp, C, Fortran, Mathematica[9] (stri...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;P&lt;/td&gt;
      &lt;td&gt;Vivek Gupta: not the politician, Ethan Jackson...&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;Ada 2012&lt;/td&gt;
      &lt;td&gt;ARA and Ada Europe (ISO/IEC 8652:2012)&lt;/td&gt;
      &lt;td&gt;Ada 2005, ISO/IEC 8652:1995/Amd 1:2007&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;2014&lt;/td&gt;
      &lt;td&gt;Crystal&lt;/td&gt;
      &lt;td&gt;Ary Borenszweig, Manas Technology Solutions&lt;/td&gt;
      &lt;td&gt;Ruby, C, Rust, Go, C#, Python&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;2014&lt;/td&gt;
      &lt;td&gt;Hack&lt;/td&gt;
      &lt;td&gt;Facebook&lt;/td&gt;
      &lt;td&gt;PHP&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;2014&lt;/td&gt;
      &lt;td&gt;Swift&lt;/td&gt;
      &lt;td&gt;Apple Inc.&lt;/td&gt;
      &lt;td&gt;Objective-C, Rust, Haskell, Ruby, Python, C#, CLU&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;2014&lt;/td&gt;
      &lt;td&gt;C++14&lt;/td&gt;
      &lt;td&gt;C++ ISO/IEC 14882:2014&lt;/td&gt;
      &lt;td&gt;C++, Standard C, C&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;2015&lt;/td&gt;
      &lt;td&gt;Atari 2600 SuperCharger BASIC&lt;/td&gt;
      &lt;td&gt;Microsoft sponsored think tank RelationalFrame...&lt;/td&gt;
      &lt;td&gt;BASIC, Dartmouth BASIC (compiled programming l...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;2015&lt;/td&gt;
      &lt;td&gt;Perl 6&lt;/td&gt;
      &lt;td&gt;The Rakudo Team&lt;/td&gt;
      &lt;td&gt;Perl, Haskell, Python, Ruby&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;2016&lt;/td&gt;
      &lt;td&gt;Ring&lt;/td&gt;
      &lt;td&gt;Mahmoud Fayed&lt;/td&gt;
      &lt;td&gt;Lua, Python, Ruby, C, C#, BASIC, QML, xBase, S...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;2017&lt;/td&gt;
      &lt;td&gt;C++17&lt;/td&gt;
      &lt;td&gt;C++ ISO/IEC 14882:2017&lt;/td&gt;
      &lt;td&gt;C++, Standard C, C&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;2017&lt;/td&gt;
      &lt;td&gt;Atari 2600 Flashback BASIC&lt;/td&gt;
      &lt;td&gt;Microsoft sponsored think tank RelationalFrame...&lt;/td&gt;
      &lt;td&gt;BASIC, Dartmouth BASIC (compiled programming l...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22&lt;/th&gt;
      &lt;td&gt;Year&lt;/td&gt;
      &lt;td&gt;Name&lt;/td&gt;
      &lt;td&gt;Chief developer, company&lt;/td&gt;
      &lt;td&gt;Predecessor(s)&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;388 rows × 4 columns&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Remove the extra &lt;em&gt;header&lt;/em&gt; rows.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [23]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;prog_lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Year&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;'Year'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;prog_lang&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[23]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Year&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Chief developer, company&lt;/th&gt;
      &lt;th&gt;Predecessor(s)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1943–45&lt;/td&gt;
      &lt;td&gt;Plankalkül (concept)&lt;/td&gt;
      &lt;td&gt;Konrad Zuse&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1943–46&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
      &lt;td&gt;John von Neumann, John Mauchly, J. Presper Eck...&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;1946&lt;/td&gt;
      &lt;td&gt;ENIAC Short Code&lt;/td&gt;
      &lt;td&gt;Richard Clippinger, John von Neumann after Ala...&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;1946&lt;/td&gt;
      &lt;td&gt;Von Neumann and Goldstine graphing system (Not...&lt;/td&gt;
      &lt;td&gt;John von Neumann and Herman Goldstine&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;1947&lt;/td&gt;
      &lt;td&gt;ARC Assembly&lt;/td&gt;
      &lt;td&gt;Kathleen Booth[1][2]&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;CPC Coding scheme&lt;/td&gt;
      &lt;td&gt;Howard H. Aiken&lt;/td&gt;
      &lt;td&gt;Analytical Engine order code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;Curry notation system&lt;/td&gt;
      &lt;td&gt;Haskell Curry&lt;/td&gt;
      &lt;td&gt;ENIAC coding system&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;1948&lt;/td&gt;
      &lt;td&gt;Plankalkül (concept published)&lt;/td&gt;
      &lt;td&gt;Konrad Zuse&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;1949&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
      &lt;td&gt;John Mauchly and William F. Schmitt&lt;/td&gt;
      &lt;td&gt;ENIAC Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1950&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
      &lt;td&gt;William F Schmidt, Albert B. Tonik,[3] J.R. Logan&lt;/td&gt;
      &lt;td&gt;Brief Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1950&lt;/td&gt;
      &lt;td&gt;Birkbeck Assembler&lt;/td&gt;
      &lt;td&gt;Kathleen Booth&lt;/td&gt;
      &lt;td&gt;ARC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Superplan&lt;/td&gt;
      &lt;td&gt;Heinz Rutishauser&lt;/td&gt;
      &lt;td&gt;Plankalkül&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;ALGAE&lt;/td&gt;
      &lt;td&gt;Edward A Voorhees and Karl Balke&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Intermediate Programming Language&lt;/td&gt;
      &lt;td&gt;Arthur Burks&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Regional Assembly Language&lt;/td&gt;
      &lt;td&gt;Maurice Wilkes&lt;/td&gt;
      &lt;td&gt;EDSAC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Boehm unnamed coding system&lt;/td&gt;
      &lt;td&gt;Corrado Böhm&lt;/td&gt;
      &lt;td&gt;CPC Coding scheme&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Klammerausdrücke&lt;/td&gt;
      &lt;td&gt;Konrad Zuse&lt;/td&gt;
      &lt;td&gt;Plankalkül&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;OMNIBAC Symbolic Assembler&lt;/td&gt;
      &lt;td&gt;Charles Katz&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Stanislaus (Notation)&lt;/td&gt;
      &lt;td&gt;Fritz Bauer&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Whirlwind assembler&lt;/td&gt;
      &lt;td&gt;Charles Adams and Jack Gilmore at MIT Project ...&lt;/td&gt;
      &lt;td&gt;EDSAC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Rochester assembler&lt;/td&gt;
      &lt;td&gt;Nat Rochester&lt;/td&gt;
      &lt;td&gt;EDSAC&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;1951&lt;/td&gt;
      &lt;td&gt;Sort Merge Generator&lt;/td&gt;
      &lt;td&gt;Betty Holberton&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;1952&lt;/td&gt;
      &lt;td&gt;A-0&lt;/td&gt;
      &lt;td&gt;Grace Hopper&lt;/td&gt;
      &lt;td&gt;Short Code&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;1952&lt;/td&gt;
      &lt;td&gt;Glennie Autocode&lt;/td&gt;
      &lt;td&gt;Alick Glennie after Alan Turing&lt;/td&gt;
      &lt;td&gt;CPC Coding scheme&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;1952&lt;/td&gt;
      &lt;td&gt;Editing Generator&lt;/td&gt;
      &lt;td&gt;Milly Koss&lt;/td&gt;
      &lt;td&gt;SORT/MERGE&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;1952&lt;/td&gt;
      &lt;td&gt;COMPOOL&lt;/td&gt;
      &lt;td&gt;RAND/SDC&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;1953&lt;/td&gt;
      &lt;td&gt;Speedcoding&lt;/td&gt;
      &lt;td&gt;John W. Backus&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;1953&lt;/td&gt;
      &lt;td&gt;READ/PRINT&lt;/td&gt;
      &lt;td&gt;Don Harroff, James Fishman, George Ryckman&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;1954&lt;/td&gt;
      &lt;td&gt;Laning and Zierler system&lt;/td&gt;
      &lt;td&gt;Laning, Zierler, Adams at MIT Project Whirlwind&lt;/td&gt;
      &lt;td&gt;none (unique language)&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;1954&lt;/td&gt;
      &lt;td&gt;Mark I Autocode&lt;/td&gt;
      &lt;td&gt;Tony Brooker&lt;/td&gt;
      &lt;td&gt;Glennie Autocode&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;45&lt;/th&gt;
      &lt;td&gt;2008&lt;/td&gt;
      &lt;td&gt;Genie&lt;/td&gt;
      &lt;td&gt;Jamie McCracken&lt;/td&gt;
      &lt;td&gt;Python, Boo, D, Object Pascal&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;46&lt;/th&gt;
      &lt;td&gt;2008&lt;/td&gt;
      &lt;td&gt;Pure&lt;/td&gt;
      &lt;td&gt;Albert Gräf&lt;/td&gt;
      &lt;td&gt;Q&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;47&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Chapel&lt;/td&gt;
      &lt;td&gt;Brad Chamberlain, Cray Inc.&lt;/td&gt;
      &lt;td&gt;HPF, ZPL&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;48&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Go&lt;/td&gt;
      &lt;td&gt;Google&lt;/td&gt;
      &lt;td&gt;C, Oberon, Limbo, Smalltalk&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;49&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;CoffeeScript&lt;/td&gt;
      &lt;td&gt;Jeremy Ashkenas&lt;/td&gt;
      &lt;td&gt;JavaScript, Ruby, Python, Haskell&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Idris&lt;/td&gt;
      &lt;td&gt;Edwin Brady&lt;/td&gt;
      &lt;td&gt;Haskell, Agda, Coq&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;51&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Parasail&lt;/td&gt;
      &lt;td&gt;S. Tucker Taft, AdaCore&lt;/td&gt;
      &lt;td&gt;Modula, Ada, Pascal, ML&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;52&lt;/th&gt;
      &lt;td&gt;2009&lt;/td&gt;
      &lt;td&gt;Whiley&lt;/td&gt;
      &lt;td&gt;David J. Pearce&lt;/td&gt;
      &lt;td&gt;Java, C, Python&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2010&lt;/td&gt;
      &lt;td&gt;Rust&lt;/td&gt;
      &lt;td&gt;Graydon Hoare, Mozilla&lt;/td&gt;
      &lt;td&gt;Alef, C++, Camlp4, Erlang, Hermes, Limbo, Napi...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Ceylon&lt;/td&gt;
      &lt;td&gt;Gavin King, Red Hat&lt;/td&gt;
      &lt;td&gt;Java&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Dart&lt;/td&gt;
      &lt;td&gt;Google&lt;/td&gt;
      &lt;td&gt;Java, JavaScript, CoffeeScript, Go&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;C++11&lt;/td&gt;
      &lt;td&gt;C++ ISO/IEC 14882:2011&lt;/td&gt;
      &lt;td&gt;C++, Standard C, C&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Kotlin&lt;/td&gt;
      &lt;td&gt;JetBrains&lt;/td&gt;
      &lt;td&gt;Java, Scala, Groovy, C#, Gosu&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Red&lt;/td&gt;
      &lt;td&gt;Nenad Rakocevic&lt;/td&gt;
      &lt;td&gt;Rebol, Scala, Lua&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;2011&lt;/td&gt;
      &lt;td&gt;Opa&lt;/td&gt;
      &lt;td&gt;MLstate&lt;/td&gt;
      &lt;td&gt;OCaml, Erlang, JavaScript&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;Elixir&lt;/td&gt;
      &lt;td&gt;José Valim&lt;/td&gt;
      &lt;td&gt;Erlang, Ruby, Clojure&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;8&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;Elm&lt;/td&gt;
      &lt;td&gt;Evan Czaplicki&lt;/td&gt;
      &lt;td&gt;Haskell, Standard ML, OCaml, F#&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;TypeScript&lt;/td&gt;
      &lt;td&gt;Anders Hejlsberg, Microsoft&lt;/td&gt;
      &lt;td&gt;JavaScript, CoffeeScript&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;Julia&lt;/td&gt;
      &lt;td&gt;Jeff Bezanson, Stefan Karpinski, Viral Shah, A...&lt;/td&gt;
      &lt;td&gt;MATLAB, Lisp, C, Fortran, Mathematica[9] (stri...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;11&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;P&lt;/td&gt;
      &lt;td&gt;Vivek Gupta: not the politician, Ethan Jackson...&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;12&lt;/th&gt;
      &lt;td&gt;2012&lt;/td&gt;
      &lt;td&gt;Ada 2012&lt;/td&gt;
      &lt;td&gt;ARA and Ada Europe (ISO/IEC 8652:2012)&lt;/td&gt;
      &lt;td&gt;Ada 2005, ISO/IEC 8652:1995/Amd 1:2007&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;13&lt;/th&gt;
      &lt;td&gt;2014&lt;/td&gt;
      &lt;td&gt;Crystal&lt;/td&gt;
      &lt;td&gt;Ary Borenszweig, Manas Technology Solutions&lt;/td&gt;
      &lt;td&gt;Ruby, C, Rust, Go, C#, Python&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14&lt;/th&gt;
      &lt;td&gt;2014&lt;/td&gt;
      &lt;td&gt;Hack&lt;/td&gt;
      &lt;td&gt;Facebook&lt;/td&gt;
      &lt;td&gt;PHP&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;2014&lt;/td&gt;
      &lt;td&gt;Swift&lt;/td&gt;
      &lt;td&gt;Apple Inc.&lt;/td&gt;
      &lt;td&gt;Objective-C, Rust, Haskell, Ruby, Python, C#, CLU&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;2014&lt;/td&gt;
      &lt;td&gt;C++14&lt;/td&gt;
      &lt;td&gt;C++ ISO/IEC 14882:2014&lt;/td&gt;
      &lt;td&gt;C++, Standard C, C&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17&lt;/th&gt;
      &lt;td&gt;2015&lt;/td&gt;
      &lt;td&gt;Atari 2600 SuperCharger BASIC&lt;/td&gt;
      &lt;td&gt;Microsoft sponsored think tank RelationalFrame...&lt;/td&gt;
      &lt;td&gt;BASIC, Dartmouth BASIC (compiled programming l...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;18&lt;/th&gt;
      &lt;td&gt;2015&lt;/td&gt;
      &lt;td&gt;Perl 6&lt;/td&gt;
      &lt;td&gt;The Rakudo Team&lt;/td&gt;
      &lt;td&gt;Perl, Haskell, Python, Ruby&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19&lt;/th&gt;
      &lt;td&gt;2016&lt;/td&gt;
      &lt;td&gt;Ring&lt;/td&gt;
      &lt;td&gt;Mahmoud Fayed&lt;/td&gt;
      &lt;td&gt;Lua, Python, Ruby, C, C#, BASIC, QML, xBase, S...&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;20&lt;/th&gt;
      &lt;td&gt;2017&lt;/td&gt;
      &lt;td&gt;C++17&lt;/td&gt;
      &lt;td&gt;C++ ISO/IEC 14882:2017&lt;/td&gt;
      &lt;td&gt;C++, Standard C, C&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;21&lt;/th&gt;
      &lt;td&gt;2017&lt;/td&gt;
      &lt;td&gt;Atari 2600 Flashback BASIC&lt;/td&gt;
      &lt;td&gt;Microsoft sponsored think tank RelationalFrame...&lt;/td&gt;
      &lt;td&gt;BASIC, Dartmouth BASIC (compiled programming l...&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;380 rows × 4 columns&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In what year was Python created?&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [24]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;prog_lang&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;prog_lang&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;'Python'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[24]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border="1" class="dataframe"&gt;
  &lt;thead&gt;
    &lt;tr style="text-align: right;"&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Year&lt;/th&gt;
      &lt;th&gt;Name&lt;/th&gt;
      &lt;th&gt;Chief developer, company&lt;/th&gt;
      &lt;th&gt;Predecessor(s)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;9&lt;/th&gt;
      &lt;td&gt;1991&lt;/td&gt;
      &lt;td&gt;Python&lt;/td&gt;
      &lt;td&gt;Guido van Rossum&lt;/td&gt;
      &lt;td&gt;ABC, ALGOL 68, Icon, Modula-3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Conclusion"&gt;Conclusion&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/#Conclusion"&gt;¶&lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The last example should say it all.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [25]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pandas&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;pd&lt;/span&gt;

&lt;span class="n"&gt;dfs&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'https://en.wikipedia.org/wiki/Timeline_of_programming_languages'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;header&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;df&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;concat&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dfs&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;prog_lang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;df&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Year&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;'Year'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Four lines of code (including the &lt;code&gt;import&lt;/code&gt;) and we have one DataFrame containing the data from 8 different HTML tables on one wikipedia page!&lt;/p&gt;
&lt;p&gt;Do I need to say why I love Python and pandas? :-)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This post was written in a jupyter notebook.
You can find the notebook on &lt;a href="https://github.com/beenje/blog/blob/master/posts/parsing-html-tables-in-python-with-pandas.ipynb"&gt;GitHub&lt;/a&gt; and download the conda &lt;a href="http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/environment.yml"&gt;environment.yml&lt;/a&gt; file to get all the dependencies I used.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [ ]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt; 
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;&lt;/div&gt;</description><category>pandas</category><category>python</category><category>requests</category><guid>http://beenje.github.io/blog/posts/parsing-html-tables-in-python-with-pandas/</guid><pubDate>Tue, 27 Mar 2018 20:31:12 GMT</pubDate></item><item><title>Logging to a Tkinter ScrolledText Widget</title><link>http://beenje.github.io/blog/posts/logging-to-a-tkinter-scrolledtext-widget/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;p&gt;I've been programming in Python for almost 10 years.
I did many CLI tools, some web applications (mainly using &lt;a class="reference external" href="http://flask.pocoo.org"&gt;Flask&lt;/a&gt;),
but I had never built a GUI.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://riverbankcomputing.com/software/pyqt/intro"&gt;PyQt&lt;/a&gt; seems to be one of the most popular framework. I had a look at it but I was not hooked.
It looks like you really need to embrace the Qt world. You shouldn't try to use
&lt;a class="reference external" href="https://docs.python.org/3/library/threading.html#threading.Thread"&gt;Python Thread&lt;/a&gt; but use QtThread instead.
Need &lt;a class="reference external" href="http://pyserial.readthedocs.io/en/latest/"&gt;pySerial&lt;/a&gt;? Wait there is QtSerial. I guess this can be a pro or con
depending on your background.&lt;/p&gt;
&lt;p&gt;I looked more in &lt;a class="reference external" href="https://docs.python.org/3.6/library/tkinter.html"&gt;tkinter&lt;/a&gt;. I must say that in my mind it was a bit old and wasn't looking very modern.
I didn't know that &lt;a class="reference external" href="http://www.tkdocs.com"&gt;Tk 8.5&lt;/a&gt; came with an entirely new themed widget set to address the dated appearance.
The &lt;a class="reference external" href="http://www.tkdocs.com/tutorial/index.html"&gt;official tutorial&lt;/a&gt; is quite nice and comes with code examples in different languages (including Python).&lt;/p&gt;
&lt;p&gt;The GUI I needed to write wasn't very advanced.
I wanted to have a kind of console where to display log messages.&lt;/p&gt;
&lt;div class="section" id="texthandler"&gt;
&lt;h2&gt;TextHandler&lt;/h2&gt;
&lt;p&gt;I quickly found an &lt;a class="reference external" href="https://gist.github.com/moshekaplan/c425f861de7bbf28ef06"&gt;example&lt;/a&gt; on
&lt;a class="reference external" href="https://stackoverflow.com/questions/13318742/python-logging-to-tkinter-text-widget"&gt;StackOverflow&lt;/a&gt;
to send Python logging to a tkinter Text widget:&lt;/p&gt;
&lt;pre class="literal-block"&gt;class TextHandler(logging.Handler):
    """This class allows you to log to a Tkinter Text or ScrolledText widget"""

    def __init__(self, text):
        # run the regular Handler __init__
        logging.Handler.__init__(self)
        # Store a reference to the Text it will log to
        self.text = text

    def emit(self, record):
        msg = self.format(record)

        def append():
            self.text.configure(state='normal')
            self.text.insert(tk.END, msg + '\n')
            self.text.configure(state='disabled')
            # Autoscroll to the bottom
            self.text.yview(tk.END)
        # This is necessary because we can't modify the Text from other threads
        self.text.after(0, append)&lt;/pre&gt;
&lt;p&gt;This looks nice but doesn't work if you try to send a log message from another thread
(despite the comment)...
because we are passing the text widget with the logging handler to the other thread.
And you can only write to a tkinter widget from the main thread.&lt;/p&gt;
&lt;p&gt;This is explained in &lt;a class="reference external" href="https://stackoverflow.com/questions/43909849/tkinter-python-crashes-on-new-thread-trying-to-log-on-main-thread"&gt;another StackOverflow question&lt;/a&gt;
but I didn't like the proposed solution.
If you implement specific methods as explained (&lt;cite&gt;put_line_to_queue&lt;/cite&gt;), you lose the advantage of just calling the log function from different parts of the program.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="queuehandler"&gt;
&lt;h2&gt;QueueHandler&lt;/h2&gt;
&lt;p&gt;Using a &lt;a class="reference external" href="https://docs.python.org/3/library/queue.html"&gt;Queue&lt;/a&gt; is indeed the way to share data between threads.
So I implemented a simple QueueHandler:&lt;/p&gt;
&lt;pre class="literal-block"&gt;class QueueHandler(logging.Handler):
    """Class to send logging records to a queue

    It can be used from different threads
    """

    def __init__(self, log_queue):
        super().__init__()
        self.log_queue = log_queue

    def emit(self, record):
        self.log_queue.put(record)&lt;/pre&gt;
&lt;p&gt;The handler only puts the message in a queue.
I created a &lt;cite&gt;ConsoleUi&lt;/cite&gt; class to poll the messages from the queue and display them in a scrolled
text widget:&lt;/p&gt;
&lt;pre class="literal-block"&gt;logger = logging.getLogger(__name__)


class ConsoleUi:
    """Poll messages from a logging queue and display them in a scrolled text widget"""

    def __init__(self, frame):
        self.frame = frame
        # Create a ScrolledText wdiget
        self.scrolled_text = ScrolledText(frame, state='disabled', height=12)
        self.scrolled_text.grid(row=0, column=0, sticky=(N, S, W, E))
        self.scrolled_text.configure(font='TkFixedFont')
        self.scrolled_text.tag_config('INFO', foreground='black')
        self.scrolled_text.tag_config('DEBUG', foreground='gray')
        self.scrolled_text.tag_config('WARNING', foreground='orange')
        self.scrolled_text.tag_config('ERROR', foreground='red')
        self.scrolled_text.tag_config('CRITICAL', foreground='red', underline=1)
        # Create a logging handler using a queue
        self.log_queue = queue.Queue()
        self.queue_handler = QueueHandler(self.log_queue)
        formatter = logging.Formatter('%(asctime)s: %(message)s')
        self.queue_handler.setFormatter(formatter)
        logger.addHandler(self.queue_handler)
        # Start polling messages from the queue
        self.frame.after(100, self.poll_log_queue)

    def display(self, record):
        msg = self.queue_handler.format(record)
        self.scrolled_text.configure(state='normal')
        self.scrolled_text.insert(tk.END, msg + '\n', record.levelname)
        self.scrolled_text.configure(state='disabled')
        # Autoscroll to the bottom
        self.scrolled_text.yview(tk.END)

    def poll_log_queue(self):
        # Check every 100ms if there is a new message in the queue to display
        while True:
            try:
                record = self.log_queue.get(block=False)
            except queue.Empty:
                break
            else:
                self.display(record)
        self.frame.after(100, self.poll_log_queue)&lt;/pre&gt;
&lt;p&gt;I can safely use the logger from different threads because only a queue is passed with the handler, no tkinter widget.&lt;/p&gt;
&lt;p&gt;To demonstrate that, I created a separate thread to display the time every seconds:&lt;/p&gt;
&lt;pre class="literal-block"&gt;class Clock(threading.Thread):
    """Class to display the time every seconds

    Every 5 seconds, the time is displayed using the logging.ERROR level
    to show that different colors are associated to the log levels
    """

    def __init__(self):
        super().__init__()
        self._stop_event = threading.Event()

    def run(self):
        logger.debug('Clock started')
        previous = -1
        while not self._stop_event.is_set():
            now = datetime.datetime.now()
        while not self._stop_event.is_set():
            now = datetime.datetime.now()
            if previous != now.second:
                previous = now.second
                if now.second % 5 == 0:
                    level = logging.ERROR
                else:
                    level = logging.INFO
                logger.log(level, now)
            time.sleep(0.2)

    def stop(self):
        self._stop_event.set()&lt;/pre&gt;
&lt;p&gt;The full code is available on &lt;a class="reference external" href="https://github.com/beenje/tkinter-logging-text-widget"&gt;github&lt;/a&gt;.
If you checkout the version v0.1.0 and run it, you'll see something like that:&lt;/p&gt;
&lt;img alt="/images/tkinter/logging_handler.png" src="http://beenje.github.io/blog/images/tkinter/logging_handler.png"&gt;
&lt;/div&gt;
&lt;div class="section" id="pane-layout"&gt;
&lt;h2&gt;3-pane layout&lt;/h2&gt;
&lt;p&gt;The &lt;cite&gt;ConsoleUi&lt;/cite&gt; class takes a frame as argument. It makes it easy to
integrate in another layout. Let's see an example with a &lt;a class="reference external" href="http://www.tkdocs.com/tutorial/complex.html#panedwindow"&gt;Paned Window
widget&lt;/a&gt; to
implement the common 3-pane layout.&lt;/p&gt;
&lt;p&gt;Let's first create two new classes. The first one will be used to display
a simple form to send a message via logging. The user can select the
desired logging level:&lt;/p&gt;
&lt;pre class="literal-block"&gt;class FormUi:

    def __init__(self, frame):
        self.frame = frame
        # Create a combobbox to select the logging level
        values = ['DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL']
        self.level = tk.StringVar()
        ttk.Label(self.frame, text='Level:').grid(column=0, row=0, sticky=W)
        self.combobox = ttk.Combobox(
            self.frame,
            textvariable=self.level,
            width=25,
            state='readonly',
            values=values
        )
        self.combobox.current(0)
        self.combobox.grid(column=1, row=0, sticky=(W, E))
        # Create a text field to enter a message
        self.message = tk.StringVar()
        ttk.Label(self.frame, text='Message:').grid(column=0, row=1, sticky=W)
        ttk.Entry(self.frame, textvariable=self.message, width=25).grid(column=1, row=1, sticky=(W, E))
        # Add a button to log the message
        self.button = ttk.Button(self.frame, text='Submit', command=self.submit_message)
        self.button.grid(column=1, row=2, sticky=W)

    def submit_message(self):
        # Get the logging level numeric value
        lvl = getattr(logging, self.level.get())
        logger.log(lvl, self.message.get())&lt;/pre&gt;
&lt;p&gt;The other class is a dummy one to show the 3-pane layout:&lt;/p&gt;
&lt;pre class="literal-block"&gt;class ThirdUi:

    def __init__(self, frame):
        self.frame = frame
        ttk.Label(self.frame, text='This is just an example of a third frame').grid(column=0, row=1, sticky=W)
        ttk.Label(self.frame, text='With another line here!').grid(column=0, row=4, sticky=W)&lt;/pre&gt;
&lt;p&gt;With those new classes, the only change required is in the &lt;cite&gt;App&lt;/cite&gt; class to
create a vertical and horizontal &lt;cite&gt;ttk.PanedWindow&lt;/cite&gt;.
The horizontal pane is splitted in two frames (the form and console):&lt;/p&gt;
&lt;pre class="literal-block"&gt; class App:

     def __init__(self, root):
@@ -109,11 +148,24 @@ class App:
         root.title('Logging Handler')
         root.columnconfigure(0, weight=1)
         root.rowconfigure(0, weight=1)
-        console_frame = ttk.Frame(root)
-        console_frame.grid(column=0, row=0, sticky=(N, W, E, S))
+        # Create the panes and frames
+        vertical_pane = ttk.PanedWindow(self.root, orient=VERTICAL)
+        vertical_pane.grid(row=0, column=0, sticky="nsew")
+        horizontal_pane = ttk.PanedWindow(vertical_pane, orient=HORIZONTAL)
+        vertical_pane.add(horizontal_pane)
+        form_frame = ttk.Labelframe(horizontal_pane, text="MyForm")
+        form_frame.columnconfigure(1, weight=1)
+        horizontal_pane.add(form_frame, weight=1)
+        console_frame = ttk.Labelframe(horizontal_pane, text="Console")
         console_frame.columnconfigure(0, weight=1)
         console_frame.rowconfigure(0, weight=1)
+        horizontal_pane.add(console_frame, weight=1)
+        third_frame = ttk.Labelframe(vertical_pane, text="Third Frame")
+        vertical_pane.add(third_frame, weight=1)
+        # Initialize all frames
+        self.form = FormUi(form_frame)
         self.console = ConsoleUi(console_frame)
+        self.third = ThirdUi(third_frame)
         self.clock = Clock()
         self.clock.start()
         self.root.protocol('WM_DELETE_WINDOW', self.quit)&lt;/pre&gt;
&lt;p&gt;Note that the &lt;cite&gt;Clock&lt;/cite&gt; and &lt;cite&gt;ConsoleUi&lt;/cite&gt; classes were left untouched.
We just pass a &lt;cite&gt;ttk.LabelFrame&lt;/cite&gt; instead of a &lt;cite&gt;ttk.Frame&lt;/cite&gt; to the &lt;cite&gt;ConsoleUi&lt;/cite&gt;
class.&lt;/p&gt;
&lt;p&gt;This looks more like what could be a real application:&lt;/p&gt;
&lt;img alt="/images/tkinter/paned_window.png" src="http://beenje.github.io/blog/images/tkinter/paned_window.png"&gt;
&lt;p&gt;The main window and the different panes can be resized nicely:&lt;/p&gt;
&lt;img alt="/images/tkinter/paned_window_resized.png" src="http://beenje.github.io/blog/images/tkinter/paned_window_resized.png"&gt;
&lt;p&gt;As already mentioned, the full example is available on &lt;a class="reference external" href="https://github.com/beenje/tkinter-logging-text-widget"&gt;github&lt;/a&gt;.
You can checkout the version v0.2.0 to see the 3-pane layout.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;I want to give some credit to &lt;a class="reference external" href="https://docs.python.org/3.6/library/tkinter.html"&gt;tkinter&lt;/a&gt;. It doesn't have a steep learning curve and allows to easily create some nice GUI.
You can continue using what you know in Python (Queue, Threads, modules like &lt;a class="reference external" href="http://pyserial.readthedocs.io/en/latest/"&gt;pySerial&lt;/a&gt;).
I can only recomment it if you are familiar with Python and want to create a simple GUI.
That being said, I'll probably try to dive more in &lt;a class="reference external" href="https://riverbankcomputing.com/software/pyqt/intro"&gt;PyQt&lt;/a&gt; when I have more time.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>gui</category><category>python</category><category>tkinter</category><guid>http://beenje.github.io/blog/posts/logging-to-a-tkinter-scrolledtext-widget/</guid><pubDate>Thu, 28 Dec 2017 20:31:25 GMT</pubDate></item><item><title>Experimenting with asyncio on a Raspberry Pi</title><link>http://beenje.github.io/blog/posts/experimenting-with-asyncio-on-a-raspberry-pi/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;p&gt;In a previous post, I described how I built a &lt;a class="reference external" href="http://beenje.github.io/blog/posts/my-lego-macintosh-classic-with-raspberry-pi-and-e-paper-display"&gt;LEGO Macintosh Classic with
a Raspberry Pi and e-paper display&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For testing purpose I installed the clock demo which is part of the
&lt;a class="reference external" href="https://github.com/embeddedartists/gratis"&gt;Embedded Artists repository&lt;/a&gt;.
Of course I wanted to do more than displaying the time on this little box.
I also wanted to take advantage of the button I had integrated.&lt;/p&gt;
&lt;p&gt;One idea was to create a small web server so that I could receive and display
messages. The application would basically:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;display the time (every minute)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when receiving a message, stop the clock and display the message&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;when the button is pressed, start the clock again&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;img alt="/images/legomac/press_button.gif" src="http://beenje.github.io/blog/images/legomac/press_button.gif"&gt;
&lt;p&gt;I don't know about you, but this really makes me think &lt;strong&gt;event loop&lt;/strong&gt;!
I learnt asynchronous programming with &lt;a class="reference external" href="http://krondo.com/an-introduction-to-asynchronous-programming-and-twisted/"&gt;Dave Peticolas Twisted Introduction&lt;/a&gt;
a few years ago. If you are not familiar with asynchronous programming, I really recommend
it. I wrote a few applications using &lt;a class="reference external" href="https://twistedmatrix.com"&gt;Twisted&lt;/a&gt; but I haven't had
the opportunity to use asyncio yet. Here is a very good occasion!&lt;/p&gt;
&lt;div class="section" id="asyncio"&gt;
&lt;h2&gt;asyncio&lt;/h2&gt;
&lt;div class="section" id="rest-api-using-aiohttp"&gt;
&lt;h3&gt;REST API using aiohttp&lt;/h3&gt;
&lt;p&gt;There are already several asyncio web frameworks to build an HTTP server.
I decided to go with &lt;a class="reference external" href="http://aiohttp.readthedocs.io/en/stable/"&gt;aiohttp&lt;/a&gt;
which is kind of the default one.&lt;/p&gt;
&lt;p&gt;Using this &lt;a class="reference external" href="http://steelkiwi.com/blog/jwt-authorization-python-part-1-practise/"&gt;tutorial&lt;/a&gt; I
wrote a simple REST API using aiohttp. It uses JSON Web Tokens which is
something else I have been wanted to try.&lt;/p&gt;
&lt;p&gt;The API has only 3 endpoints:&lt;/p&gt;
&lt;pre class="literal-block"&gt;def setup_routes(app):
    app.router.add_get('/', index)
    app.router.add_post('/login', login)
    app.router.add_post('/messages', post_message)&lt;/pre&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;/&lt;/cite&gt; to check that our token is valid&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;/login&lt;/cite&gt; to login&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;cite&gt;/messages&lt;/cite&gt; to post messages&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class="literal-block"&gt;async def login(request):
    config = request.app['config']
    data = await request.json()
    try:
        user = data['username']
        passwd = data['password']
    except KeyError:
        return web.HTTPBadRequest(reason='Invalid arguments')
    # We have only one user hard-coded in the config file...
    if user != config['username'] or passwd != config['password']:
        return web.HTTPBadRequest(reason='Invalid credentials')
    payload = {
        'user_id': 1,
        'exp': datetime.datetime.utcnow() + datetime.timedelta(seconds=config['jwt_exp_delta_seconds'])
    }
    jwt_token = jwt.encode(payload, config['jwt_secret'], config['jwt_algorithm'])
    logger.debug(f'JWT token created for {user}')
    return web.json_response({'token': jwt_token.decode('utf-8')})


@login_required
async def post_message(request):
    if request.content_type != 'application/json':
        return web.HTTPBadRequest()
    data = await request.json()
    try:
        message = data['message']
    except KeyError:
        return web.HTTPBadRequest()
    logger.debug(f'Message received from {request.user}: {message}')
    return web.json_response({'message': message}, status=201)


@login_required
async def index(request):
    return web.json_response({'message': 'Welcome to LegoMac {}!'.format(request.user)})&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="raspberry-pi-gpio-and-asyncio"&gt;
&lt;h3&gt;Raspberry Pi GPIO and asyncio&lt;/h3&gt;
&lt;p&gt;The default Python package to control the Raspberry Pi GPIO seems to be
&lt;a class="reference external" href="https://pypi.python.org/pypi/RPi.GPIO"&gt;RPi.GPIO&lt;/a&gt;.
That's at least what is used in the &lt;a class="reference external" href="https://github.com/embeddedartists/gratis/blob/master/PlatformWithOS/demo/ImageDemoButton.py"&gt;ImageDemoButton.py from Embedded Artists&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;An alternative is the &lt;a class="reference external" href="http://abyz.co.uk/rpi/pigpio/index.html"&gt;pigpio library&lt;/a&gt;
which provides a daemon to access the Raspberry Pi GPIO via a pipe or socket interface.
And someone (Pierre Rust) already created an aysncio based Python client
for the pigpio daemon: &lt;a class="reference external" href="https://github.com/PierreRust/apigpio"&gt;apigpio&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Exactly what I needed!
It's basically a (incomplete) port of the original Python client provided
with pigpio, but far sufficient for my need. I just want to get a
notification when pressing the button on top of the screen.&lt;/p&gt;
&lt;p&gt;There is an example how to achieve that: &lt;a class="reference external" href="https://github.com/PierreRust/apigpio/blob/master/samples/gpio_notification.py"&gt;gpio_notification.py&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="e-paper-display-and-asyncio"&gt;
&lt;h3&gt;E-paper display and asyncio&lt;/h3&gt;
&lt;p&gt;The last remaining piece is to make the e-paper display play nicely with
asyncio.&lt;/p&gt;
&lt;p&gt;The EPD driver uses the fuse library. It allows the display to be
represented as a virtual directory of files. So sending a command
consists of writing to a file.&lt;/p&gt;
&lt;p&gt;There is a library to add file support to asyncio: &lt;a class="reference external" href="https://github.com/Tinche/aiofiles"&gt;aiofiles&lt;/a&gt;.
The only thing I had to do was basically to wrap the file IO in &lt;a class="reference external" href="https://github.com/embeddedartists/gratis/blob/master/PlatformWithOS/demo/EPD.py"&gt;EPD.py&lt;/a&gt;
with aiofiles:&lt;/p&gt;
&lt;pre class="literal-block"&gt;async def _command(self, c):
    async with aiofiles.open(os.path.join(self._epd_path, 'command'), 'wb') as f:
        await f.write(c)&lt;/pre&gt;
&lt;p&gt;You can't use &lt;cite&gt;await&lt;/cite&gt; in a class &lt;cite&gt;__init__&lt;/cite&gt; method. So following some recommendations
from &lt;a class="reference external" href="https://stackoverflow.com/questions/33128325/how-to-set-class-attribute-with-await-in-init"&gt;stackoverflow&lt;/a&gt;,
I used the factory pattern and moved the actions requiring some IO to a classmethod:&lt;/p&gt;
&lt;pre class="literal-block"&gt;@classmethod
async def create(cls, *args, **kwargs):
    self = EPD(*args, **kwargs)
    async with aiofiles.open(os.path.join(self._epd_path, 'version')) as f:
        version = await f.readline()
        self._version = version.rstrip('\n')
    async with aiofiles.open(os.path.join(self._epd_path, 'panel')) as f:
        line = await f.readline()
        m = self.PANEL_RE.match(line.rstrip('\n'))
        if m is None:
            raise EPDError('invalid panel string')
        ...&lt;/pre&gt;
&lt;p&gt;To create an instance of the EPD class, use:&lt;/p&gt;
&lt;pre class="literal-block"&gt;epd = await EPD.create([path='/path/to/epd'], [auto=boolean])&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="putting-everything-together-with-aiohttp"&gt;
&lt;h2&gt;Putting everything together with aiohttp&lt;/h2&gt;
&lt;div class="section" id="running-the-clock-as-a-background-task"&gt;
&lt;h3&gt;Running the clock as a background task&lt;/h3&gt;
&lt;p&gt;For the clock, I adapted the &lt;a class="reference external" href="https://github.com/embeddedartists/gratis/blob/master/PlatformWithOS/demo/Clock27.py"&gt;clock demo&lt;/a&gt;
from Embedded Artists repository.&lt;/p&gt;
&lt;p&gt;As described in aiohttp documentation I created a &lt;a class="reference external" href="http://aiohttp.readthedocs.io/en/stable/web.html#background-tasks"&gt;background task&lt;/a&gt; to display the clock
every minute:&lt;/p&gt;
&lt;pre class="literal-block"&gt;async def display_clock(app):
    """Background task to display clock every minute"""
    clock = Clock(app['epd'])
    first_start = True
    try:
        while True:
            while True:
                now = datetime.datetime.today()
                if now.second == 0 or first_start:
                    first_start = False
                    break
                await asyncio.sleep(0.5)
            logger.debug('display clock')
            await clock.display(now)
    except asyncio.CancelledError:
        logger.debug('display clock cancel')


async def start_background_tasks(app):
     app['epd'] = await EPD.create(auto=True)
     app['clock'] = app.loop.create_task(display_clock(app))


async def cleanup_background_tasks(app):
    app['clock'].cancel()
    await app['clock']


def init_app():
    """Create and return the aiohttp Application object"""
    app = web.Application()
    app.on_startup.append(start_background_tasks)
    app.on_cleanup.append(cleanup_background_tasks)
    ...&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="stop-the-clock-and-display-a-message"&gt;
&lt;h3&gt;Stop the clock and display a message&lt;/h3&gt;
&lt;p&gt;When receiving a message, I first cancel the clock background task and
send the messages to the e-paper display using &lt;cite&gt;ensure_future&lt;/cite&gt; so that
I can return a json response without having to wait for the message to be
displayed as it takes about 5 seconds:&lt;/p&gt;
&lt;pre class="literal-block"&gt;@login_required
async def post_message(request):
    if request.content_type != 'application/json':
        return web.HTTPBadRequest()
    data = await request.json()
    try:
        message = data['message']
    except KeyError:
        return web.HTTPBadRequest()
    # cancel the display clock
    request.app['clock'].cancel()
    logger.debug(f'Message received from {request.user}: {message}')
    now = datetime.datetime.now(request.app['timezone'])
    helpers.ensure_future(request.app['epd'].display_message(message, request.user, now))
    return web.json_response({'message': message}, status=201)&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="start-the-clock-when-pressing-the-button"&gt;
&lt;h3&gt;Start the clock when pressing the button&lt;/h3&gt;
&lt;p&gt;To be able to restart the clock when pressing the button, I connect to the
pigpiod when starting the app (in &lt;cite&gt;start_background_tasks&lt;/cite&gt;) and register
the &lt;cite&gt;on_input&lt;/cite&gt; callback:&lt;/p&gt;
&lt;pre class="literal-block"&gt;async def start_background_tasks(app):
    app['pi'] = apigpio.Pi(app.loop)
    address = (app['config']['pigpiod_host'], app['config']['pigpiod_port'])
    await app['pi'].connect(address)
    await app['pi'].set_mode(BUTTON_GPIO, apigpio.INPUT)
    app['cb'] = await app['pi'].add_callback(
            BUTTON_GPIO,
            edge=apigpio.RISING_EDGE,
            func=functools.partial(on_input, app))
    ...&lt;/pre&gt;
&lt;p&gt;In the &lt;cite&gt;on_input&lt;/cite&gt; callback, I re-create the clock background task but only if the previous
task is done:&lt;/p&gt;
&lt;pre class="literal-block"&gt;def on_input(app, gpio, level, tick):
    """Callback called when pressing the button on the e-paper display"""
    logger.info('on_input {} {} {}'.format(gpio, level, tick))
    if app['clock'].done():
        logger.info('restart clock')
        app['clock'] = app.loop.create_task(display_clock(app))&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="running-on-the-pi"&gt;
&lt;h2&gt;Running on the Pi&lt;/h2&gt;
&lt;p&gt;You might have noticed that I used some syntax that is Python 3.6 only.
I don't really see myself using something else when starting a new project
today :-)
There are so many new things (like f-strings) that make your programs look
cleaner.&lt;/p&gt;
&lt;p&gt;On raspbian, if you install Python 3, you get 3.4... So how do you get Python 3.6 on
a Raspberry Pi?&lt;/p&gt;
&lt;p&gt;On desktop/server I usually use &lt;a class="reference external" href="https://conda.io/miniconda.html"&gt;conda&lt;/a&gt;. It makes it so easy to install
the Python version you want and many dependencies.
There are no official installer for the armv6 architecture but I
found &lt;a class="reference external" href="https://github.com/jjhelmus/berryconda"&gt;berryconda&lt;/a&gt; which is a
conda based distribution for the Raspberry Pi! Really nice!&lt;/p&gt;
&lt;p&gt;Another alternative is to use &lt;a class="reference external" href="https://www.docker.com"&gt;docker&lt;/a&gt;.
There are official &lt;a class="reference external" href="https://hub.docker.com/u/arm32v6/python"&gt;arm32v6 images&lt;/a&gt;
based on alpine and some from &lt;a class="reference external" href="https://hub.docker.com/r/resin/raspberry-pi-python/"&gt;resin.io&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I could have gone with berryconda, but there's one thing I wanted as well.
I'll have to open the HTTP server to the outside world meaning I need
HTTPS. As mentionned in another &lt;a class="reference external" href="http://beenje.github.io/blog/post/running-your-application-over-https-with-traefik"&gt;post&lt;/a&gt;, &lt;a class="reference external" href="https://traefik.io"&gt;traefik&lt;/a&gt; makes
that very easy if you use docker. So that's what I chose.&lt;/p&gt;
&lt;p&gt;I created 3 containers:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;traefik&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;pigpiod&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;aiolegomac&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="section" id="traefik"&gt;
&lt;h3&gt;traefik&lt;/h3&gt;
&lt;p&gt;There are no official Traefik docker images for arm yet, but an &lt;a class="reference external" href="https://github.com/containous/traefik/issues/1665"&gt;issue&lt;/a&gt; is currently opened.
So it should arrive soon!&lt;/p&gt;
&lt;p&gt;In the meantime I created my own:&lt;/p&gt;
&lt;pre class="literal-block"&gt;FROM arm32v6/alpine:3.6

RUN apk --update upgrade \
  &amp;amp;&amp;amp; apk --no-cache --no-progress add ca-certificates \
  &amp;amp;&amp;amp; apk add openssl \
  &amp;amp;&amp;amp; rm -rf /var/cache/apk/*

RUN wget -O /usr/local/bin/traefik https://github.com/containous/traefik/releases/download/v1.3.3/traefik_linux-arm \
  &amp;amp;&amp;amp; chmod a+x /usr/local/bin/traefik

ENTRYPOINT ["/usr/local/bin/traefik"]&lt;/pre&gt;
&lt;/div&gt;
&lt;div class="section" id="pigpiod"&gt;
&lt;h3&gt;pigpiod&lt;/h3&gt;
&lt;p&gt;For pigpiod, I first created an image based on &lt;cite&gt;arm32v6/alpine&lt;/cite&gt; but I noticed I couldn't send
a SIGTERM to the daemon to stop it properly... I'm not sure why. Alpine being based on &lt;cite&gt;musl&lt;/cite&gt; instead
of &lt;cite&gt;glibc&lt;/cite&gt; might be the problem. Here is the Dockerfile I tried:&lt;/p&gt;
&lt;pre class="literal-block"&gt;FROM arm32v6/alpine:3.6

RUN apk add --no-cache --virtual .build-deps \
  gcc \
  make \
  musl-dev \
  tar \
  &amp;amp;&amp;amp; wget -O /tmp/pigpio.tar abyz.co.uk/rpi/pigpio/pigpio.tar \
  &amp;amp;&amp;amp; tar -xf /tmp/pigpio.tar -C /tmp \
  &amp;amp;&amp;amp; sed -i "/ldconfig/d" /tmp/PIGPIO/Makefile \
  &amp;amp;&amp;amp; make -C /tmp/PIGPIO \
  &amp;amp;&amp;amp; make -C /tmp/PIGPIO install \
  &amp;amp;&amp;amp; rm -rf /tmp/PIGPIO /tmp/pigpio.tar \
  &amp;amp;&amp;amp; apk del .build-deps

EXPOSE 8888

ENTRYPOINT ["/usr/local/bin/pigpiod", "-g"]&lt;/pre&gt;
&lt;p&gt;I even tried using &lt;a class="reference external" href="https://github.com/krallin/tini"&gt;tini&lt;/a&gt; as entrypoint without luck.
So if someone as the explanation, please share it in the comments.&lt;/p&gt;
&lt;p&gt;I tried with &lt;cite&gt;resin/rpi-raspbian&lt;/cite&gt; image and I got it working properly right away:&lt;/p&gt;
&lt;pre class="literal-block"&gt;FROM resin/rpi-raspbian:jessie

RUN apt-get update \
  &amp;amp;&amp;amp; apt-get install -y \
     make \
     gcc \
     libc6-dev \
  &amp;amp;&amp;amp; apt-get clean \
  &amp;amp;&amp;amp; rm -rf /var/lib/apt/lists/*

RUN curl -o /tmp/pigpio.tar abyz.co.uk/rpi/pigpio/pigpio.tar \
  &amp;amp;&amp;amp; tar -xf /tmp/pigpio.tar -C /tmp \
  &amp;amp;&amp;amp; make -C /tmp/PIGPIO \
  &amp;amp;&amp;amp; make -C /tmp/PIGPIO install \
  &amp;amp;&amp;amp; rm -rf /tmp/pigpio.tar /tmp/PIGPIO

EXPOSE 8888

ENTRYPOINT ["/usr/local/bin/pigpiod", "-g"]&lt;/pre&gt;
&lt;p&gt;Note that the container has to run in privileged mode to access the GPIO.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="aiolegomac"&gt;
&lt;h3&gt;aiolegomac&lt;/h3&gt;
&lt;p&gt;For the main application, the Dockerfile is quite standard for a Python application:&lt;/p&gt;
&lt;pre class="literal-block"&gt;FROM resin/raspberry-pi-python:3.6

RUN apt-get update \
  &amp;amp;&amp;amp; apt-get install -y \
     fonts-liberation \
     fonts-dejavu  \
     libjpeg-dev \
     libfreetype6-dev \
     libtiff5-dev \
     liblcms2-dev \
     libwebp-dev \
     zlib1g-dev \
     libyaml-0-2 \
  &amp;amp;&amp;amp; apt-get autoremove \
  &amp;amp;&amp;amp; apt-get clean \
  &amp;amp;&amp;amp; rm -rf /var/lib/apt/lists/*

WORKDIR /app

COPY requirements.txt /app/requirements.txt
RUN python -m venv /opt/legomac \
  &amp;amp;&amp;amp; /opt/legomac/bin/pip install -r requirements.txt

COPY . /app

ENTRYPOINT ["/opt/legomac/bin/python"]
CMD ["run.py"]&lt;/pre&gt;
&lt;p&gt;What about the EPD driver?
As it uses libfuse to represent the e-paper display as a virtual directory of files,
the easiest was to install it on the host and to mount it as a volume inside the docker
container.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="deployment"&gt;
&lt;h2&gt;Deployment&lt;/h2&gt;
&lt;p&gt;To install all that on the Pi, I wrote a small &lt;a class="reference external" href="https://www.ansible.com"&gt;Ansible&lt;/a&gt; playbook.&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p&gt;Configure the Pi as described in my &lt;a class="reference external" href="http://beenje.github.io/blog/posts/my-lego-macintosh-classic-with-raspberry-pi-and-e-paper-display"&gt;previous post&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Clone the playbook:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ git clone https://github.com/beenje/legomac.git
$ cd legomac&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create a file &lt;cite&gt;host_vars/legomac&lt;/cite&gt; with your variables (assuming the hostname of the Pi is legomac):&lt;/p&gt;
&lt;pre class="literal-block"&gt;aiolegomac_hostname: myhost.example.com
aiolegomac_username: john
aiolegomac_password: mypassword
aiolegomac_jwt_secret: secret
traefik_letsencrypt_email: youremail@example.com
traefik_letsencrypt_production: true&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Run the playbook:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ ansible-playbook -i hosts -k playbook.yml&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;This will install docker and the EPD driver, download the &lt;a class="reference external" href="https://github.com/beenje/aiolegomac"&gt;aiolegomac repository&lt;/a&gt;, build the 3 docker images
and start everything.&lt;/p&gt;
&lt;p&gt;Building the main application docker image on a Raspberry Pi Zero takes quite some time.
So be patient :-) Just go and do something else.&lt;/p&gt;
&lt;p&gt;When the full playbook is complete (it took about 55 minutes for me),
you'll have a server with HTTPS support (thanks to Let's Encrypt) running on the Pi. It's displaying
the clock every minute and you can send messages to it!&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="client"&gt;
&lt;h2&gt;Client&lt;/h2&gt;
&lt;div class="section" id="httpie"&gt;
&lt;h3&gt;HTTPie&lt;/h3&gt;
&lt;p&gt;To test the server you can of course use &lt;a class="reference external" href="https://curl.haxx.se"&gt;curl&lt;/a&gt;
but I really like &lt;a class="reference external" href="https://httpie.org"&gt;HTTPie&lt;/a&gt;. It's much more user
friendly.&lt;/p&gt;
&lt;p&gt;Let's try to access our new server:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ http GET https://myhost.example.com
HTTP/1.1 401 Unauthorized
Content-Length: 25
Content-Type: application/json; charset=utf-8
Date: Sun, 16 Jul 2017 06:22:42 GMT
Server: Python/3.6 aiohttp/2.2.3

{
    "error": "Unauthorized"
}&lt;/pre&gt;
&lt;p&gt;Good, we need to login:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ http POST https://myhost.example.com/login username=john password=foo
HTTP/1.1 400 Bad Request
Content-Length: 32
Content-Type: application/json; charset=utf-8
Date: Sun, 16 Jul 2017 06:18:39 GMT
Server: Python/3.6 aiohttp/2.2.3

{
    "error": "Invalid credentials"
}&lt;/pre&gt;
&lt;p&gt;Oops, wrong password:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ http POST https://myhost.example.com/login username=john password='mypassword'
HTTP/1.1 200 OK
Content-Length: 134
Content-Type: application/json; charset=utf-8
Date: Sun, 16 Jul 2017 06:21:14 GMT
Server: Python/3.6 aiohttp/2.2.3

{
    "token": "eyK0eXAiOiJRV5QiLCJhbGciOiJIUzI1NiJ9.eyJ1c3VyX2lkIjoxLCJleHAiOjE1MDB5MTIwOTh9.hECnj4u2mxvZ2r8IEC-db1T-eKTplM4kWJKZoHhtLxQ"
}&lt;/pre&gt;
&lt;p&gt;We got a token that we can use:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ http GET https://myhost.example.com 'Authorization: eyK0eXAiOiJRV5QiLCJhbGciOiJIUzI1NiJ9.eyJ1c3VyX2lkIjoxLCJleHAiOjE1MDB5MTIwOTh9.hECnj4u2mxvZ2r8IEC-db1T-eKTplM4kWJKZoHhtLxQ'
HTTP/1.1 200 OK
Content-Length: 43
Content-Type: application/json; charset=utf-8
Date: Sun, 16 Jul 2017 06:22:25 GMT
Server: Python/3.6 aiohttp/2.2.3

{
    "message": "Welcome to LegoMac john!"
}&lt;/pre&gt;
&lt;p&gt;Authentication is working, so we can send a message:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ http POST https://myhost.example.com/messages message='Hello World!' 'Authorization: eyK0eXAiOiJRV5QiLCJhbGciOiJIUzI1NiJ9.eyJ1c3VyX2lkIjoxLCJleHAiOjE1MDB5MTIwOTh9.hECnj4u2mxvZ2r8IEC-db1T-eKTplM4kWJKZoHhtLxQ'
HTTP/1.1 201 Created
Content-Length: 27
Content-Type: application/json; charset=utf-8
Date: Sun, 16 Jul 2017 06:23:46 GMT
Server: Python/3.6 aiohttp/2.2.3

{
    "message": "Hello World!"
}&lt;/pre&gt;
&lt;p&gt;Message sent!
HTTPie is nice for testing, but we can make a small script to easily send messages from the command line.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="requests"&gt;
&lt;h3&gt;requests&lt;/h3&gt;
&lt;p&gt;&lt;a class="reference external" href="http://docs.python-requests.org"&gt;requests&lt;/a&gt; is of course the HTTP library to use in Python.&lt;/p&gt;
&lt;p&gt;So let's write a small script to send messages to our server.
We'll store the server url and username to use in a small yaml configuration file.
If we don't have a token yet or if the saved one is no longer valid,
the script will retrieve one after prompting us for a password.
The token is saved in the configuration file for later use.&lt;/p&gt;
&lt;p&gt;The following script could be improved with some nicer error messages
by catching exceptions. But it does the job:&lt;/p&gt;
&lt;pre class="literal-block"&gt;import os
import click
import requests
import yaml


def get_config(filename):
    with open(filename) as f:
        config = yaml.load(f)
    return config


def save_config(filename, config):
    with open(filename, 'w') as f:
        yaml.dump(config, f, default_flow_style=False)


def get_token(url, username):
    password = click.prompt('Password', hide_input=True)
    payload = {'username': username, 'password': password}
    r = requests.post(url + '/login', json=payload)
    r.raise_for_status()
    return r.json()['token']


def send_message(url, token, message):
    payload = {'message': message}
    headers = {'Authorization': token}
    r = requests.post(url + '/messages', json=payload, headers=headers)
    r.raise_for_status()


@click.command()
@click.option('--conf', '-c', default='~/.pylegomac.yml',
              help='Configuration file [default: "~/.pylegomac.yml"]')
@click.argument('message')
@click.version_option()
def pylegomac(message, conf):
    """Send message to aiolegomac server"""
    filename = os.path.expanduser(conf)
    config = get_config(filename)
    url = config['url']
    username = config['username']
    if 'token' in config:
        try:
            send_message(url, config['token'], message)
        except requests.exceptions.HTTPError as err:
            # Token no more valid
            pass
        else:
            click.echo('Message sent')
            return
    token = get_token(url, username)
    send_message(url, token, message)
    config['token'] = token
    save_config(filename, config)


if __name__ == '__main__':
    pylegomac()&lt;/pre&gt;
&lt;p&gt;Let's first create a configuration file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ cat ~/.pylegomac.yml
url: https://myhost.example.com
username: john&lt;/pre&gt;
&lt;p&gt;Send a message:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ python pylegomac.py 'Beautiful is better than ugly. Explicit is better than implicit. Simple is better than complex. Complex is better than complicated.'
Password:
Message sent&lt;/pre&gt;
&lt;img alt="/images/legomac/zen_of_python.jpg" src="http://beenje.github.io/blog/images/legomac/zen_of_python.jpg"&gt;
&lt;p&gt;Sending a new message won't request the password as the token was saved in the config file.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;I have a nice little aiohttp server running on my Raspberry Pi that can receive and display messages.
asyncio is quite pleasant to work with. I really like the async/await syntax.&lt;/p&gt;
&lt;p&gt;All the code is on github:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/beenje/aiolegomac"&gt;aiolegomac&lt;/a&gt; (the server and client script)&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a class="reference external" href="https://github.com/beenje/legomac"&gt;legomac&lt;/a&gt; (the Ansible playbook to deploy the server)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Why did I only write a command line script to send messages and no web interface?
Don't worry, that's planned! I could have used Jinja2. But I'd like to try a javascript framework.
So that will be the subject of another post.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>Ansible</category><category>docker</category><category>lego</category><category>pi</category><category>python</category><guid>http://beenje.github.io/blog/posts/experimenting-with-asyncio-on-a-raspberry-pi/</guid><pubDate>Tue, 18 Jul 2017 20:46:17 GMT</pubDate></item><item><title>Running your application over HTTPS with traefik</title><link>http://beenje.github.io/blog/posts/running-your-application-over-https-with-traefik/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;p&gt;I just read another very clear article from Miguel Grinberg about &lt;a class="reference external" href="https://blog.miguelgrinberg.com/post/running-your-flask-application-over-https"&gt;Running Your Flask
Application Over HTTPS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;As the title suggests, it describes different ways to run a flask application over HTTPS.
I have been using &lt;a class="reference external" href="http://flask.pocoo.org"&gt;flask&lt;/a&gt; for quite some time, but I didn't even know about
the &lt;cite&gt;ssl_context&lt;/cite&gt; argument. You should definitively check his article!&lt;/p&gt;
&lt;p&gt;Using &lt;a class="reference external" href="https://nginx.org/en/"&gt;nginx&lt;/a&gt; as a reverse proxy with a self-signed certificate or &lt;a class="reference external" href="https://letsencrypt.org"&gt;Let’s
Encrypt&lt;/a&gt; are two options I have been using in the
past.&lt;/p&gt;
&lt;p&gt;If your app is available on the internet, you should definitively use
Let's Encrypt. But if your app is only supposed to be used internally
on a private network, a self-signed certificate is an option.&lt;/p&gt;
&lt;div class="section" id="traefik"&gt;
&lt;h2&gt;Traefik&lt;/h2&gt;
&lt;p&gt;I now often use &lt;a class="reference external" href="https://www.docker.com"&gt;docker&lt;/a&gt; to deploy my applications.
I was looking for a way to automatically configure Let's Encrypt.
I initially found &lt;a class="reference external" href="https://github.com/jwilder/nginx-proxy"&gt;nginx-proxy&lt;/a&gt;
and &lt;a class="reference external" href="https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion"&gt;docker-letsencrypt-nginx-proxy-companion&lt;/a&gt;. This
was interesting but wasn't that straight forward to setup.&lt;/p&gt;
&lt;p&gt;I then discovered &lt;a class="reference external" href="https://traefik.io"&gt;traefik&lt;/a&gt;: "a modern HTTP reverse proxy
and load balancer made to deploy microservices with ease". And that's
really the case! I've used it to deploy several applications and I
was impressed. It's written in go, so single binary. There is also a tiny docker
image that makes it easy to deploy. It includes Let's Encrypt support (with automatic renewal),
websocket support (no specific setup required)... And many other features.&lt;/p&gt;
&lt;p&gt;Here is a &lt;cite&gt;traefik.toml&lt;/cite&gt; configuration example:&lt;/p&gt;
&lt;pre class="literal-block"&gt;defaultEntryPoints = ["http", "https"]

[web]
# Port for the status page
address = ":8080"

# Entrypoints, http and https
[entryPoints]
  # http should be redirected to https
  [entryPoints.http]
  address = ":80"
    [entryPoints.http.redirect]
    entryPoint = "https"
  # https is the default
  [entryPoints.https]
  address = ":443"
    [entryPoints.https.tls]

# Enable ACME (Let's Encrypt): automatic SSL
[acme]
# Email address used for registration
email = "test@traefik.io"
storageFile = "/etc/traefik/acme/acme.json"
entryPoint = "https"
onDemand = false
OnHostRule = true
  # Use a HTTP-01 acme challenge rather than TLS-SNI-01 challenge
  [acme.httpChallenge]
  entryPoint = "http"

# Enable Docker configuration backend
[docker]
endpoint = "unix:///var/run/docker.sock"
domain = "example.com"
watch = true
exposedbydefault = false&lt;/pre&gt;
&lt;p&gt;With this simple configuration, you get:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;p&gt;HTTP redirect on HTTPS&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Let's Encrypt support&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Docker backend support&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;UPDATE (2018-03-04): as mentioned by @jackminardi in the comments, Let's Encrypt &lt;a class="reference external" href="https://community.letsencrypt.org/t/important-what-you-need-to-know-about-tls-sni-validation-issues/50811"&gt;disabled the TLS-SNI
challenges for most new issuance&lt;/a&gt;.
Traefik added &lt;a class="reference external" href="https://github.com/containous/traefik/pull/2701"&gt;support for the HTTP-01 challenge&lt;/a&gt;. I updated the above
configuration to use this validation method: &lt;cite&gt;[acme.httpChallenge]&lt;/cite&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-simple-example"&gt;
&lt;h2&gt;A simple example&lt;/h2&gt;
&lt;p&gt;I created a dummy example just to show how to run a flask application over
HTTPS with traefik and Let's Encrypt.
Note that traefik is made to dynamically discover backends. So you usually
don't run it with your app in the same docker-compose.yml file. It usually
runs separately. But to make it easier, I put both in the same file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;version: '2'
services:
  flask:
    build: ./flask
    image: flask
    command: uwsgi --http-socket 0.0.0.0:5000 --wsgi-file app.py --callable app
    labels:
      - "traefik.enable=true"
      - "traefik.backend=flask"
      - "traefik.frontend.rule=${TRAEFIK_FRONTEND_RULE}"
  traefik:
    image: traefik
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - ./traefik/traefik.toml:/etc/traefik/traefik.toml:ro
      - ./traefik/acme:/etc/traefik/acme
    ports:
     - "80:80"
     - "443:443"
     - "8080:8080"&lt;/pre&gt;
&lt;p&gt;Traefik requires access to the docker socket to listen for changes in the
backends. It can thus automatically discover when you start and stop
containers. You can ovverride default behaviour by using labels in your
container.&lt;/p&gt;
&lt;p&gt;Supposing you own the myhost.example.com domain and have access to ports 80 and 443
(you can setup port forwarding if you run that on your machine behind a
router at home), you can run:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ git clone https://github.com/beenje/flask_traefik_letsencrypt.git
$ cd flask_traefik_letsencrypt
$ export TRAEFIK_FRONTEND_RULE=Host:myhost.example.com
$ docker-compose up&lt;/pre&gt;
&lt;p&gt;Voilà! Our flask app is available over HTTPS with a real SSL certificate!&lt;/p&gt;
&lt;img alt="/images/flask_traefik/hello_world.png" src="http://beenje.github.io/blog/images/flask_traefik/hello_world.png"&gt;
&lt;p&gt;Traefik discovered the flask docker container and requested a certificate for our domain.
All that automatically!&lt;/p&gt;
&lt;p&gt;Traefik even comes with a nice dashboard:&lt;/p&gt;
&lt;img alt="/images/flask_traefik/traefik_dashboard.png" src="http://beenje.github.io/blog/images/flask_traefik/traefik_dashboard.png"&gt;
&lt;p&gt;With this simple configuration, &lt;a class="reference external" href="https://www.ssllabs.com/index.html"&gt;Qualys SSL Labs&lt;/a&gt;
gave me an A rating :-)&lt;/p&gt;
&lt;img alt="/images/flask_traefik/traefik_ssl_report.png" src="http://beenje.github.io/blog/images/flask_traefik/traefik_ssl_report.png"&gt;
&lt;p&gt;Not as good as the A+ for Miguel's site, but not that bad!
Especially considering there isn't any specific SSL setup.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="a-more-realistic-deployment"&gt;
&lt;h2&gt;A more realistic deployment&lt;/h2&gt;
&lt;p&gt;As I already mentioned, traefik is made to automatically discover backends (docker containers in my case).
So you usually run it by itself.&lt;/p&gt;
&lt;p&gt;Here is an example how it can be deployed using &lt;a class="reference external" href="http://docs.ansible.com/ansible/"&gt;Ansible&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;---
- name: create traefik directories
  file:
    path: /etc/traefik/acme
    state: directory
    owner: root
    group: root
    mode: 0755

- name: create traefik.toml
  template:
    src: traefik.toml.j2
    dest: /etc/traefik/traefik.toml
    owner: root
    group: root
    mode: 0644
  notify:
    - restart traefik

- name: create traefik network
  docker_network:
    name: "{{traefik_network}}"
    state: present

- name: launch traefik container with letsencrypt support
  docker_container:
    name: traefik_proxy
    image: "traefik:{{traefik_version}}"
    state: started
    restart_policy: always
    ports:
      - "80:80"
      - "443:443"
      - "{{traefik_dashboard_port}}:8080"
    volumes:
      - /etc/traefik/traefik.toml:/etc/traefik/traefik.toml:ro
      - /etc/traefik/acme:/etc/traefik/acme:rw
      - /var/run/docker.sock:/var/run/docker.sock:ro
    # purge networks so that the container is only part of
    # {{traefik_network}} (and not the default bridge network)
    purge_networks: yes
    networks:
      - name: "{{traefik_network}}"

- name: force all notified handlers to run
  meta: flush_handlers&lt;/pre&gt;
&lt;p&gt;Nothing strange here. It's quite similar to what we had in our docker-compose.yml file.
We created a specific &lt;cite&gt;traefik_network&lt;/cite&gt;. Our docker containers will have to be on that same network.&lt;/p&gt;
&lt;p&gt;Here is how we could deploy a flask application on the same server using another ansible role:&lt;/p&gt;
&lt;pre class="literal-block"&gt;- name: launch flask container
  docker_container:
    name: flask
    image: flask
    command: uwsgi --http-socket 0.0.0.0:5000 --wsgi-file app.py --callable app
    state: started
    restart_policy: always
    purge_networks: yes
    networks:
      - name: "{{traefik_network}}"
    labels:
      traefik.enable: "true"
      traefik.backend: "flask"
      traefik.frontend.rule: "Host:myhost.example.com"
      traefik.port: "5000"&lt;/pre&gt;
&lt;p&gt;We make sure the container is on the same network as the traefik proxy.
Note that the &lt;cite&gt;traefik.port&lt;/cite&gt; label is only required if the container exposes multiple ports.
It's thus not needed in our example.&lt;/p&gt;
&lt;p&gt;That's basically it. As you can see, &lt;a class="reference external" href="https://www.docker.com"&gt;docker&lt;/a&gt; and &lt;a class="reference external" href="http://docs.ansible.com/ansible/"&gt;Ansible&lt;/a&gt; make the deployment easy.
And &lt;a class="reference external" href="https://traefik.io"&gt;traefik&lt;/a&gt; takes care of the Let's Encrypt certificate.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Traefik comes with many other features and is well &lt;a class="reference external" href="https://docs.traefik.io"&gt;documented&lt;/a&gt;.
You should check &lt;a class="reference external" href="https://docs.traefik.io/#docker"&gt;this Docker example&lt;/a&gt; that demonstrates load-balancing.
Really cool.&lt;/p&gt;
&lt;p&gt;If you use &lt;a class="reference external" href="https://www.docker.com"&gt;docker&lt;/a&gt;, you should really give &lt;a class="reference external" href="https://traefik.io"&gt;traefik&lt;/a&gt; a try!&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>flask</category><category>https</category><category>python</category><category>traefik</category><guid>http://beenje.github.io/blog/posts/running-your-application-over-https-with-traefik/</guid><pubDate>Thu, 08 Jun 2017 19:49:46 GMT</pubDate></item><item><title>Parsing and indexing PDF in Python</title><link>http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;I have a &lt;a href="http://www.getdoxie.com"&gt;Doxie Go&lt;/a&gt; scanner and I scan all the documents I receive in paper.
That's nice, but it creates another problem. All the resulting PDF files have to be named, organized and stored...
Doing that manually is boring and time consuming. Of course that's something I want to automate!&lt;/p&gt;
&lt;p&gt;I even bought &lt;a href="https://www.noodlesoft.com"&gt;Hazel&lt;/a&gt; a while ago.
It's a nice software that monitors files in a folder and performs specific instructions based on the rules you defined.
It works well but I felt a bit limited and I thought I could probably write something more tailored to my use case.
And that would be more fun :-)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Parsing-PDF-in-Python"&gt;Parsing PDF in Python&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/#Parsing-PDF-in-Python"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A quick solution I found was to run &lt;a href="https://linux.die.net/man/1/pdftotext"&gt;pdftotext&lt;/a&gt; using subprocess.
I looked at &lt;a href="https://euske.github.io/pdfminer/"&gt;PDFMiner&lt;/a&gt;, a pure Python PDF parser but I found pdftotext
output to be more accurate.
On MacOS, you can install it using &lt;a href="http://brew.sh"&gt;Homebrew&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ brew install Caskroom/cask/pdftotext&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Here is a simple Python function to do that:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [1]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;subprocess&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;parse_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;check_output&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s2"&gt;"pdftotext"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'-enc'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'UTF-8'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"-"&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;subprocess&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CalledProcessError&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Skipping &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt; (pdftotext returned status &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;)'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;returncode&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'utf-8'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's try to parse a pdf file. We'll use &lt;code&gt;requests&lt;/code&gt; to download a sample file.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [2]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;requests&lt;/span&gt;

&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'http://www.cbu.edu.zm/downloads/pdf-sample.pdf'&lt;/span&gt;
&lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/tmp/pdf-sample.pdf'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'wb'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's first look at the PDF:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [3]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;IPython.display&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;IFrame&lt;/span&gt;
&lt;span class="n"&gt;IFrame&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'http://www.cbu.edu.zm/downloads/pdf-sample.pdf'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;width&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;600&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;height&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;870&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[3]:&lt;/div&gt;



&lt;div class="output_html rendered_html output_subarea output_execute_result"&gt;

        &lt;iframe width="600" height="870" src="http://www.cbu.edu.zm/downloads/pdf-sample.pdf" frameborder="0" allowfullscreen&gt;&lt;/iframe&gt;
        
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Nothing complex. It should be easy to parse.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [4]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parse_pdf&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/tmp/pdf-sample.pdf'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;content&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[4]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;"Adobe Acrobat PDF Files\nAdobe® Portable Document Format (PDF) is a universal file format that preserves all of the fonts, formatting, colours and graphics of any source document, regardless of the application and platform used to create it. Adobe PDF is an ideal format for electronic document distribution as it overcomes the problems commonly encountered with electronic file sharing. • Anyone, anywhere can open a PDF file. All you need is the free Adobe Acrobat Reader. Recipients of other file formats sometimes can't open files because they don't have the applications used to create the documents. PDF files always print correctly on any printing device. PDF files always display exactly as created, regardless of fonts, software, and operating systems. Fonts, and graphics are not lost due to platform, software, and version incompatibilities. The free Acrobat Reader is easy to download and can be freely distributed by anyone. Compact PDF files are smaller than their source files and download a page at a time for fast display on the Web.\n\n• •\n\n• •\n\n\x0c"&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;This works quite well. The layout is not respected but it's the text that matters. It would be easy to define some regex to define rules based on the PDF content.&lt;/p&gt;
&lt;p&gt;This could be the first step in naming and organizing the scanned documents.
But it would be nice to have an interface to easily search in all the files.
I've already used MongoDB full text search in a webapp I wrote and it worked well for my use case.
But I read about Elasticsearch and I always wanted to give it a try.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Elasticsearch-Ingest-Attachment-Processor-Plugin"&gt;Elasticsearch Ingest Attachment Processor Plugin&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/#Elasticsearch-Ingest-Attachment-Processor-Plugin"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;I could just index the result from pdftotext, but I know there is a plugin that can parse PDF files.&lt;/p&gt;
&lt;p&gt;The &lt;a href="https://github.com/elastic/elasticsearch-mapper-attachments#mapper-attachments-type-for-elasticsearch&amp;gt;"&gt;Mapper Attachments Type plugin&lt;/a&gt;
is &lt;a href="https://www.elastic.co/guide/en/elasticsearch/plugins/5.x/mapper-attachments.html&amp;gt;"&gt;deprecated&lt;/a&gt;
in 5.0.0. It has been replaced with the &lt;a href="https://www.elastic.co/guide/en/elasticsearch/plugins/5.x/ingest-attachment.html"&gt;ingest-attachment&lt;/a&gt;
plugin.
So let's look at that.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Running-Elasticsearch"&gt;Running Elasticsearch&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/#Running-Elasticsearch"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;To run Elasticsearch, the easiest is to use Docker.
As the official image from &lt;a href="https://hub.docker.com/_/elasticsearch/"&gt;Docker Hub&lt;/a&gt; comes with no plugin, we'll
create our own image.
See &lt;a href="https://www.elastic.co/blog/elasticsearch-docker-plugin-management"&gt;Elasticsearch Plugin Management with Docker&lt;/a&gt;
for more information.&lt;/p&gt;
&lt;p&gt;Here is our &lt;code&gt;Dockerfile&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;FROM elasticsearch:5

RUN /usr/share/elasticsearch/bin/elasticsearch-plugin install ingest-attachment&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create the &lt;code&gt;elasticsearch-ingest&lt;/code&gt; docker image:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker build -t elasticsearch-ingest .&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can now run elasticsearch with the ingest-attachment plugin:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker run -d -p 9200:9200 elasticsearch-ingest&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Python-Elasticsearch-Client"&gt;Python Elasticsearch Client&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/#Python-Elasticsearch-Client"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We'll use &lt;a href="https://elasticsearch-py.readthedocs.io/en/master/"&gt;elasticsearch-py&lt;/a&gt;
to interact with our Elasticsearch cluster.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [5]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;elasticsearch&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Elasticsearch&lt;/span&gt;
&lt;span class="n"&gt;es&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Elasticsearch&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's first check that our elasticsearch cluster is alive by asking about its health:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [6]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cat&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;health&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[6]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;'1479333419 21:56:59 elasticsearch green 1 1 0 0 0 0 0 0 - 100.0%\n'&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Nice! We can start playing with our ES cluster.&lt;/p&gt;
&lt;p&gt;As described in the &lt;a href="https://www.elastic.co/guide/en/elasticsearch/plugins/master/using-ingest-attachment.html"&gt;documentation&lt;/a&gt;, we first have to create a pipeline to use the Ingest Attachment Processor Plugin:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;PUT _ingest/pipeline/attachment
{
  "description" : "Extract attachment information",
  "processors" : [
    {
      "attachment" : {
        "field" : "data"
      }
    }
  ]
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;OK, how do we do that using the Python client?&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [7]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
  &lt;span class="s2"&gt;"description"&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"Extract attachment information"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
  &lt;span class="s2"&gt;"processors"&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
    &lt;span class="p"&gt;{&lt;/span&gt;
      &lt;span class="s2"&gt;"attachment"&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;"field"&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"data"&lt;/span&gt;
      &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
  &lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'_ingest'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;doc_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'pipeline'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'attachment'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[7]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'acknowledged': True}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Now, we can send a document to our pipeline. Let's start by using the same example as in the documentation:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;PUT my_index/my_type/my_id?pipeline=attachment
{
  "data": "e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0="
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Using Python client, this gives:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [8]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;result1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_index'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;doc_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_type'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'attachment'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                  &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0="&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="n"&gt;result1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[8]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'_id': 'AVhvJKzVIvjFWZACJU_t',
 '_index': 'my_index',
 '_shards': {'failed': 0, 'successful': 1, 'total': 2},
 '_type': 'my_type',
 '_version': 1,
 'created': True,
 'result': 'created'}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Let's try to get the created document based on its id:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [9]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_index'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;doc_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_type'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;result1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'_id'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[9]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'_id': 'AVhvJKzVIvjFWZACJU_t',
 '_index': 'my_index',
 '_source': {'attachment': {'content': 'Lorem ipsum dolor sit amet',
   'content_length': 28,
   'content_type': 'application/rtf',
   'language': 'ro'},
  'data': 'e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0='},
 '_type': 'my_type',
 '_version': 1,
 'found': True}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can see that the binary data passed to the pipeline was a Rich Text Format file and that the content was extracted: &lt;em&gt;Lorem ipsum dolor sit amet&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Displaying the binary data is not very useful. It doesn't matter in this example as it's quite small.
But it would be much bigger even on small files. We can exclude it using &lt;code&gt;_source_exclude&lt;/code&gt;:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [10]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_index'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;doc_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_type'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;result1&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'_id'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;_source_exclude&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[10]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'_id': 'AVhvJKzVIvjFWZACJU_t',
 '_index': 'my_index',
 '_source': {'attachment': {'content': 'Lorem ipsum dolor sit amet',
   'content_length': 28,
   'content_type': 'application/rtf',
   'language': 'ro'}},
 '_type': 'my_type',
 '_version': 1,
 'found': True}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h3 id="Indexing-PDF-files"&gt;Indexing PDF files&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/#Indexing-PDF-files"&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Let's try to parse the same sample pdf as before.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [11]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'http://www.cbu.edu.zm/downloads/pdf-sample.pdf'&lt;/span&gt;
&lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;requests&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Note that we have to encode the content of the pdf before to pass it to ES.
The source field must be a base64 encoded binary.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [12]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;base64&lt;/span&gt;

&lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;base64&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b64encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'ascii'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [13]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;result2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_index'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;doc_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_type'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pipeline&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'attachment'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                  &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="n"&gt;result2&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[13]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'_id': 'AVhvJMC6IvjFWZACJU_u',
 '_index': 'my_index',
 '_shards': {'failed': 0, 'successful': 1, 'total': 2},
 '_type': 'my_type',
 '_version': 1,
 'created': True,
 'result': 'created'}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can get the document based on its id:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [14]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;doc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_index'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;doc_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_type'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;result2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'_id'&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;_source_exclude&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;doc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[14]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'_id': 'AVhvJMC6IvjFWZACJU_u',
 '_index': 'my_index',
 '_source': {'attachment': {'author': 'cdaily',
   'content': "Adobe Acrobat PDF Files\n\nAdobe® Portable Document Format (PDF) is a universal file format that preserves all\nof the fonts, formatting, colours and graphics of any source document, regardless of\nthe application and platform used to create it.\n\nAdobe PDF is an ideal format for electronic document distribution as it overcomes the\nproblems commonly encountered with electronic file sharing.\n\n•  Anyone, anywhere can open a PDF file. All you need is the free Adobe Acrobat\nReader. Recipients of other file formats sometimes can't open files because they\ndon't have the applications used to create the documents.\n\n•  PDF files always print correctly on any printing device.\n\n•  PDF files always display exactly as created, regardless of fonts, software, and\noperating systems. Fonts, and graphics are not lost due to platform, software, and\nversion incompatibilities.\n\n•  The free Acrobat Reader is easy to download and can be freely distributed by\nanyone.\n\n•  Compact PDF files are smaller than their source files and download a\npage at a time for fast display on the Web.",
   'content_length': 1073,
   'content_type': 'application/pdf',
   'date': '2000-06-28T23:21:08Z',
   'language': 'en',
   'title': 'This is a test PDF file'}},
 '_type': 'my_type',
 '_version': 1,
 'found': True}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Or with a basic search:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [15]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;es&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;search&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_index'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;doc_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'my_type'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'Adobe'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_source_exclude&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[15]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'_shards': {'failed': 0, 'successful': 5, 'total': 5},
 'hits': {'hits': [{'_id': 'AVhvJMC6IvjFWZACJU_u',
    '_index': 'my_index',
    '_score': 0.45930308,
    '_source': {'attachment': {'author': 'cdaily',
      'content': "Adobe Acrobat PDF Files\n\nAdobe® Portable Document Format (PDF) is a universal file format that preserves all\nof the fonts, formatting, colours and graphics of any source document, regardless of\nthe application and platform used to create it.\n\nAdobe PDF is an ideal format for electronic document distribution as it overcomes the\nproblems commonly encountered with electronic file sharing.\n\n•  Anyone, anywhere can open a PDF file. All you need is the free Adobe Acrobat\nReader. Recipients of other file formats sometimes can't open files because they\ndon't have the applications used to create the documents.\n\n•  PDF files always print correctly on any printing device.\n\n•  PDF files always display exactly as created, regardless of fonts, software, and\noperating systems. Fonts, and graphics are not lost due to platform, software, and\nversion incompatibilities.\n\n•  The free Acrobat Reader is easy to download and can be freely distributed by\nanyone.\n\n•  Compact PDF files are smaller than their source files and download a\npage at a time for fast display on the Web.",
      'content_length': 1073,
      'content_type': 'application/pdf',
      'date': '2000-06-28T23:21:08Z',
      'language': 'en',
      'title': 'This is a test PDF file'}},
    '_type': 'my_type'}],
  'max_score': 0.45930308,
  'total': 1},
 'timed_out': False,
 'took': 75}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Of course Elasticsearch allows much more complex queries. But that's something for another time.&lt;/p&gt;
&lt;p&gt;One interesting thing is that by printing the content, we can see that even the layout is quite acurate! Much better than the pdftotext output:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [16]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;doc&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'_source'&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'attachment'&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;'content'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;Adobe Acrobat PDF Files

Adobe® Portable Document Format (PDF) is a universal file format that preserves all
of the fonts, formatting, colours and graphics of any source document, regardless of
the application and platform used to create it.

Adobe PDF is an ideal format for electronic document distribution as it overcomes the
problems commonly encountered with electronic file sharing.

•  Anyone, anywhere can open a PDF file. All you need is the free Adobe Acrobat
Reader. Recipients of other file formats sometimes can't open files because they
don't have the applications used to create the documents.

•  PDF files always print correctly on any printing device.

•  PDF files always display exactly as created, regardless of fonts, software, and
operating systems. Fonts, and graphics are not lost due to platform, software, and
version incompatibilities.

•  The free Acrobat Reader is easy to download and can be freely distributed by
anyone.

•  Compact PDF files are smaller than their source files and download a
page at a time for fast display on the Web.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The ingest-attachment plugin uses the Apache text extraction library &lt;a href="http://tika.apache.org"&gt;Tika&lt;/a&gt;.
It's really powerful. It detects and extracts metadata and text from many file types.&lt;/p&gt;
&lt;p&gt;Sending the file directly to Elasticsearch is nice, but in my use case, I'd like to process the file (change its title, move it to a specific location...) based on its content. I could of course update the document in ES after processing it.&lt;/p&gt;
&lt;p&gt;It might be better in some case to decorelate the parsing and processing from the indexing.
So let's check how to use Tika from Python.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Apache-Tika"&gt;Apache Tika&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/#Apache-Tika"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href="https://github.com/chrismattmann/tika-python"&gt;Tika-Python&lt;/a&gt; makes Apache Tika available as a Python library.
It can even starts a Tika REST server in the background, but this requires Java 7+ to be installed.
I prefer to run the server myself using the prebuilt docker image: &lt;a href="http://logicalspark.github.io/docker-tikaserver/"&gt;docker-tikaserver&lt;/a&gt;.
Like that I have control of what is running.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ docker run --rm -p 9998:9998 logicalspark/docker-tikaserver&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can then set Tika-Python to use Client mode only:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [17]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tika&lt;/span&gt;
&lt;span class="n"&gt;tika&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TikaClientOnly&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tika&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;parser&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [18]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;parsed&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/tmp/pdf-sample.pdf'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'http://localhost:9998/tika'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stderr output_text"&gt;
&lt;pre&gt;2016-11-16 22:57:14,233 [MainThread  ] [INFO ]  Starting new HTTP connection (1): localhost
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [19]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;parsed&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[19]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'content': "\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThis is a test PDF file\n\n\nAdobe Acrobat PDF Files\n\nAdobe® Portable Document Format (PDF) is a universal file format that preserves all\nof the fonts, formatting, colours and graphics of any source document, regardless of\nthe application and platform used to create it.\n\nAdobe PDF is an ideal format for electronic document distribution as it overcomes the\nproblems commonly encountered with electronic file sharing.\n\n•  Anyone, anywhere can open a PDF file. All you need is the free Adobe Acrobat\nReader. Recipients of other file formats sometimes can't open files because they\ndon't have the applications used to create the documents.\n\n•  PDF files always print correctly on any printing device.\n\n•  PDF files always display exactly as created, regardless of fonts, software, and\noperating systems. Fonts, and graphics are not lost due to platform, software, and\nversion incompatibilities.\n\n•  The free Acrobat Reader is easy to download and can be freely distributed by\nanyone.\n\n•  Compact PDF files are smaller than their source files and download a\npage at a time for fast display on the Web.\n\n\n",
 'metadata': {'Author': 'cdaily',
  'Content-Type': 'application/pdf',
  'Creation-Date': '2000-06-28T23:21:08Z',
  'Last-Modified': '2013-10-28T19:24:13Z',
  'Last-Save-Date': '2013-10-28T19:24:13Z',
  'X-Parsed-By': ['org.apache.tika.parser.DefaultParser',
   'org.apache.tika.parser.pdf.PDFParser'],
  'X-TIKA:parse_time_millis': '62',
  'access_permission:assemble_document': 'true',
  'access_permission:can_modify': 'true',
  'access_permission:can_print': 'true',
  'access_permission:can_print_degraded': 'true',
  'access_permission:extract_content': 'true',
  'access_permission:extract_for_accessibility': 'true',
  'access_permission:fill_in_form': 'true',
  'access_permission:modify_annotations': 'true',
  'created': 'Wed Jun 28 23:21:08 UTC 2000',
  'creator': 'cdaily',
  'date': '2013-10-28T19:24:13Z',
  'dc:creator': 'cdaily',
  'dc:format': 'application/pdf; version=1.3',
  'dc:title': 'This is a test PDF file',
  'dcterms:created': '2000-06-28T23:21:08Z',
  'dcterms:modified': '2013-10-28T19:24:13Z',
  'meta:author': 'cdaily',
  'meta:creation-date': '2000-06-28T23:21:08Z',
  'meta:save-date': '2013-10-28T19:24:13Z',
  'modified': '2013-10-28T19:24:13Z',
  'pdf:PDFVersion': '1.3',
  'pdf:docinfo:created': '2000-06-28T23:21:08Z',
  'pdf:docinfo:creator': 'cdaily',
  'pdf:docinfo:creator_tool': 'Microsoft Word 8.0',
  'pdf:docinfo:modified': '2013-10-28T19:24:13Z',
  'pdf:docinfo:producer': 'Acrobat Distiller 4.0 for Windows',
  'pdf:docinfo:title': 'This is a test PDF file',
  'pdf:encrypted': 'false',
  'producer': 'Acrobat Distiller 4.0 for Windows',
  'resourceName': 'pdf-sample.pdf',
  'title': 'This is a test PDF file',
  'xmp:CreatorTool': 'Microsoft Word 8.0',
  'xmpMM:DocumentID': 'uuid:0805e221-80a8-459e-a522-635ed5c1e2e6',
  'xmpTPg:NPages': '1'}}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [20]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parsed&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'content'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt"&gt;&lt;/div&gt;


&lt;div class="output_subarea output_stream output_stdout output_text"&gt;
&lt;pre&gt;This is a test PDF file


Adobe Acrobat PDF Files

Adobe® Portable Document Format (PDF) is a universal file format that preserves all
of the fonts, formatting, colours and graphics of any source document, regardless of
the application and platform used to create it.

Adobe PDF is an ideal format for electronic document distribution as it overcomes the
problems commonly encountered with electronic file sharing.

•  Anyone, anywhere can open a PDF file. All you need is the free Adobe Acrobat
Reader. Recipients of other file formats sometimes can't open files because they
don't have the applications used to create the documents.

•  PDF files always print correctly on any printing device.

•  PDF files always display exactly as created, regardless of fonts, software, and
operating systems. Fonts, and graphics are not lost due to platform, software, and
version incompatibilities.

•  The free Acrobat Reader is easy to download and can be freely distributed by
anyone.

•  Compact PDF files are smaller than their source files and download a
page at a time for fast display on the Web.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Not sure why we get the title of the PDF inside the content.
Anyway the text is extracted properly and we even get a lot of metadata:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;
&lt;div class="prompt input_prompt"&gt;In [21]:&lt;/div&gt;
&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython3"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;parsed&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'metadata'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;


&lt;div class="output_area"&gt;

    &lt;div class="prompt output_prompt"&gt;Out[21]:&lt;/div&gt;




&lt;div class="output_text output_subarea output_execute_result"&gt;
&lt;pre&gt;{'Author': 'cdaily',
 'Content-Type': 'application/pdf',
 'Creation-Date': '2000-06-28T23:21:08Z',
 'Last-Modified': '2013-10-28T19:24:13Z',
 'Last-Save-Date': '2013-10-28T19:24:13Z',
 'X-Parsed-By': ['org.apache.tika.parser.DefaultParser',
  'org.apache.tika.parser.pdf.PDFParser'],
 'X-TIKA:parse_time_millis': '62',
 'access_permission:assemble_document': 'true',
 'access_permission:can_modify': 'true',
 'access_permission:can_print': 'true',
 'access_permission:can_print_degraded': 'true',
 'access_permission:extract_content': 'true',
 'access_permission:extract_for_accessibility': 'true',
 'access_permission:fill_in_form': 'true',
 'access_permission:modify_annotations': 'true',
 'created': 'Wed Jun 28 23:21:08 UTC 2000',
 'creator': 'cdaily',
 'date': '2013-10-28T19:24:13Z',
 'dc:creator': 'cdaily',
 'dc:format': 'application/pdf; version=1.3',
 'dc:title': 'This is a test PDF file',
 'dcterms:created': '2000-06-28T23:21:08Z',
 'dcterms:modified': '2013-10-28T19:24:13Z',
 'meta:author': 'cdaily',
 'meta:creation-date': '2000-06-28T23:21:08Z',
 'meta:save-date': '2013-10-28T19:24:13Z',
 'modified': '2013-10-28T19:24:13Z',
 'pdf:PDFVersion': '1.3',
 'pdf:docinfo:created': '2000-06-28T23:21:08Z',
 'pdf:docinfo:creator': 'cdaily',
 'pdf:docinfo:creator_tool': 'Microsoft Word 8.0',
 'pdf:docinfo:modified': '2013-10-28T19:24:13Z',
 'pdf:docinfo:producer': 'Acrobat Distiller 4.0 for Windows',
 'pdf:docinfo:title': 'This is a test PDF file',
 'pdf:encrypted': 'false',
 'producer': 'Acrobat Distiller 4.0 for Windows',
 'resourceName': 'pdf-sample.pdf',
 'title': 'This is a test PDF file',
 'xmp:CreatorTool': 'Microsoft Word 8.0',
 'xmpMM:DocumentID': 'uuid:0805e221-80a8-459e-a522-635ed5c1e2e6',
 'xmpTPg:NPages': '1'}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="prompt input_prompt"&gt;
&lt;/div&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Conclusion"&gt;Conclusion&lt;a class="anchor-link" href="http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/#Conclusion"&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We saw different methods to extract text from PDF in Python.
Depending on what you want to do, one might suit you better. And this was of course not exhaustive.&lt;/p&gt;
&lt;p&gt;If you want to index PDFs, Elasticsearch might be all you need.
The ingest-attachment plugin uses &lt;a href="http://tika.apache.org"&gt;Apache Tika&lt;/a&gt; which is very powerful.&lt;/p&gt;
&lt;p&gt;And thanks to &lt;a href="https://github.com/chrismattmann/tika-python"&gt;Tika-Python&lt;/a&gt;, it's very easy to use Tika directly from Python.
You can let the library starts the server or use Docker to start your own.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>elasticsearch</category><category>python</category><category>tika</category><guid>http://beenje.github.io/blog/posts/parsing-and-indexing-pdf-in-python/</guid><pubDate>Wed, 16 Nov 2016 20:59:23 GMT</pubDate></item><item><title>Running background tasks with Flask and RQ</title><link>http://beenje.github.io/blog/posts/running-background-tasks-with-flask-and-rq/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;p&gt;I wrote several webapps but it took me a while to understand how to run a
long task and get the result back (without blocking the server).
Of course, you should use a task queue like &lt;a class="reference external" href="http://www.celeryproject.org"&gt;Celery&lt;/a&gt; or &lt;a class="reference external" href="http://python-rq.org"&gt;RQ&lt;/a&gt;.
It's easy to find examples how to send a task to a queue and... forget
about it. But how do you get the result?&lt;/p&gt;
&lt;p&gt;I found a great blog post from Miguel Grinberg:
&lt;a class="reference external" href="http://blog.miguelgrinberg.com/post/using-celery-with-flask"&gt;Using Celery With Flask&lt;/a&gt;.
It explains how to use ajax to poll the server for status updates.
And I finally got it!
As Miguel's post already detailed &lt;a class="reference external" href="http://www.celeryproject.org"&gt;Celery&lt;/a&gt;, I wanted to investigate
&lt;a class="reference external" href="http://python-rq.org"&gt;RQ&lt;/a&gt; (Redis Queue), a simple library to queue job.&lt;/p&gt;
&lt;p&gt;As a side note, Miguel's blog is really great. I learned Flask following the &lt;a class="reference external" href="http://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world"&gt;The Flask Mega-Tutorial&lt;/a&gt;.
If you are starting with Flask, I highly recommend it, as well as the
&lt;a class="reference external" href="http://flaskbook.com"&gt;Flask book&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We'll make a simple app with a form to run some actions.&lt;/p&gt;
&lt;div class="section" id="first-version-send-a-post-to-the-server-and-wait-for-the-response"&gt;
&lt;h2&gt;First version: send a post to the server and wait for the response&lt;/h2&gt;
&lt;p&gt;Let's start with some boilerplate code. This is gonna be a very
simple example, but I'll organize it like I use to for a real application
using &lt;a class="reference external" href="http://flask.pocoo.org/docs/0.11/blueprints/"&gt;Blueprints&lt;/a&gt;, an
&lt;a class="reference external" href="http://flask.pocoo.org/docs/0.11/patterns/appfactories/"&gt;application factory&lt;/a&gt;
and some extensions (&lt;a class="reference external" href="https://pythonhosted.org/Flask-Bootstrap/"&gt;Flask-Bootstrap&lt;/a&gt;, &lt;a class="reference external" href="https://flask-script.readthedocs.io/en/latest/"&gt;Flask-Script&lt;/a&gt; and &lt;a class="reference external" href="http://flask-wtf.readthedocs.io/en/latest/"&gt;Flask-WTF&lt;/a&gt;):&lt;/p&gt;
&lt;pre class="literal-block"&gt;├── Dockerfile
├── LICENSE
├── README.rst
├── app
│   ├── __init__.py
│   ├── extensions.py
│   ├── factory.py
│   ├── main
│   │   ├── __init__.py
│   │   ├── forms.py
│   │   └── views.py
│   ├── settings.py
│   ├── static
│   │   └── css
│   │       └── main.css
│   ├── tasks.py
│   └── templates
│       ├── base.html
│       └── index.html
├── docker-compose.yml
├── environment.yml
├── manage.py
└── uwsgi.py&lt;/pre&gt;
&lt;p&gt;I define all the used extensions in &lt;cite&gt;app/extensions.py&lt;/cite&gt;, my application factory in &lt;cite&gt;app/factory.py&lt;/cite&gt; and
my default settings in &lt;cite&gt;app/settings.py&lt;/cite&gt;. Nothing strange in there. You can refer to the
&lt;a class="reference external" href="https://github.com/beenje/flask-rq-example"&gt;GitHub repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Here is our main &lt;cite&gt;app/main/views.py&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Blueprint&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url_for&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;flash&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;redirect&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;..&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.forms&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TaskForm&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;bp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Blueprint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'main'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-8"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@bp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'GET'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'POST'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-9"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TaskForm&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;validate_on_submit&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-13"&gt;&lt;/a&gt;        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-14"&gt;&lt;/a&gt;            &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-15"&gt;&lt;/a&gt;        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-16"&gt;&lt;/a&gt;            &lt;span class="n"&gt;flash&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Task failed: &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;'danger'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-17"&gt;&lt;/a&gt;        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-18"&gt;&lt;/a&gt;            &lt;span class="n"&gt;flash&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'success'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-19"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url_for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'main.index'&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a name="rest_code_15ae167a37354616afc8e43513e65ce0-20"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'index.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;As said previously, we create a form. On submit, we run the task and send the response back.&lt;/p&gt;
&lt;p&gt;The form is defined in &lt;cite&gt;app/main/forms.py&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;current_app&lt;/span&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask_wtf&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Form&lt;/span&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;wtforms&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SelectField&lt;/span&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;TaskForm&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SelectField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Task'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-8"&gt;&lt;/a&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-9"&gt;&lt;/a&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-10"&gt;&lt;/a&gt;        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_fa9ca38c6c554266a7cea4b4725ffc4a-11"&gt;&lt;/a&gt;        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;choices&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;current_app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'TASKS'&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;In &lt;cite&gt;app/tasks.py&lt;/cite&gt;, we have our &lt;cite&gt;run&lt;/cite&gt; function to start a dummy task:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;current_app&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-7"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;'error'&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-8"&gt;&lt;/a&gt;        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-9"&gt;&lt;/a&gt;        &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-10"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;startswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Short'&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;seconds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;seconds&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;randint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;current_app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'MAX_TIME_TO_WAIT'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-14"&gt;&lt;/a&gt;    &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;seconds&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_c1281acbc78a4b89bb2d542404a3eb0e-15"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt; performed in &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt; second(s)'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;seconds&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;In &lt;cite&gt;app/templates/base.html&lt;/cite&gt;, we define a fixed to top navbar and
a container to show flash messages and our main code. Note that we take advantage of
&lt;a class="reference external" href="https://pythonhosted.org/Flask-Bootstrap/"&gt;Flask-Bootstrap&lt;/a&gt;.&lt;/p&gt;
&lt;pre class="code html"&gt;&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-1"&gt;&lt;/a&gt;{%- extends "bootstrap/base.html" %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-2"&gt;&lt;/a&gt;{% import "bootstrap/utils.html" as utils %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-4"&gt;&lt;/a&gt;{% block head %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-5"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"utf-8"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-6"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;meta&lt;/span&gt; &lt;span class="na"&gt;http-equiv&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"X-UA-Compatible"&lt;/span&gt; &lt;span class="na"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"IE=edge"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-7"&gt;&lt;/a&gt;  {{super()}}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-8"&gt;&lt;/a&gt;{% endblock %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-9"&gt;&lt;/a&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-10"&gt;&lt;/a&gt;{% block styles %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-11"&gt;&lt;/a&gt;  {{super()}}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-12"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;link&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"{{ url_for('static', filename='css/main.css') }}"&lt;/span&gt; &lt;span class="na"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"stylesheet"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-13"&gt;&lt;/a&gt;{% endblock %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-14"&gt;&lt;/a&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-15"&gt;&lt;/a&gt;{% block title %}My App{% endblock %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-17"&gt;&lt;/a&gt;{% block navbar %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-18"&gt;&lt;/a&gt;  &lt;span class="c"&gt;&amp;lt;!-- Fixed navbar --&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-19"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"navbar navbar-default navbar-fixed-top"&lt;/span&gt; &lt;span class="na"&gt;role&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"navigation"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-20"&gt;&lt;/a&gt;    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"container"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-21"&gt;&lt;/a&gt;      &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"navbar-header"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-22"&gt;&lt;/a&gt;        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"button"&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"navbar-toggle"&lt;/span&gt; &lt;span class="na"&gt;data-toggle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"collapse"&lt;/span&gt; &lt;span class="na"&gt;data-target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;".navbar-collapse"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-23"&gt;&lt;/a&gt;          &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"sr-only"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Toggle navigation&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-24"&gt;&lt;/a&gt;          &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"icon-bar"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-25"&gt;&lt;/a&gt;          &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"icon-bar"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-26"&gt;&lt;/a&gt;          &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"icon-bar"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-27"&gt;&lt;/a&gt;        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-28"&gt;&lt;/a&gt;        &lt;span class="c"&gt;&amp;lt;!--img class="navbar-brand" src="../../static/logo.png"--&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-29"&gt;&lt;/a&gt;        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"navbar-brand"&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"{{ url_for('main.index') }}"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;My App&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-30"&gt;&lt;/a&gt;      &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-31"&gt;&lt;/a&gt;    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-32"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-33"&gt;&lt;/a&gt;{% endblock %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-34"&gt;&lt;/a&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-35"&gt;&lt;/a&gt;{% block content %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-36"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"container"&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"mainContent"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-37"&gt;&lt;/a&gt;    {{utils.flashed_messages(container=False, dismissible=True)}}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-38"&gt;&lt;/a&gt;    {% block main %}{% endblock %}
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-39"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_3c1f7d26d4c6498b90af860aff2f5d8e-40"&gt;&lt;/a&gt;{% endblock %}
&lt;/pre&gt;&lt;p&gt;The html code for our view is in &lt;cite&gt;app/templates/index.html&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code html"&gt;&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-1"&gt;&lt;/a&gt;{%- extends "base.html" %}
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-2"&gt;&lt;/a&gt;{% import "bootstrap/wtf.html" as wtf %}
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-3"&gt;&lt;/a&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-4"&gt;&lt;/a&gt;{% block main %}
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-5"&gt;&lt;/a&gt;      &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"panel panel-default"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-6"&gt;&lt;/a&gt;        &lt;span class="c"&gt;&amp;lt;!-- Default panel contents --&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-7"&gt;&lt;/a&gt;        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"panel-heading"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Select task to run&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-8"&gt;&lt;/a&gt;        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"panel-body"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-9"&gt;&lt;/a&gt;          &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"col-md-3"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-10"&gt;&lt;/a&gt;            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;form&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"form"&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"taskForm"&lt;/span&gt; &lt;span class="na"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"POST"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-11"&gt;&lt;/a&gt;              {{ form.hidden_tag() }}
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-12"&gt;&lt;/a&gt;              {{ wtf.form_field(form.task) }}
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-13"&gt;&lt;/a&gt;              &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"form-group"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-14"&gt;&lt;/a&gt;                &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"submit"&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"btn btn-default"&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;"submit"&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;Run&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-15"&gt;&lt;/a&gt;              &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-16"&gt;&lt;/a&gt;            &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;form&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-17"&gt;&lt;/a&gt;          &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-18"&gt;&lt;/a&gt;        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-19"&gt;&lt;/a&gt;      &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_e265a44533ae42ac9a2b7287499d2d3f-20"&gt;&lt;/a&gt;{% endblock %}
&lt;/pre&gt;&lt;p&gt;Let's run this first example. We could just create a virtual environment using &lt;a class="reference external" href="https://virtualenv.pypa.io/en/stable/"&gt;virtualenv&lt;/a&gt;
or &lt;a class="reference external" href="http://conda.pydata.org/docs/intro.html"&gt;conda&lt;/a&gt;. As we'll soon need &lt;a class="reference external" href="http://redis.io"&gt;Redis&lt;/a&gt;, let's directly go for &lt;a class="reference external" href="https://www.docker.com"&gt;Docker&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ git clone https://github.com/beenje/flask-rq-example.git
$ cd flask-rq-example
$ git checkout faa61009dbe3bafe49aae473f0fa19ab05a3ab90
$ docker-compose build
$ docker-compose up&lt;/pre&gt;
&lt;p&gt;Go to &lt;a class="reference external" href="http://localhost:5000"&gt;http://localhost:5000&lt;/a&gt;. You should see the following window:&lt;/p&gt;
&lt;img alt="/images/flask-rq-example.png" src="http://beenje.github.io/blog/images/flask-rq-example.png"&gt;
&lt;p&gt;Choose a task and press run. See how The UI is stuck while waiting for the server?
Not very nice...
Let' improve that a little by using some JavaScript.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="second-version-use-ajax-to-submit-the-form"&gt;
&lt;h2&gt;Second version: use Ajax to submit the form&lt;/h2&gt;
&lt;p&gt;Let's write some javascript. Here is the &lt;cite&gt;app/static/js/main.js&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code javascript"&gt;&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-1"&gt;&lt;/a&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;document&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-3"&gt;&lt;/a&gt;  &lt;span class="c1"&gt;// flash an alert&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-4"&gt;&lt;/a&gt;  &lt;span class="c1"&gt;// remove previous alerts by default&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-5"&gt;&lt;/a&gt;  &lt;span class="c1"&gt;// set clean to false to keep old alerts&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-6"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;flash_alert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;category&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;clean&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-7"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;typeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;clean&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;===&lt;/span&gt; &lt;span class="s2"&gt;"undefined"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="nx"&gt;clean&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;clean&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-9"&gt;&lt;/a&gt;      &lt;span class="nx"&gt;remove_alerts&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-10"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-11"&gt;&lt;/a&gt;    &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;htmlString&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'&amp;lt;div class="alert alert-'&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;category&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;' alert-dismissible" role="alert"&amp;gt;'&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-12"&gt;&lt;/a&gt;    &lt;span class="nx"&gt;htmlString&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;'&amp;lt;button type="button" class="close" data-dismiss="alert" aria-label="Close"&amp;gt;'&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-13"&gt;&lt;/a&gt;    &lt;span class="nx"&gt;htmlString&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;'&amp;lt;span aria-hidden="true"&amp;gt;&amp;amp;times;&amp;lt;/span&amp;gt;&amp;lt;/button&amp;gt;'&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;message&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;'&amp;lt;/div&amp;gt;'&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-14"&gt;&lt;/a&gt;    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;htmlString&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;prependTo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"#mainContent"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;hide&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;slideDown&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-15"&gt;&lt;/a&gt;  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-17"&gt;&lt;/a&gt;  &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;remove_alerts&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-18"&gt;&lt;/a&gt;    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;".alert"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;slideUp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"normal"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-19"&gt;&lt;/a&gt;      &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-20"&gt;&lt;/a&gt;    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-21"&gt;&lt;/a&gt;  &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-22"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-23"&gt;&lt;/a&gt;  &lt;span class="c1"&gt;// submit form&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-24"&gt;&lt;/a&gt;  &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"#submit"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;on&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'click'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-25"&gt;&lt;/a&gt;    &lt;span class="nx"&gt;flash_alert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Running "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"#task"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;val&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;"..."&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"info"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-26"&gt;&lt;/a&gt;    &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;ajax&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-27"&gt;&lt;/a&gt;      &lt;span class="nx"&gt;url&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$SCRIPT_ROOT&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;"/_run_task"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-28"&gt;&lt;/a&gt;      &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"#taskForm"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;serialize&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-29"&gt;&lt;/a&gt;      &lt;span class="nx"&gt;method&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"POST"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-30"&gt;&lt;/a&gt;      &lt;span class="nx"&gt;dataType&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;"json"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-31"&gt;&lt;/a&gt;      &lt;span class="nx"&gt;success&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-32"&gt;&lt;/a&gt;        &lt;span class="nx"&gt;flash_alert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"success"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-33"&gt;&lt;/a&gt;      &lt;span class="p"&gt;},&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-34"&gt;&lt;/a&gt;      &lt;span class="nx"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;jqXHR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;textStatus&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;errorThrown&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-35"&gt;&lt;/a&gt;        &lt;span class="nx"&gt;flash_alert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;JSON&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;jqXHR&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;responseText&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"danger"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-36"&gt;&lt;/a&gt;      &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-37"&gt;&lt;/a&gt;    &lt;span class="p"&gt;});&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-38"&gt;&lt;/a&gt;  &lt;span class="p"&gt;});&lt;/span&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-39"&gt;&lt;/a&gt;
&lt;a name="rest_code_ffb1474277d24213a2d806df281f8074-40"&gt;&lt;/a&gt;&lt;span class="p"&gt;});&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;To include this file in our html, we add the following block to &lt;cite&gt;app/templates/base.html&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code html"&gt;&lt;a name="rest_code_c9f404366ada4cdb9f1ce1fed13ec959-1"&gt;&lt;/a&gt;{% block scripts %}
&lt;a name="rest_code_c9f404366ada4cdb9f1ce1fed13ec959-2"&gt;&lt;/a&gt;  {{super()}}
&lt;a name="rest_code_c9f404366ada4cdb9f1ce1fed13ec959-3"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;text/javascript&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_c9f404366ada4cdb9f1ce1fed13ec959-4"&gt;&lt;/a&gt;    &lt;span class="nx"&gt;$SCRIPT_ROOT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{{&lt;/span&gt; &lt;span class="nx"&gt;request&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;script_root&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nx"&gt;tojson&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nx"&gt;safe&lt;/span&gt; &lt;span class="p"&gt;}};&lt;/span&gt;
&lt;a name="rest_code_c9f404366ada4cdb9f1ce1fed13ec959-5"&gt;&lt;/a&gt;  &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_c9f404366ada4cdb9f1ce1fed13ec959-6"&gt;&lt;/a&gt;  {% block app_scripts %}{% endblock %}
&lt;a name="rest_code_c9f404366ada4cdb9f1ce1fed13ec959-7"&gt;&lt;/a&gt;{% endblock %}
&lt;/pre&gt;&lt;p&gt;And here is a diff for our &lt;cite&gt;app/templates/index.html&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code diff"&gt;&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-1"&gt;&lt;/a&gt;               {{ form.hidden_tag() }}
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-2"&gt;&lt;/a&gt;               {{ wtf.form_field(form.task) }}
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-3"&gt;&lt;/a&gt;               &amp;lt;div class="form-group"&amp;gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-4"&gt;&lt;/a&gt;&lt;span class="gd"&gt;-                &amp;lt;button type="submit" class="btn btn-default" id="submit"&amp;gt;Run&amp;lt;/button&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-5"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+                &amp;lt;button type="button" class="btn btn-default" id="submit"&amp;gt;Run&amp;lt;/button&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-6"&gt;&lt;/a&gt;               &amp;lt;/div&amp;gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-7"&gt;&lt;/a&gt;             &amp;lt;/form&amp;gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-8"&gt;&lt;/a&gt;           &amp;lt;/div&amp;gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-9"&gt;&lt;/a&gt;         &amp;lt;/div&amp;gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-10"&gt;&lt;/a&gt;       &amp;lt;/div&amp;gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-11"&gt;&lt;/a&gt; {% endblock %}
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-12"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+&lt;/span&gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-13"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+{% block app_scripts %}&lt;/span&gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-14"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+  &amp;lt;script src="{{ url_for('static', filename='js/main.js') }}"&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
&lt;a name="rest_code_b313e9b54e4a4d36867e12b81f97110f-15"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+{% endblock %}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;We change the &lt;cite&gt;button&lt;/cite&gt; type from &lt;cite&gt;submit&lt;/cite&gt; to &lt;cite&gt;button&lt;/cite&gt; so that it doesn't send a POST when clicked.
We send an Ajax query to &lt;cite&gt;$SCRIPT_ROOT/_run_task&lt;/cite&gt; instead.&lt;/p&gt;
&lt;p&gt;This is our new &lt;cite&gt;app/main/views.py&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Blueprint&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;..&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.forms&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TaskForm&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;bp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Blueprint&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'main'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-6"&gt;&lt;/a&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-7"&gt;&lt;/a&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-8"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@bp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/_run_task'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'POST'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-9"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run_task&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-10"&gt;&lt;/a&gt;    &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-12"&gt;&lt;/a&gt;        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-13"&gt;&lt;/a&gt;    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-14"&gt;&lt;/a&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'message'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'Task failed: &lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)}),&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-15"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;'result'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-17"&gt;&lt;/a&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-18"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@bp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-19"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TaskForm&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_1f8d6bac0c0b4d1e94b92224d012e618-21"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'index.html'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Let's run this new example:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ git checkout c1ccfe8b3a39079ab80f813b5733b324c8b65c6f
$ docker rm flaskrqexample_web
$ docker-compose up&lt;/pre&gt;
&lt;p&gt;This time we immediately get some feedback when clicking on &lt;em&gt;Run&lt;/em&gt;. There is no reload.
That's better, but the server is still busy during the processing. If you try to open a new page, you won't get any answer until the task is done...&lt;/p&gt;
&lt;p&gt;To avoid blocking the server, we'll use a task queue.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="third-version-setup-rq"&gt;
&lt;h2&gt;Third version: setup RQ&lt;/h2&gt;
&lt;p&gt;As its name indicates, &lt;a class="reference external" href="http://python-rq.org"&gt;RQ&lt;/a&gt; (Redis Queue) is backed by &lt;a class="reference external" href="http://redis.io"&gt;Redis&lt;/a&gt;.
It is designed to have a low barrier entry.
What do we need to integrate &lt;a class="reference external" href="http://python-rq.org"&gt;RQ&lt;/a&gt; in our &lt;a class="reference external" href="http://flask.pocoo.org"&gt;Flask&lt;/a&gt; web app?&lt;/p&gt;
&lt;p&gt;Let's first add some variables in &lt;cite&gt;app/settings.py&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_8da6d20941c74b31b567579713b77a90-1"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# The Redis database to use&lt;/span&gt;
&lt;a name="rest_code_8da6d20941c74b31b567579713b77a90-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;REDIS_URL&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;'redis://redis:6379/0'&lt;/span&gt;
&lt;a name="rest_code_8da6d20941c74b31b567579713b77a90-3"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# The queues to listen on&lt;/span&gt;
&lt;a name="rest_code_8da6d20941c74b31b567579713b77a90-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;QUEUES&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'default'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;To execute a background job, we need a worker.
&lt;a class="reference external" href="http://python-rq.org"&gt;RQ&lt;/a&gt; comes with the &lt;cite&gt;rq worker&lt;/cite&gt; command to start a worker. To integrate it
better with our Flask app, we are going to write a simple &lt;a class="reference external" href="https://flask-script.readthedocs.io/en/latest/"&gt;Flask-Script&lt;/a&gt;
command. We add the following to our &lt;cite&gt;manage.py&lt;/cite&gt;:&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rq&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Worker&lt;/span&gt;
&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-2"&gt;&lt;/a&gt;
&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-3"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@manager&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;
&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-4"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;runworker&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-5"&gt;&lt;/a&gt;    &lt;span class="n"&gt;redis_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'REDIS_URL'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-6"&gt;&lt;/a&gt;    &lt;span class="n"&gt;redis_connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;redis&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;redis_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-7"&gt;&lt;/a&gt;    &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;redis_connection&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-8"&gt;&lt;/a&gt;        &lt;span class="n"&gt;worker&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Worker&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'QUEUES'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_622f40f997c74783be61bf4305461b6f-9"&gt;&lt;/a&gt;        &lt;span class="n"&gt;worker&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;work&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;The Manager runs the command inside a Flask test context, meaning we can
access the app config from within the worker.
This is nice because both our web application and
workers (and thus the jobs run on the worker) have access to the same
configuration variables. No separate config file. No discrepancy.
Everything is in &lt;cite&gt;app/settings.py&lt;/cite&gt; and can be overwritten by &lt;em&gt;LOCAL_SETTINGS&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;To put a job in a Queue, you just create a &lt;em&gt;RQ Queue&lt;/em&gt; and enqueue it.
One way to do that is to pass the connection when creating the &lt;em&gt;Queue&lt;/em&gt;. This is a bit tedious.
&lt;a class="reference external" href="http://python-rq.org"&gt;RQ&lt;/a&gt; has the notion of &lt;a class="reference external" href="http://python-rq.org/docs/connections/"&gt;connection context&lt;/a&gt;. We take advantage of that
and register a function to push the connection and pop it before and after a request (&lt;cite&gt;app/main/views.py&lt;/cite&gt;):&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;redis&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;flask&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Blueprint&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;render_template&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;current_app&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;rq&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;push_connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pop_connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Queue&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-4"&gt;&lt;/a&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-5"&gt;&lt;/a&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-6"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_redis_connection&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;redis_connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;getattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'_redis_connection'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-8"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;redis_connection&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-9"&gt;&lt;/a&gt;        &lt;span class="n"&gt;redis_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;current_app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'REDIS_URL'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-10"&gt;&lt;/a&gt;        &lt;span class="n"&gt;redis_connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_redis_connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;redis&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_url&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;redis_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-11"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;redis_connection&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-12"&gt;&lt;/a&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-13"&gt;&lt;/a&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-14"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@bp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;before_request&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-15"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;push_rq_connection&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;push_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;get_redis_connection&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-17"&gt;&lt;/a&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-18"&gt;&lt;/a&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-19"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@bp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;teardown_request&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-20"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;pop_rq_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;exception&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_0f49de2f3be24c64826673ad686a8bf6-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;pop_connection&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;This makes it easy to create a &lt;em&gt;Queue&lt;/em&gt; in a request or application context.&lt;/p&gt;
&lt;p&gt;The &lt;cite&gt;get_redis_connection&lt;/cite&gt; function gets the Redis connection and stores it in the &lt;em&gt;flask.g&lt;/em&gt; object.
This is the same as what is explained for SQLite &lt;a class="reference external" href="http://flask.pocoo.org/docs/0.11/patterns/sqlite3/"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;With that in place, it's easy to enqueue a job. Here are the changes to the &lt;em&gt;run_task&lt;/em&gt; function:&lt;/p&gt;
&lt;pre class="code diff"&gt;&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-1"&gt;&lt;/a&gt; @bp.route('/_run_task', methods=['POST'])
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-2"&gt;&lt;/a&gt; def run_task():
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-3"&gt;&lt;/a&gt;     task = request.form.get('task')
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-4"&gt;&lt;/a&gt;&lt;span class="gd"&gt;-    try:&lt;/span&gt;
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-5"&gt;&lt;/a&gt;&lt;span class="gd"&gt;-        result = tasks.run(task)&lt;/span&gt;
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-6"&gt;&lt;/a&gt;&lt;span class="gd"&gt;-    except Exception as e:&lt;/span&gt;
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-7"&gt;&lt;/a&gt;&lt;span class="gd"&gt;-        return jsonify({'message': 'Task failed: {}'.format(e)}), 500&lt;/span&gt;
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-8"&gt;&lt;/a&gt;&lt;span class="gd"&gt;-    return jsonify({'result': result})&lt;/span&gt;
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-9"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    q = Queue()&lt;/span&gt;
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-10"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    job = q.enqueue(tasks.run, task)&lt;/span&gt;
&lt;a name="rest_code_2ff105e611cb48edb61d1d2f720004af-11"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    return jsonify({'job_id': job.get_id()})&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;We enqeue our task and just return the job id for now.&lt;/p&gt;
&lt;p&gt;Docker and &lt;cite&gt;docker-compose&lt;/cite&gt; are now gonna come in handy to start eveything
(Redis, our web app and a worker). We just have to add the following to our
&lt;cite&gt;docker-compose.yml&lt;/cite&gt; file:&lt;/p&gt;
&lt;pre class="code diff"&gt;&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-1"&gt;&lt;/a&gt; - "5000:5000"
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-2"&gt;&lt;/a&gt; volumes:
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-3"&gt;&lt;/a&gt; - .:/app
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-4"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    depends_on:&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-5"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    - redis&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-6"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+  worker:&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-7"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    image: flaskrqexample&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-8"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    container_name: flaskrqexample_worker&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-9"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    environment:&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-10"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+      LOCAL_SETTINGS: /app/settings.cfg&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-11"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    command: python manage.py runworker&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-12"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    volumes:&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-13"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    - .:/app&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-14"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    depends_on:&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-15"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    - redis&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-16"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+  redis:&lt;/span&gt;
&lt;a name="rest_code_1c645cca88b145e3830a0ea2136f32b1-17"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+    image: redis:3.2&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Don't forget to add &lt;em&gt;redis&lt;/em&gt; and &lt;em&gt;rq&lt;/em&gt; to your &lt;cite&gt;environment.yml&lt;/cite&gt; file!&lt;/p&gt;
&lt;pre class="code diff"&gt;&lt;a name="rest_code_295df150b5484b4399ec6062686e4594-1"&gt;&lt;/a&gt;   - dominate==2.2.1
&lt;a name="rest_code_295df150b5484b4399ec6062686e4594-2"&gt;&lt;/a&gt;   - flask-bootstrap==3.3.6.0
&lt;a name="rest_code_295df150b5484b4399ec6062686e4594-3"&gt;&lt;/a&gt;   - flask-script==2.0.5
&lt;a name="rest_code_295df150b5484b4399ec6062686e4594-4"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+  - redis==2.10.5&lt;/span&gt;
&lt;a name="rest_code_295df150b5484b4399ec6062686e4594-5"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+  - rq==0.6.0&lt;/span&gt;
&lt;a name="rest_code_295df150b5484b4399ec6062686e4594-6"&gt;&lt;/a&gt;   - visitor==0.1.3
&lt;/pre&gt;&lt;p&gt;Rebuild the docker image and start the app:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ git checkout 437e710df3df0dd4b153f20027f5f00270b2e1a3
$ docker rm flaskrqexample_web
$ docker-compose build
$ docker-compose up&lt;/pre&gt;
&lt;p&gt;OK, nice, we started a job in the background! This is fine to run a task
and forget about it (like sending an e-mail). But how do we get the result back?&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="fourth-version-poll-job-status-and-get-the-result"&gt;
&lt;h2&gt;Fourth version: poll job status and get the result&lt;/h2&gt;
&lt;p&gt;This is the part I have been missing for some time. But, as often, it's not difficult when you have seen it.
When launching the job, we return an url to check the status of the job.
The trick is to periodically call back the same function until the job is finished or failed.&lt;/p&gt;
&lt;p&gt;On the server side, the &lt;cite&gt;job_status&lt;/cite&gt; endpoint uses the job_id to retrieve
the job and to get its status and result.&lt;/p&gt;
&lt;pre class="code python"&gt;&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-1"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@bp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/status/&amp;lt;job_id&amp;gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-2"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;job_status&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;job_id&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-3"&gt;&lt;/a&gt;    &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-4"&gt;&lt;/a&gt;    &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetch_job&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;job_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-5"&gt;&lt;/a&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-6"&gt;&lt;/a&gt;        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'status'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;'unknown'&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-7"&gt;&lt;/a&gt;    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-8"&gt;&lt;/a&gt;        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-9"&gt;&lt;/a&gt;            &lt;span class="s1"&gt;'status'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_status&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-10"&gt;&lt;/a&gt;            &lt;span class="s1"&gt;'result'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-11"&gt;&lt;/a&gt;        &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-12"&gt;&lt;/a&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_failed&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-13"&gt;&lt;/a&gt;            &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'message'&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exc_info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-14"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-15"&gt;&lt;/a&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-16"&gt;&lt;/a&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-17"&gt;&lt;/a&gt;&lt;span class="nd"&gt;@bp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'/_run_task'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;methods&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;'POST'&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-18"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run_task&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-19"&gt;&lt;/a&gt;    &lt;span class="n"&gt;task&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'task'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;job&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;enqueue&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tasks&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a name="rest_code_97410e9a12fb4a10be4d23a774acf057-22"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;jsonify&lt;/span&gt;&lt;span class="p"&gt;({}),&lt;/span&gt; &lt;span class="mi"&gt;202&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;'Location'&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;url_for&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'main.job_status'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;job_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;job&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_id&lt;/span&gt;&lt;span class="p"&gt;())}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;The &lt;cite&gt;run_task&lt;/cite&gt; function returns an empty response with the &lt;a class="reference external" href="https://httpstatuses.com/202"&gt;202&lt;/a&gt; status
code. We use the &lt;em&gt;Location&lt;/em&gt; response-header field to pass the &lt;cite&gt;job_status&lt;/cite&gt; URL to the
client.&lt;/p&gt;
&lt;p&gt;On the client side, we retrieve the URL from the header and call the new
&lt;cite&gt;check_job_status&lt;/cite&gt; function.&lt;/p&gt;
&lt;pre class="code diff"&gt;&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-1"&gt;&lt;/a&gt;&lt;span class="gu"&gt;@@ -28,8 +53,11 @@ $(document).ready(function() {&lt;/span&gt;
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-2"&gt;&lt;/a&gt;       data: $("#taskForm").serialize(),
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-3"&gt;&lt;/a&gt;       method: "POST",
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-4"&gt;&lt;/a&gt;       dataType: "json",
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-5"&gt;&lt;/a&gt;&lt;span class="gd"&gt;-      success: function(data) {&lt;/span&gt;
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-6"&gt;&lt;/a&gt;&lt;span class="gd"&gt;-        flash_alert("Job " + data.job_id + " started...", "info", false);&lt;/span&gt;
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-7"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+      success: function(data, status, request) {&lt;/span&gt;
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-8"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+        $("#submit").attr("disabled", "disabled");&lt;/span&gt;
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-9"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+        flash_alert("Running " + task + "...", "info");&lt;/span&gt;
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-10"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+        var status_url = request.getResponseHeader('Location');&lt;/span&gt;
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-11"&gt;&lt;/a&gt;&lt;span class="gi"&gt;+        check_job_status(status_url);&lt;/span&gt;
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-12"&gt;&lt;/a&gt;       },
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-13"&gt;&lt;/a&gt;       error: function(jqXHR, textStatus, errorThrown) {
&lt;a name="rest_code_1a0ffd55f84346da99e39710441602ae-14"&gt;&lt;/a&gt;         flash_alert("Failed to start " + task, "danger");
&lt;/pre&gt;&lt;p&gt;We use &lt;cite&gt;setTimeout&lt;/cite&gt; to call back the same function until the job is done (finished
or failed).&lt;/p&gt;
&lt;pre class="code javascript"&gt;&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-1"&gt;&lt;/a&gt;&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;check_job_status&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;status_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-2"&gt;&lt;/a&gt;  &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;getJSON&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;status_url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-3"&gt;&lt;/a&gt;    &lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-4"&gt;&lt;/a&gt;    &lt;span class="k"&gt;switch&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;status&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-5"&gt;&lt;/a&gt;      &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s2"&gt;"unknown"&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-6"&gt;&lt;/a&gt;          &lt;span class="nx"&gt;flash_alert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Unknown job id"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"danger"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-7"&gt;&lt;/a&gt;          &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"#submit"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;removeAttr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"disabled"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-8"&gt;&lt;/a&gt;          &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-9"&gt;&lt;/a&gt;      &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s2"&gt;"finished"&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-10"&gt;&lt;/a&gt;          &lt;span class="nx"&gt;flash_alert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"success"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-11"&gt;&lt;/a&gt;          &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"#submit"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;removeAttr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"disabled"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-12"&gt;&lt;/a&gt;          &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-13"&gt;&lt;/a&gt;      &lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s2"&gt;"failed"&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-14"&gt;&lt;/a&gt;          &lt;span class="nx"&gt;flash_alert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"Job failed: "&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="nx"&gt;data&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;"danger"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-15"&gt;&lt;/a&gt;          &lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"#submit"&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;removeAttr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;"disabled"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-16"&gt;&lt;/a&gt;          &lt;span class="k"&gt;break&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-17"&gt;&lt;/a&gt;      &lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-18"&gt;&lt;/a&gt;        &lt;span class="c1"&gt;// queued/started/deferred&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-19"&gt;&lt;/a&gt;        &lt;span class="nx"&gt;setTimeout&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-20"&gt;&lt;/a&gt;          &lt;span class="nx"&gt;check_job_status&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;status_url&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-21"&gt;&lt;/a&gt;        &lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-22"&gt;&lt;/a&gt;    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-23"&gt;&lt;/a&gt;  &lt;span class="p"&gt;});&lt;/span&gt;
&lt;a name="rest_code_fd49b9fed81347d7a93347e5d7a426e6-24"&gt;&lt;/a&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;p&gt;Let's checkout this commit and run our app again:&lt;/p&gt;
&lt;pre class="literal-block"&gt;$ git checkout da8360aefb222afc17417a518ac25029566071d6
$ docker rm flaskrqexample_web
$ docker rm flaskrqexample_worker
$ docker-compose up&lt;/pre&gt;
&lt;p&gt;Try submitting some tasks. This time you can open another window and the
server will answer even when a task is running :-)
You can open a console in your browser to see the polling and the response
from the &lt;cite&gt;job_status&lt;/cite&gt; function.
Note that we only have one worker, so if you start a second task, it will be enqueued
and run only when the first one is done.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="conclusion"&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Using &lt;a class="reference external" href="http://python-rq.org"&gt;RQ&lt;/a&gt; with &lt;a class="reference external" href="http://flask.pocoo.org"&gt;Flask&lt;/a&gt; isn't that difficult. So no need to block the server to
get the result of a long task.
There are a few more things to say, but this post starts to be a bit long,
so I'll keep that for another time.&lt;/p&gt;
&lt;p&gt;Thanks again to &lt;a class="reference external" href="http://blog.miguelgrinberg.com/"&gt;Miguel Grinberg&lt;/a&gt;
and all his posts about Flask!&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>ajax</category><category>flask</category><category>python</category><category>redis</category><category>rq</category><guid>http://beenje.github.io/blog/posts/running-background-tasks-with-flask-and-rq/</guid><pubDate>Sat, 20 Aug 2016 21:32:16 GMT</pubDate></item><item><title>uWSGI, send_file and Python 3.5</title><link>http://beenje.github.io/blog/posts/uwsgi-send_file-and-python35/</link><dc:creator>Benjamin Bertrand</dc:creator><description>&lt;div&gt;&lt;p&gt;I have a Flask app that returns an in-memory bytes buffer (&lt;a class="reference external" href="https://docs.python.org/3/library/io.html#io.BytesIO"&gt;io.Bytesio&lt;/a&gt;) using Flask &lt;a class="reference external" href="http://flask.pocoo.org/docs/0.11/api/#flask.send_file"&gt;send_file&lt;/a&gt; function.&lt;/p&gt;
&lt;p&gt;The app is deployed using &lt;a class="reference external" href="http://uwsgi-docs.readthedocs.io/en/latest/"&gt;uWSGI&lt;/a&gt; behind Nginx.
This was working fine with Python 3.4.&lt;/p&gt;
&lt;p&gt;When I updated Python to 3.5, I got the following exception when trying to download a file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;io.UnsupportedOperation: fileno

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask/app.py", line 1817, in wsgi_app
    response = self.full_dispatch_request()
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask/app.py", line 1477, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask/app.py", line 1381, in handle_user_exception
    reraise(exc_type, exc_value, tb)
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask/_compat.py", line 33, in reraise
    raise value
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask/app.py", line 1475, in full_dispatch_request
    rv = self.dispatch_request()
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask/app.py", line 1461, in dispatch_request
    return self.view_functions[rule.endpoint](**req.view_args)
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask_login.py", line 758, in decorated_view
    return func(*args, **kwargs)
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask_security/decorators.py", line 194, in decorated_view
    return fn(*args, **kwargs)
  File "/webapps/bowser/bowser/app/bext/views.py", line 116, in download
    as_attachment=True)
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/flask/helpers.py", line 523, in send_file
    data = wrap_file(request.environ, file)
  File "/webapps/bowser/miniconda3/envs/bowser/lib/python3.5/site-packages/werkzeug/wsgi.py", line 726, in wrap_file
    return environ.get('wsgi.file_wrapper', FileWrapper)(file, buffer_size)
SystemError: &amp;lt;built-in function uwsgi_sendfile&amp;gt; returned a result with an error set&lt;/pre&gt;
&lt;p&gt;I quickly found the following &lt;a class="reference external" href="http://lists.unbit.it/pipermail/uwsgi/2015-September/008186.html"&gt;post&lt;/a&gt; with the same exception, but no answer...
A little more googling brought me to this github issue: &lt;a class="reference external" href="https://github.com/unbit/uwsgi/issues/1126"&gt;In python3, uwsgi fails to respond a
stream from BytesIO object&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;As described, you should run uwsgi with the &lt;cite&gt;--wsgi-disable-file-wrapper&lt;/cite&gt; flag to avoid this problem.
As with all command line options, you can add the following entry in your
uwsgi.ini file:&lt;/p&gt;
&lt;pre class="literal-block"&gt;wsgi-disable-file-wrapper = true&lt;/pre&gt;
&lt;p&gt;Note that &lt;a class="reference external" href="http://uwsgi-docs.readthedocs.io/en/latest/"&gt;uWSGI&lt;/a&gt; 2.0.12 is required.&lt;/p&gt;
&lt;p&gt;When searching in &lt;a class="reference external" href="http://uwsgi-docs.readthedocs.io/en/latest/"&gt;uWSGI&lt;/a&gt; documentation, I only found one match in &lt;a class="reference external" href="http://uwsgi-docs.readthedocs.io/en/latest/Changelog-2.0.12.html?highlight=wsgi-disable-file-wrapper"&gt;uWSGI 2.0.12 release notes&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;A problem/option that should be better documented. Probably a pull request to open :-)&lt;/p&gt;
&lt;p&gt;UPDATE (2016-07-13): pull request &lt;a class="reference external" href="https://github.com/unbit/uwsgi-docs/pull/317"&gt;merged&lt;/a&gt;&lt;/p&gt;&lt;/div&gt;</description><category>flask</category><category>python</category><category>uwsgi</category><guid>http://beenje.github.io/blog/posts/uwsgi-send_file-and-python35/</guid><pubDate>Tue, 05 Jul 2016 18:39:29 GMT</pubDate></item></channel></rss>